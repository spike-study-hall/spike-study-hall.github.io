{
"version":3,
"file":"module$node_modules$browserify_sign$browser$verify.js",
"lineCount":5,
"mappings":"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",
"sources":["node_modules/browserify-sign/browser/verify.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$browserify_sign$browser$verify\"] = function(global,require,module,exports) {\nvar Buffer = require('buffer').Buffer;\n// much of this based on https://github.com/indutny/self-signed/blob/gh-pages/lib/rsa.js\nvar BN = require('bn.js')\nvar EC = require('elliptic').ec\nvar parseKeys = require('parse-asn1')\nvar curves = require('./curves.json')\n\nfunction verify (sig, hash, key, signType, tag) {\n  var pub = parseKeys(key)\n  if (pub.type === 'ec') {\n    // rsa keys can be interpreted as ecdsa ones in openssl\n    if (signType !== 'ecdsa' && signType !== 'ecdsa/rsa') throw new Error('wrong public key type')\n    return ecVerify(sig, hash, pub)\n  } else if (pub.type === 'dsa') {\n    if (signType !== 'dsa') throw new Error('wrong public key type')\n    return dsaVerify(sig, hash, pub)\n  } else {\n    if (signType !== 'rsa' && signType !== 'ecdsa/rsa') throw new Error('wrong public key type')\n  }\n  hash = Buffer.concat([tag, hash])\n  var len = pub.modulus.byteLength()\n  var pad = [ 1 ]\n  var padNum = 0\n  while (hash.length + pad.length + 2 < len) {\n    pad.push(0xff)\n    padNum++\n  }\n  pad.push(0x00)\n  var i = -1\n  while (++i < hash.length) {\n    pad.push(hash[i])\n  }\n  pad = new Buffer(pad)\n  var red = BN.mont(pub.modulus)\n  sig = new BN(sig).toRed(red)\n\n  sig = sig.redPow(new BN(pub.publicExponent))\n  sig = new Buffer(sig.fromRed().toArray())\n  var out = padNum < 8 ? 1 : 0\n  len = Math.min(sig.length, pad.length)\n  if (sig.length !== pad.length) out = 1\n\n  i = -1\n  while (++i < len) out |= sig[i] ^ pad[i]\n  return out === 0\n}\n\nfunction ecVerify (sig, hash, pub) {\n  var curveId = curves[pub.data.algorithm.curve.join('.')]\n  if (!curveId) throw new Error('unknown curve ' + pub.data.algorithm.curve.join('.'))\n\n  var curve = new EC(curveId)\n  var pubkey = pub.data.subjectPrivateKey.data\n\n  return curve.verify(hash, sig, pubkey)\n}\n\nfunction dsaVerify (sig, hash, pub) {\n  var p = pub.data.p\n  var q = pub.data.q\n  var g = pub.data.g\n  var y = pub.data.pub_key\n  var unpacked = parseKeys.signature.decode(sig, 'der')\n  var s = unpacked.s\n  var r = unpacked.r\n  checkValue(s, q)\n  checkValue(r, q)\n  var montp = BN.mont(p)\n  var w = s.invm(q)\n  var v = g.toRed(montp)\n    .redPow(new BN(hash).mul(w).mod(q))\n    .fromRed()\n    .mul(y.toRed(montp).redPow(r.mul(w).mod(q)).fromRed())\n    .mod(p)\n    .mod(q)\n  return v.cmp(r) === 0\n}\n\nfunction checkValue (b, q) {\n  if (b.cmpn(0) <= 0) throw new Error('invalid sig')\n  if (b.cmp(q) >= q) throw new Error('invalid sig')\n}\n\nmodule.exports = verify\n\n};"],
"names":["shadow$provide","global","require","module","exports","checkValue","b","q","cmpn","Error","cmp","Buffer","BN","EC","ec","parseKeys","curves","verify","sig","hash","key","signType","tag","pub","type","curveId","data","algorithm","curve","join","subjectPrivateKey","p","g","y","pub_key","unpacked","signature","decode","s","r","montp","mont","w","invm","toRed","redPow","mul","mod","fromRed","v","concat","len","modulus","byteLength","pad","padNum","length","push","i","red","publicExponent","toArray","out","Math","min"]
}
