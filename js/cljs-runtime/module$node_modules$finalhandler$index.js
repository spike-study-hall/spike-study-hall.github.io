shadow$provide.module$node_modules$finalhandler$index=function(global,require,module,exports){function headersSent(res){return"boolean"!==typeof res.headersSent?!!res._header:res.headersSent}function send(req,res,status,headers,message){function write(){var body='\x3c!DOCTYPE html\x3e\n\x3chtml lang\x3d"en"\x3e\n\x3chead\x3e\n\x3cmeta charset\x3d"utf-8"\x3e\n\x3ctitle\x3eError\x3c/title\x3e\n\x3c/head\x3e\n\x3cbody\x3e\n\x3cpre\x3e'+escapeHtml(message).replace(NEWLINE_REGEXP,"\x3cbr\x3e").replace(DOUBLE_SPACE_REGEXP,
" \x26nbsp;")+"\x3c/pre\x3e\n\x3c/body\x3e\n\x3c/html\x3e\n";res.statusCode=status;res.statusMessage=statuses[status];if(headers)for(var keys=Object.keys(headers),i=0;i<keys.length;i++){var key=keys[i];res.setHeader(key,headers[key])}res.setHeader("Content-Security-Policy","default-src 'none'");res.setHeader("X-Content-Type-Options","nosniff");res.setHeader("Content-Type","text/html; charset\x3dutf-8");res.setHeader("Content-Length",Buffer.byteLength(body,"utf8"));"HEAD"===req.method?res.end():res.end(body,
"utf8")}isFinished(req)?write():(unpipe(req),onFinished(req,write),req.resume())}var process=require("module$node_modules$process$browser"),Buffer=require("module$node_modules$buffer$index").Buffer;"use strict";var debug=require("module$node_modules$debug$src$browser")("finalhandler"),encodeUrl=require("module$node_modules$encodeurl$index"),escapeHtml=require("module$node_modules$escape_html$index"),onFinished=require("module$node_modules$on_finished$index"),parseUrl=require("module$node_modules$parseurl$index"),
statuses=require("module$node_modules$statuses$index"),unpipe=require("module$node_modules$unpipe$index"),DOUBLE_SPACE_REGEXP=/\x20{2}/g,NEWLINE_REGEXP=/\n/g,defer="function"===typeof setImmediate?setImmediate:function(fn){process.nextTick(fn.bind.apply(fn,arguments))},isFinished=onFinished.isFinished;module.exports=function(req,res,options){options=options||{};var env=options.env||"development",onerror=options.onerror;return function(err){var msg;if(!err&&headersSent(res))debug("cannot 404 after headers sent");
else{if(err){var status="number"===typeof err.status&&400<=err.status&&600>err.status?err.status:"number"===typeof err.statusCode&&400<=err.statusCode&&600>err.statusCode?err.statusCode:void 0;if(void 0===status){if(status=res.statusCode,"number"!==typeof status||400>status||599<status)status=500}else if(err.headers&&"object"===typeof err.headers){var headers=Object.create(null);for(var keys=Object.keys(err.headers),i=0;i<keys.length;i++){var key=keys[i];headers[key]=err.headers[key]}}else headers=
void 0;"production"!==env&&((msg=err.stack)||"function"!==typeof err.toString||(msg=err.toString()));msg=msg||statuses[status]}else{status=404;msg="Cannot "+req.method+" ";try{keys=parseUrl.original(req).pathname}catch(e){keys="resource"}msg+=encodeUrl(keys)}debug("default %s",status);err&&onerror&&defer(onerror,err,req,res);headersSent(res)?(debug("cannot %d after headers sent",status),req.socket.destroy()):send(req,res,status,headers,msg)}}}}
//# sourceMappingURL=module$node_modules$finalhandler$index.js.map
