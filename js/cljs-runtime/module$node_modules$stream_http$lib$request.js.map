{
"version":3,
"file":"module$node_modules$stream_http$lib$request.js",
"lineCount":11,
"mappings":"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",
"sources":["node_modules/stream-http/lib/request.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$stream_http$lib$request\"] = function(global,require,module,exports) {\nvar process = require('process');\nvar Buffer = require('buffer').Buffer;\nvar capability = require('./capability')\nvar inherits = require('inherits')\nvar response = require('./response')\nvar stream = require('readable-stream')\nvar toArrayBuffer = require('to-arraybuffer')\n\nvar IncomingMessage = response.IncomingMessage\nvar rStates = response.readyStates\n\nfunction decideMode (preferBinary, useFetch) {\n\tif (capability.fetch && useFetch) {\n\t\treturn 'fetch'\n\t} else if (capability.mozchunkedarraybuffer) {\n\t\treturn 'moz-chunked-arraybuffer'\n\t} else if (capability.msstream) {\n\t\treturn 'ms-stream'\n\t} else if (capability.arraybuffer && preferBinary) {\n\t\treturn 'arraybuffer'\n\t} else if (capability.vbArray && preferBinary) {\n\t\treturn 'text:vbarray'\n\t} else {\n\t\treturn 'text'\n\t}\n}\n\nvar ClientRequest = module.exports = function (opts) {\n\tvar self = this\n\tstream.Writable.call(self)\n\n\tself._opts = opts\n\tself._body = []\n\tself._headers = {}\n\tif (opts.auth)\n\t\tself.setHeader('Authorization', 'Basic ' + new Buffer(opts.auth).toString('base64'))\n\tObject.keys(opts.headers).forEach(function (name) {\n\t\tself.setHeader(name, opts.headers[name])\n\t})\n\n\tvar preferBinary\n\tvar useFetch = true\n\tif (opts.mode === 'disable-fetch' || ('requestTimeout' in opts && !capability.abortController)) {\n\t\t// If the use of XHR should be preferred. Not typically needed.\n\t\tuseFetch = false\n\t\tpreferBinary = true\n\t} else if (opts.mode === 'prefer-streaming') {\n\t\t// If streaming is a high priority but binary compatibility and\n\t\t// the accuracy of the 'content-type' header aren't\n\t\tpreferBinary = false\n\t} else if (opts.mode === 'allow-wrong-content-type') {\n\t\t// If streaming is more important than preserving the 'content-type' header\n\t\tpreferBinary = !capability.overrideMimeType\n\t} else if (!opts.mode || opts.mode === 'default' || opts.mode === 'prefer-fast') {\n\t\t// Use binary if text streaming may corrupt data or the content-type header, or for speed\n\t\tpreferBinary = true\n\t} else {\n\t\tthrow new Error('Invalid value for opts.mode')\n\t}\n\tself._mode = decideMode(preferBinary, useFetch)\n\tself._fetchTimer = null\n\n\tself.on('finish', function () {\n\t\tself._onFinish()\n\t})\n}\n\ninherits(ClientRequest, stream.Writable)\n\nClientRequest.prototype.setHeader = function (name, value) {\n\tvar self = this\n\tvar lowerName = name.toLowerCase()\n\t// This check is not necessary, but it prevents warnings from browsers about setting unsafe\n\t// headers. To be honest I'm not entirely sure hiding these warnings is a good thing, but\n\t// http-browserify did it, so I will too.\n\tif (unsafeHeaders.indexOf(lowerName) !== -1)\n\t\treturn\n\n\tself._headers[lowerName] = {\n\t\tname: name,\n\t\tvalue: value\n\t}\n}\n\nClientRequest.prototype.getHeader = function (name) {\n\tvar header = this._headers[name.toLowerCase()]\n\tif (header)\n\t\treturn header.value\n\treturn null\n}\n\nClientRequest.prototype.removeHeader = function (name) {\n\tvar self = this\n\tdelete self._headers[name.toLowerCase()]\n}\n\nClientRequest.prototype._onFinish = function () {\n\tvar self = this\n\n\tif (self._destroyed)\n\t\treturn\n\tvar opts = self._opts\n\n\tvar headersObj = self._headers\n\tvar body = null\n\tif (opts.method !== 'GET' && opts.method !== 'HEAD') {\n\t\tif (capability.arraybuffer) {\n\t\t\tbody = toArrayBuffer(Buffer.concat(self._body))\n\t\t} else if (capability.blobConstructor) {\n\t\t\tbody = new global.Blob(self._body.map(function (buffer) {\n\t\t\t\treturn toArrayBuffer(buffer)\n\t\t\t}), {\n\t\t\t\ttype: (headersObj['content-type'] || {}).value || ''\n\t\t\t})\n\t\t} else {\n\t\t\t// get utf8 string\n\t\t\tbody = Buffer.concat(self._body).toString()\n\t\t}\n\t}\n\n\t// create flattened list of headers\n\tvar headersList = []\n\tObject.keys(headersObj).forEach(function (keyName) {\n\t\tvar name = headersObj[keyName].name\n\t\tvar value = headersObj[keyName].value\n\t\tif (Array.isArray(value)) {\n\t\t\tvalue.forEach(function (v) {\n\t\t\t\theadersList.push([name, v])\n\t\t\t})\n\t\t} else {\n\t\t\theadersList.push([name, value])\n\t\t}\n\t})\n\n\tif (self._mode === 'fetch') {\n\t\tvar signal = null\n\t\tvar fetchTimer = null\n\t\tif (capability.abortController) {\n\t\t\tvar controller = new AbortController()\n\t\t\tsignal = controller.signal\n\t\t\tself._fetchAbortController = controller\n\n\t\t\tif ('requestTimeout' in opts && opts.requestTimeout !== 0) {\n\t\t\t\tself._fetchTimer = global.setTimeout(function () {\n\t\t\t\t\tself.emit('requestTimeout')\n\t\t\t\t\tif (self._fetchAbortController)\n\t\t\t\t\t\tself._fetchAbortController.abort()\n\t\t\t\t}, opts.requestTimeout)\n\t\t\t}\n\t\t}\n\n\t\tglobal.fetch(self._opts.url, {\n\t\t\tmethod: self._opts.method,\n\t\t\theaders: headersList,\n\t\t\tbody: body || undefined,\n\t\t\tmode: 'cors',\n\t\t\tcredentials: opts.withCredentials ? 'include' : 'same-origin',\n\t\t\tsignal: signal\n\t\t}).then(function (response) {\n\t\t\tself._fetchResponse = response\n\t\t\tself._connect()\n\t\t}, function (reason) {\n\t\t\tglobal.clearTimeout(self._fetchTimer)\n\t\t\tif (!self._destroyed)\n\t\t\t\tself.emit('error', reason)\n\t\t})\n\t} else {\n\t\tvar xhr = self._xhr = new global.XMLHttpRequest()\n\t\ttry {\n\t\t\txhr.open(self._opts.method, self._opts.url, true)\n\t\t} catch (err) {\n\t\t\tprocess.nextTick(function () {\n\t\t\t\tself.emit('error', err)\n\t\t\t})\n\t\t\treturn\n\t\t}\n\n\t\t// Can't set responseType on really old browsers\n\t\tif ('responseType' in xhr)\n\t\t\txhr.responseType = self._mode.split(':')[0]\n\n\t\tif ('withCredentials' in xhr)\n\t\t\txhr.withCredentials = !!opts.withCredentials\n\n\t\tif (self._mode === 'text' && 'overrideMimeType' in xhr)\n\t\t\txhr.overrideMimeType('text/plain; charset=x-user-defined')\n\n\t\tif ('requestTimeout' in opts) {\n\t\t\txhr.timeout = opts.requestTimeout\n\t\t\txhr.ontimeout = function () {\n\t\t\t\tself.emit('requestTimeout')\n\t\t\t}\n\t\t}\n\n\t\theadersList.forEach(function (header) {\n\t\t\txhr.setRequestHeader(header[0], header[1])\n\t\t})\n\n\t\tself._response = null\n\t\txhr.onreadystatechange = function () {\n\t\t\tswitch (xhr.readyState) {\n\t\t\t\tcase rStates.LOADING:\n\t\t\t\tcase rStates.DONE:\n\t\t\t\t\tself._onXHRProgress()\n\t\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t\t// Necessary for streaming in Firefox, since xhr.response is ONLY defined\n\t\t// in onprogress, not in onreadystatechange with xhr.readyState = 3\n\t\tif (self._mode === 'moz-chunked-arraybuffer') {\n\t\t\txhr.onprogress = function () {\n\t\t\t\tself._onXHRProgress()\n\t\t\t}\n\t\t}\n\n\t\txhr.onerror = function () {\n\t\t\tif (self._destroyed)\n\t\t\t\treturn\n\t\t\tself.emit('error', new Error('XHR error'))\n\t\t}\n\n\t\ttry {\n\t\t\txhr.send(body)\n\t\t} catch (err) {\n\t\t\tprocess.nextTick(function () {\n\t\t\t\tself.emit('error', err)\n\t\t\t})\n\t\t\treturn\n\t\t}\n\t}\n}\n\n/**\n * Checks if xhr.status is readable and non-zero, indicating no error.\n * Even though the spec says it should be available in readyState 3,\n * accessing it throws an exception in IE8\n */\nfunction statusValid (xhr) {\n\ttry {\n\t\tvar status = xhr.status\n\t\treturn (status !== null && status !== 0)\n\t} catch (e) {\n\t\treturn false\n\t}\n}\n\nClientRequest.prototype._onXHRProgress = function () {\n\tvar self = this\n\n\tif (!statusValid(self._xhr) || self._destroyed)\n\t\treturn\n\n\tif (!self._response)\n\t\tself._connect()\n\n\tself._response._onXHRProgress()\n}\n\nClientRequest.prototype._connect = function () {\n\tvar self = this\n\n\tif (self._destroyed)\n\t\treturn\n\n\tself._response = new IncomingMessage(self._xhr, self._fetchResponse, self._mode, self._fetchTimer)\n\tself._response.on('error', function(err) {\n\t\tself.emit('error', err)\n\t})\n\n\tself.emit('response', self._response)\n}\n\nClientRequest.prototype._write = function (chunk, encoding, cb) {\n\tvar self = this\n\n\tself._body.push(chunk)\n\tcb()\n}\n\nClientRequest.prototype.abort = ClientRequest.prototype.destroy = function () {\n\tvar self = this\n\tself._destroyed = true\n\tglobal.clearTimeout(self._fetchTimer)\n\tif (self._response)\n\t\tself._response._destroyed = true\n\tif (self._xhr)\n\t\tself._xhr.abort()\n\telse if (self._fetchAbortController)\n\t\tself._fetchAbortController.abort()\n}\n\nClientRequest.prototype.end = function (data, encoding, cb) {\n\tvar self = this\n\tif (typeof data === 'function') {\n\t\tcb = data\n\t\tdata = undefined\n\t}\n\n\tstream.Writable.prototype.end.call(self, data, encoding, cb)\n}\n\nClientRequest.prototype.flushHeaders = function () {}\nClientRequest.prototype.setTimeout = function () {}\nClientRequest.prototype.setNoDelay = function () {}\nClientRequest.prototype.setSocketKeepAlive = function () {}\n\n// Taken from http://www.w3.org/TR/XMLHttpRequest/#the-setrequestheader%28%29-method\nvar unsafeHeaders = [\n\t'accept-charset',\n\t'accept-encoding',\n\t'access-control-request-headers',\n\t'access-control-request-method',\n\t'connection',\n\t'content-length',\n\t'cookie',\n\t'cookie2',\n\t'date',\n\t'dnt',\n\t'expect',\n\t'host',\n\t'keep-alive',\n\t'origin',\n\t'referer',\n\t'te',\n\t'trailer',\n\t'transfer-encoding',\n\t'upgrade',\n\t'via'\n]\n\n};"],
"names":["shadow$provide","global","require","module","exports","process","Buffer","capability","inherits","response","stream","toArrayBuffer","IncomingMessage","rStates","readyStates","ClientRequest","module.exports","opts","self","Writable","call","_opts","_body","_headers","auth","setHeader","toString","Object","keys","headers","forEach","name","useFetch","mode","abortController","preferBinary","overrideMimeType","Error","_mode","fetch","mozchunkedarraybuffer","msstream","arraybuffer","vbArray","_fetchTimer","on","_onFinish","prototype","ClientRequest.prototype.setHeader","value","lowerName","toLowerCase","unsafeHeaders","indexOf","getHeader","ClientRequest.prototype.getHeader","header","removeHeader","ClientRequest.prototype.removeHeader","ClientRequest.prototype._onFinish","_destroyed","headersObj","body","method","concat","blobConstructor","Blob","map","buffer","type","headersList","keyName","Array","isArray","v","push","signal","controller","AbortController","_fetchAbortController","requestTimeout","setTimeout","emit","abort","url","undefined","credentials","withCredentials","then","_fetchResponse","_connect","reason","clearTimeout","xhr","_xhr","XMLHttpRequest","open","err","nextTick","responseType","split","timeout","ontimeout","xhr.ontimeout","setRequestHeader","_response","onreadystatechange","xhr.onreadystatechange","readyState","LOADING","DONE","_onXHRProgress","onprogress","xhr.onprogress","onerror","xhr.onerror","send","ClientRequest.prototype._onXHRProgress","status","e","ClientRequest.prototype._connect","_write","ClientRequest.prototype._write","chunk","encoding","cb","destroy","ClientRequest.prototype.destroy","end","ClientRequest.prototype.end","data","flushHeaders","ClientRequest.prototype.flushHeaders","ClientRequest.prototype.setTimeout","setNoDelay","ClientRequest.prototype.setNoDelay","setSocketKeepAlive","ClientRequest.prototype.setSocketKeepAlive"]
}
