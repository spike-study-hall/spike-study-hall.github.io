shadow$provide.module$node_modules$express$lib$application=function(global,require,module,exports){function logerror(err){"test"!==this.get("env")&&console.error(err.stack||err.toString())}var finalhandler=require("module$node_modules$finalhandler$index"),Router=require("module$node_modules$express$lib$router$index"),methods=require("module$node_modules$methods$index"),middleware=require("module$node_modules$express$lib$middleware$init"),query=require("module$node_modules$express$lib$middleware$query"),
debug=require("module$node_modules$debug$src$browser")("express:application"),View=require("module$node_modules$express$lib$view"),http=require("module$node_modules$stream_http$index"),compileETag=require("module$node_modules$express$lib$utils").compileETag,compileQueryParser=require("module$node_modules$express$lib$utils").compileQueryParser,compileTrust=require("module$node_modules$express$lib$utils").compileTrust;global=require("module$node_modules$depd$lib$browser$index")("express");var flatten=
require("module$node_modules$array_flatten$array_flatten"),merge=require("module$node_modules$utils_merge$index"),resolve=require("module$node_modules$path_browserify$index").resolve,setPrototypeOf=require("module$node_modules$setprototypeof$index"),slice=Array.prototype.slice,app=module.exports={};app.init=function(){this.cache={};this.engines={};this.settings={};this.defaultConfiguration()};app.defaultConfiguration=function(){this.enable("x-powered-by");this.set("etag","weak");this.set("env","development");
this.set("query parser","extended");this.set("subdomain offset",2);this.set("trust proxy",!1);Object.defineProperty(this.settings,"@@symbol:trust_proxy_default",{configurable:!0,value:!0});debug("booting in %s mode","development");this.on("mount",function(parent){!0===this.settings["@@symbol:trust_proxy_default"]&&"function"===typeof parent.settings["trust proxy fn"]&&(delete this.settings["trust proxy"],delete this.settings["trust proxy fn"]);setPrototypeOf(this.request,parent.request);setPrototypeOf(this.response,
parent.response);setPrototypeOf(this.engines,parent.engines);setPrototypeOf(this.settings,parent.settings)});this.locals=Object.create(null);this.mountpath="/";this.locals.settings=this.settings;this.set("view",View);this.set("views",resolve("views"));this.set("jsonp callback name","callback");Object.defineProperty(this,"router",{get:function(){throw Error("'app.router' is deprecated!\nPlease see the 3.x to 4.x migration guide for details on how to update your app.");}})};app.lazyrouter=function(){this._router||
(this._router=new Router({caseSensitive:this.enabled("case sensitive routing"),strict:this.enabled("strict routing")}),this._router.use(query(this.get("query parser fn"))),this._router.use(middleware.init(this)))};app.handle=function(req,res,callback){var router=this._router;callback=callback||finalhandler(req,res,{env:this.get("env"),onerror:logerror.bind(this)});router?router.handle(req,res,callback):(debug("no routes defined on app"),callback())};app.use=function(fn$jscomp$0){var offset=0,path=
"/";if("function"!==typeof fn$jscomp$0){for(var arg=fn$jscomp$0;Array.isArray(arg)&&0!==arg.length;)arg=arg[0];"function"!==typeof arg&&(offset=1,path=fn$jscomp$0)}offset=flatten(slice.call(arguments,offset));if(0===offset.length)throw new TypeError("app.use() requires a middleware function");this.lazyrouter();var router=this._router;offset.forEach(function(fn){if(!fn||!fn.handle||!fn.set)return router.use(path,fn);debug(".use app under %s",path);fn.mountpath=path;fn.parent=this;router.use(path,function(req,
res,next){var orig=req.app;fn.handle(req,res,function(err){setPrototypeOf(req,orig.request);setPrototypeOf(res,orig.response);next(err)})});fn.emit("mount",this)},this);return this};app.route=function(path){this.lazyrouter();return this._router.route(path)};app.engine=function(ext,fn){if("function"!==typeof fn)throw Error("callback function required");this.engines["."!==ext[0]?"."+ext:ext]=fn;return this};app.param=function(name,fn){this.lazyrouter();if(Array.isArray(name)){for(var i=0;i<name.length;i++)this.param(name[i],
fn);return this}this._router.param(name,fn);return this};app.set=function(setting,val){if(1===arguments.length)return this.settings[setting];debug('set "%s" to %o',setting,val);this.settings[setting]=val;switch(setting){case "etag":this.set("etag fn",compileETag(val));break;case "query parser":this.set("query parser fn",compileQueryParser(val));break;case "trust proxy":this.set("trust proxy fn",compileTrust(val)),Object.defineProperty(this.settings,"@@symbol:trust_proxy_default",{configurable:!0,
value:!1})}return this};app.path=function(){return this.parent?this.parent.path()+this.mountpath:""};app.enabled=function(setting){return!!this.set(setting)};app.disabled=function(setting){return!this.set(setting)};app.enable=function(setting){return this.set(setting,!0)};app.disable=function(setting){return this.set(setting,!1)};methods.forEach(function(method){app[method]=function(path){if("get"===method&&1===arguments.length)return this.set(path);this.lazyrouter();var route=this._router.route(path);
route[method].apply(route,slice.call(arguments,1));return this}});app.all=function(path){this.lazyrouter();for(var route=this._router.route(path),args=slice.call(arguments,1),i=0;i<methods.length;i++)route[methods[i]].apply(route,args);return this};app.del=global.function(app.delete,"app.del: Use app.delete instead");app.render=function(name,options,callback){var cache=this.cache,engines=this.engines,opts=options,renderOptions={},view;"function"===typeof options&&(callback=options,opts={});merge(renderOptions,
this.locals);opts._locals&&merge(renderOptions,opts._locals);merge(renderOptions,opts);null==renderOptions.cache&&(renderOptions.cache=this.enabled("view cache"));renderOptions.cache&&(view=cache[name]);if(!view){view=new (this.get("view"))(name,{defaultEngine:this.get("view engine"),root:this.get("views"),engines:engines});if(!view.path)return options=Array.isArray(view.root)&&1<view.root.length?'directories "'+view.root.slice(0,-1).join('", "')+'" or "'+view.root[view.root.length-1]+'"':'directory "'+
view.root+'"',name=Error('Failed to lookup view "'+name+'" in views '+options),name.view=view,callback(name);renderOptions.cache&&(cache[name]=view)}name=callback;try{view.render(renderOptions,name)}catch(err){name(err)}};app.listen=function(){var server=http.createServer(this);return server.listen.apply(server,arguments)}}
//# sourceMappingURL=module$node_modules$express$lib$application.js.map
