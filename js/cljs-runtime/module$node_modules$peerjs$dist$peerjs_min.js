var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(array){var index=0;return function(){return index<array.length?{done:!1,value:array[index++]}:{done:!0}}};$jscomp.arrayIterator=function(array){return{next:$jscomp.arrayIteratorImpl(array)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(target,property,descriptor){target!=Array.prototype&&target!=Object.prototype&&(target[property]=descriptor.value)};$jscomp.getGlobal=function(maybeGlobal){return"undefined"!=typeof window&&window===maybeGlobal?maybeGlobal:"undefined"!=typeof global&&null!=global?global:maybeGlobal};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var counter=0;return function(opt_description){return $jscomp.SYMBOL_PREFIX+(opt_description||"")+counter++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var symbolIterator=$jscomp.global.Symbol.iterator;symbolIterator||(symbolIterator=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[symbolIterator]&&$jscomp.defineProperty(Array.prototype,symbolIterator,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var symbolAsyncIterator=$jscomp.global.Symbol.asyncIterator;symbolAsyncIterator||(symbolAsyncIterator=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(next){$jscomp.initSymbolIterator();next={next:next};next[$jscomp.global.Symbol.iterator]=function(){return this};return next};
$jscomp.makeIterator=function(iterable){var iteratorFunction="undefined"!=typeof Symbol&&Symbol.iterator&&iterable[Symbol.iterator];return iteratorFunction?iteratorFunction.call(iterable):$jscomp.arrayIterator(iterable)};
shadow$provide.module$node_modules$peerjs$dist$peerjs_min=function(global,process,require,module,exports,shadow$shims){parcelRequire=function(e$jscomp$0,r$jscomp$2,t,n$jscomp$0){function f(t,n){function p(e){return f(p.resolve(e))}if(!r$jscomp$2[t]){if(!e$jscomp$0[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);n=Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n;}p.resolve=function(r){return e$jscomp$0[t][1][r]||
r};p.cache={};n=r$jscomp$2[t]=new f.Module(t);e$jscomp$0[t][0].call(n.exports,p,n,n.exports,this)}return r$jscomp$2[t].exports}var i$jscomp$0,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;f.isParcelRequire=!0;f.Module=function(e){this.id=e;this.bundle=f;this.exports={}};f.modules=e$jscomp$0;f.cache=r$jscomp$2;f.parent=o;f.register=function(r$jscomp$0,t){e$jscomp$0[r$jscomp$0]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e$0){i$jscomp$0||
(i$jscomp$0=e$0)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n$jscomp$0&&(this[n$jscomp$0]=l)}if(parcelRequire=f,i$jscomp$0)throw i$jscomp$0;return f}({EgBh:[function(require,module,exports){function t$jscomp$0(){this._pieces=[];this._parts=[]}var e$jscomp$0={};try{var JSCompiler_inline_result=(new Blob([]),!1)}catch(e$1){JSCompiler_inline_result=!0}e$jscomp$0.useBlobBuilder=
JSCompiler_inline_result;if(require=!e$jscomp$0.useBlobBuilder)try{require=0===(new Blob([new Uint8Array([])])).size}catch(e$2){require=!0}e$jscomp$0.useArrayBufferView=require;module.exports.binaryFeatures=e$jscomp$0;var r$jscomp$0=module.exports.BlobBuilder;"undefined"!=typeof window&&(r$jscomp$0=module.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder);t$jscomp$0.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),
this._parts.push(e))};t$jscomp$0.prototype.flush=function(){if(0<this._pieces.length){var r=new Uint8Array(this._pieces);e$jscomp$0.useArrayBufferView||(r=r.buffer);this._parts.push(r);this._pieces=[]}};t$jscomp$0.prototype.getBuffer=function(){if(this.flush(),e$jscomp$0.useBlobBuilder){for(var t=new r$jscomp$0,i=0,u=this._parts.length;i<u;i++)t.append(this._parts[i]);return t.getBlob()}return new Blob(this._parts)};module.exports.BufferBuilder=t$jscomp$0},{}],kdPp:[function(require,module,exports){function r$jscomp$0(t){this.index=
0;this.dataBuffer=t;this.dataView=new Uint8Array(this.dataBuffer);this.length=this.dataBuffer.byteLength}function n$jscomp$0(){this.bufferBuilder=new t$jscomp$0}function u$jscomp$0(t){t=t.charCodeAt(0);return 2047>=t?"00":65535>=t?"000":2097151>=t?"0000":67108863>=t?"00000":"000000"}var t$jscomp$0=require("./bufferbuilder").BufferBuilder,e$jscomp$0=require("./bufferbuilder").binaryFeatures;module.exports={unpack:function(t){return(new r$jscomp$0(t)).unpack()},pack:function(t){var e=new n$jscomp$0;
return e.pack(t),e.getBuffer()}};r$jscomp$0.prototype.unpack=function(){var t,e=this.unpack_uint8();if(128>e)return e;if(32>(224^e))return(224^e)-32;if(15>=(t=160^e))return this.unpack_raw(t);if(15>=(t=176^e))return this.unpack_string(t);if(15>=(t=144^e))return this.unpack_array(t);if(15>=(t=128^e))return this.unpack_map(t);switch(e){case 192:return null;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();
case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 216:return t=this.unpack_uint16(),this.unpack_string(t);case 217:return t=this.unpack_uint32(),this.unpack_string(t);case 218:return t=this.unpack_uint16(),this.unpack_raw(t);case 219:return t=this.unpack_uint32(),this.unpack_raw(t);case 220:return t=
this.unpack_uint16(),this.unpack_array(t);case 221:return t=this.unpack_uint32(),this.unpack_array(t);case 222:return t=this.unpack_uint16(),this.unpack_map(t);case 223:return t=this.unpack_uint32(),this.unpack_map(t)}};r$jscomp$0.prototype.unpack_uint8=function(){var t=255&this.dataView[this.index];return this.index++,t};r$jscomp$0.prototype.unpack_uint16=function(){var t=this.read(2);t=256*(255&t[0])+(255&t[1]);return this.index+=2,t};r$jscomp$0.prototype.unpack_uint32=function(){var t=this.read(4);
t=256*(256*(256*t[0]+t[1])+t[2])+t[3];return this.index+=4,t};r$jscomp$0.prototype.unpack_uint64=function(){var t=this.read(8);t=256*(256*(256*(256*(256*(256*(256*t[0]+t[1])+t[2])+t[3])+t[4])+t[5])+t[6])+t[7];return this.index+=8,t};r$jscomp$0.prototype.unpack_int8=function(){var t=this.unpack_uint8();return 128>t?t:t-256};r$jscomp$0.prototype.unpack_int16=function(){var t=this.unpack_uint16();return 32768>t?t:t-65536};r$jscomp$0.prototype.unpack_int32=function(){var t=this.unpack_uint32();return t<
Math.pow(2,31)?t:t-Math.pow(2,32)};r$jscomp$0.prototype.unpack_int64=function(){var t=this.unpack_uint64();return t<Math.pow(2,63)?t:t-Math.pow(2,64)};r$jscomp$0.prototype.unpack_raw=function(t){if(this.length<this.index+t)throw Error("BinaryPackFailure: index is out of range "+this.index+" "+t+" "+this.length);var e=this.dataBuffer.slice(this.index,this.index+t);return this.index+=t,e};r$jscomp$0.prototype.unpack_string=function(t){for(var e,i,r=this.read(t),n=0,u="";n<t;)128>(e=r[n])?(u+=String.fromCharCode(e),
n++):32>(192^e)?(i=(192^e)<<6|63&r[n+1],u+=String.fromCharCode(i),n+=2):(i=(15&e)<<12|(63&r[n+1])<<6|63&r[n+2],u+=String.fromCharCode(i),n+=3);return this.index+=t,u};r$jscomp$0.prototype.unpack_array=function(t){for(var e=Array(t),i=0;i<t;i++)e[i]=this.unpack();return e};r$jscomp$0.prototype.unpack_map=function(t){for(var e={},i=0;i<t;i++){var r=this.unpack(),n=this.unpack();e[r]=n}return e};r$jscomp$0.prototype.unpack_float=function(){var t=this.unpack_uint32();return(0===t>>31?1:-1)*(8388607&t|
8388608)*Math.pow(2,(t>>23&255)-127-23)};r$jscomp$0.prototype.unpack_double=function(){var t=this.unpack_uint32(),e=this.unpack_uint32(),i=(t>>20&2047)-1023;return(0===t>>31?1:-1)*((1048575&t|1048576)*Math.pow(2,i-20)+e*Math.pow(2,i-52))};r$jscomp$0.prototype.read=function(t){var e=this.index;if(e+t<=this.length)return this.dataView.subarray(e,e+t);throw Error("BinaryPackFailure: read index out of range");};n$jscomp$0.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()};n$jscomp$0.prototype.pack=
function(t){var i=typeof t;if("string"===i)this.pack_string(t);else if("number"===i)Math.floor(t)===t?this.pack_integer(t):this.pack_double(t);else if("boolean"===i)!0===t?this.bufferBuilder.append(195):!1===t&&this.bufferBuilder.append(194);else if("undefined"===i)this.bufferBuilder.append(192);else{if("object"!==i)throw Error('Type "'+i+'" not yet supported');if(null===t)this.bufferBuilder.append(192);else if(i=t.constructor,i==Array)this.pack_array(t);else if(i==Blob||i==File||t instanceof Blob||
t instanceof File)this.pack_bin(t);else if(i==ArrayBuffer)e$jscomp$0.useArrayBufferView?this.pack_bin(new Uint8Array(t)):this.pack_bin(t);else if("BYTES_PER_ELEMENT"in t)e$jscomp$0.useArrayBufferView?this.pack_bin(new Uint8Array(t.buffer)):this.pack_bin(t.buffer);else if(i==Object||i.toString().startsWith("class"))this.pack_object(t);else if(i==Date)this.pack_string(t.toString());else{if("function"!=typeof t.toBinaryPack)throw Error('Type "'+i.toString()+'" not yet supported');this.bufferBuilder.append(t.toBinaryPack())}}this.bufferBuilder.flush()};
n$jscomp$0.prototype.pack_bin=function(t){var e=t.length||t.byteLength||t.size;if(15>=e)this.pack_uint8(160+e);else if(65535>=e)this.bufferBuilder.append(218),this.pack_uint16(e);else{if(!(4294967295>=e))throw Error("Invalid length");this.bufferBuilder.append(219);this.pack_uint32(e)}this.bufferBuilder.append(t)};n$jscomp$0.prototype.pack_string=function(t){var e=600<t.length?(new Blob([t])).size:t.replace(/[^\u0000-\u007F]/g,u$jscomp$0).length;if(15>=e)this.pack_uint8(176+e);else if(65535>=e)this.bufferBuilder.append(216),
this.pack_uint16(e);else{if(!(4294967295>=e))throw Error("Invalid length");this.bufferBuilder.append(217);this.pack_uint32(e)}this.bufferBuilder.append(t)};n$jscomp$0.prototype.pack_array=function(t){var e=t.length;if(15>=e)this.pack_uint8(144+e);else if(65535>=e)this.bufferBuilder.append(220),this.pack_uint16(e);else{if(!(4294967295>=e))throw Error("Invalid length");this.bufferBuilder.append(221);this.pack_uint32(e)}for(var i=0;i<e;i++)this.pack(t[i])};n$jscomp$0.prototype.pack_integer=function(t){if(-32<=
t&&127>=t)this.bufferBuilder.append(255&t);else if(0<=t&&255>=t)this.bufferBuilder.append(204),this.pack_uint8(t);else if(-128<=t&&127>=t)this.bufferBuilder.append(208),this.pack_int8(t);else if(0<=t&&65535>=t)this.bufferBuilder.append(205),this.pack_uint16(t);else if(-32768<=t&&32767>=t)this.bufferBuilder.append(209),this.pack_int16(t);else if(0<=t&&4294967295>=t)this.bufferBuilder.append(206),this.pack_uint32(t);else if(-2147483648<=t&&2147483647>=t)this.bufferBuilder.append(210),this.pack_int32(t);
else if(-9223372036854775808<=t&&0x7fffffffffffffff>=t)this.bufferBuilder.append(211),this.pack_int64(t);else{if(!(0<=t&&1.8446744073709552E19>=t))throw Error("Invalid integer");this.bufferBuilder.append(207);this.pack_uint64(t)}};n$jscomp$0.prototype.pack_double=function(t){var e=0;0>t&&(e=1,t=-t);var i=Math.floor(Math.log(t)/Math.LN2);t=Math.floor((t/Math.pow(2,i)-1)*Math.pow(2,52));var u=Math.pow(2,32);e=e<<31|i+1023<<20|t/u&1048575;i=t%u;this.bufferBuilder.append(203);this.pack_int32(e);this.pack_int32(i)};
n$jscomp$0.prototype.pack_object=function(t){var e=Object.keys(t).length;if(15>=e)this.pack_uint8(128+e);else if(65535>=e)this.bufferBuilder.append(222),this.pack_uint16(e);else{if(!(4294967295>=e))throw Error("Invalid length");this.bufferBuilder.append(223);this.pack_uint32(e)}for(var i in t)t.hasOwnProperty(i)&&(this.pack(i),this.pack(t[i]))};n$jscomp$0.prototype.pack_uint8=function(t){this.bufferBuilder.append(t)};n$jscomp$0.prototype.pack_uint16=function(t){this.bufferBuilder.append(t>>8);this.bufferBuilder.append(255&
t)};n$jscomp$0.prototype.pack_uint32=function(t){t&=4294967295;this.bufferBuilder.append((4278190080&t)>>>24);this.bufferBuilder.append((16711680&t)>>>16);this.bufferBuilder.append((65280&t)>>>8);this.bufferBuilder.append(255&t)};n$jscomp$0.prototype.pack_uint64=function(t){var e=t/Math.pow(2,32);t%=Math.pow(2,32);this.bufferBuilder.append((4278190080&e)>>>24);this.bufferBuilder.append((16711680&e)>>>16);this.bufferBuilder.append((65280&e)>>>8);this.bufferBuilder.append(255&e);this.bufferBuilder.append((4278190080&
t)>>>24);this.bufferBuilder.append((16711680&t)>>>16);this.bufferBuilder.append((65280&t)>>>8);this.bufferBuilder.append(255&t)};n$jscomp$0.prototype.pack_int8=function(t){this.bufferBuilder.append(255&t)};n$jscomp$0.prototype.pack_int16=function(t){this.bufferBuilder.append((65280&t)>>8);this.bufferBuilder.append(255&t)};n$jscomp$0.prototype.pack_int32=function(t){this.bufferBuilder.append(t>>>24&255);this.bufferBuilder.append((16711680&t)>>>16);this.bufferBuilder.append((65280&t)>>>8);this.bufferBuilder.append(255&
t)};n$jscomp$0.prototype.pack_int64=function(t){var e=Math.floor(t/Math.pow(2,32));t%=Math.pow(2,32);this.bufferBuilder.append((4278190080&e)>>>24);this.bufferBuilder.append((16711680&e)>>>16);this.bufferBuilder.append((65280&e)>>>8);this.bufferBuilder.append(255&e);this.bufferBuilder.append((4278190080&t)>>>24);this.bufferBuilder.append((16711680&t)>>>16);this.bufferBuilder.append((65280&t)>>>8);this.bufferBuilder.append(255&t)}},{"./bufferbuilder":"EgBh"}],iSxC:[function(require,module,exports){function e$jscomp$2(e,
t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t$jscomp$1(e$jscomp$0){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();return(t$jscomp$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e$jscomp$0)}
function o$jscomp$0(e,t,n){return(e=e.match(t))&&e.length>=n&&parseInt(e[n],10)}function d(t){return"[object Object]"===Object.prototype.toString.call(t)?Object.keys(t).reduce(function(n,r){var o="[object Object]"===Object.prototype.toString.call(t[r]),i=o?d(t[r]):t[r];o=o&&!Object.keys(i).length;return void 0===i||o?n:Object.assign(n,e$jscomp$2({},r,i))},{}):t}function l(e,t$jscomp$0,n){t$jscomp$0&&!n.has(t$jscomp$0.id)&&(n.set(t$jscomp$0.id,t$jscomp$0),Object.keys(t$jscomp$0).forEach(function(r){r.endsWith("Id")?
l(e,e.get(t$jscomp$0[r]),n):r.endsWith("Ids")&&t$jscomp$0[r].forEach(function(t){l(e,e.get(t),n)})}))}Object.defineProperty(exports,"__esModule",{value:!0});exports.extractVersion=o$jscomp$0;exports.wrapPeerConnectionEvent=function(e$jscomp$1,t,n$jscomp$0){if(e$jscomp$1.RTCPeerConnection){e$jscomp$1=e$jscomp$1.RTCPeerConnection.prototype;var o=e$jscomp$1.addEventListener;e$jscomp$1.addEventListener=function(e$jscomp$0,r){if(e$jscomp$0!==t)return o.apply(this,arguments);var i=function(e){(e=n$jscomp$0(e))&&
r(e)};return this._eventMap=this._eventMap||{},this._eventMap[r]=i,o.apply(this,[e$jscomp$0,i])};var i$jscomp$0=e$jscomp$1.removeEventListener;e$jscomp$1.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return i$jscomp$0.apply(this,arguments);var r=this._eventMap[n];return delete this._eventMap[n],i$jscomp$0.apply(this,[e,r])};Object.defineProperty(e$jscomp$1,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+
t]),delete this["_on"+t]);e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}};exports.disableLog=function(e){return"boolean"!=typeof e?Error("Argument type: "+t$jscomp$1(e)+". Please use a boolean."):(n$jscomp$1=e,e?"adapter.js logging disabled":"adapter.js logging enabled")};exports.disableWarnings=function(e){return"boolean"!=typeof e?Error("Argument type: "+t$jscomp$1(e)+". Please use a boolean."):(r$jscomp$0=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))};
exports.log=function(){"object"!==("undefined"==typeof window?"undefined":t$jscomp$1(window))||n$jscomp$1||"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)};exports.deprecated=function(e,t){r$jscomp$0&&console.warn(e+" is deprecated, please use "+t+" instead.")};exports.detectBrowser=function(e){var t=e.navigator,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=
o$jscomp$0(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)n.browser="chrome",n.version=o$jscomp$0(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=o$jscomp$0(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari";n.version=
o$jscomp$0(t.userAgent,/AppleWebKit\/(\d+)\./,1);n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return n};exports.compactObject=d;exports.walkStats=l;exports.filterStats=function(e$jscomp$0,t$jscomp$0,n$jscomp$0){var r=n$jscomp$0?"outbound-rtp":"inbound-rtp",o=new Map;if(null===t$jscomp$0)return o;var i=[];return e$jscomp$0.forEach(function(e){"track"===e.type&&e.trackIdentifier===t$jscomp$0.id&&i.push(e)}),i.forEach(function(t){e$jscomp$0.forEach(function(n){n.type===
r&&n.trackId===t.id&&l(e$jscomp$0,n,o)})}),o};var n$jscomp$1=!0,r$jscomp$0=!0},{}],s6SN:[function(require,module,exports){function r$jscomp$2(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r$jscomp$2=function(){return e},e}function o$jscomp$0(e$jscomp$0){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();return(o$jscomp$0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){$jscomp.initSymbol();$jscomp.initSymbol();
$jscomp.initSymbol();return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e$jscomp$0)}Object.defineProperty(exports,"__esModule",{value:!0});exports.shimGetUserMedia=function(r$jscomp$1){var t$jscomp$0=r$jscomp$1&&r$jscomp$1.navigator;if(t$jscomp$0.mediaDevices){var i$jscomp$0=e$jscomp$2.detectBrowser(r$jscomp$1),a$jscomp$0=function(e$jscomp$0){if("object"!==o$jscomp$0(e$jscomp$0)||e$jscomp$0.mandatory||e$jscomp$0.optional)return e$jscomp$0;var r$jscomp$0=
{};return Object.keys(e$jscomp$0).forEach(function(t){if("require"!==t&&"advanced"!==t&&"mediaSource"!==t){var n="object"===o$jscomp$0(e$jscomp$0[t])?e$jscomp$0[t]:{ideal:e$jscomp$0[t]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var i=function(e,r){return e?e+r.charAt(0).toUpperCase()+r.slice(1):"deviceId"===r?"sourceId":r};if(void 0!==n.ideal){r$jscomp$0.optional=r$jscomp$0.optional||[];var a={};"number"==typeof n.ideal?(a[i("min",t)]=n.ideal,r$jscomp$0.optional.push(a),(a=
{})[i("max",t)]=n.ideal,r$jscomp$0.optional.push(a)):(a[i("",t)]=n.ideal,r$jscomp$0.optional.push(a))}void 0!==n.exact&&"number"!=typeof n.exact?(r$jscomp$0.mandatory=r$jscomp$0.mandatory||{},r$jscomp$0.mandatory[i("",t)]=n.exact):["min","max"].forEach(function(e){void 0!==n[e]&&(r$jscomp$0.mandatory=r$jscomp$0.mandatory||{},r$jscomp$0.mandatory[i(e,t)]=n[e])})}}),e$jscomp$0.advanced&&(r$jscomp$0.optional=(r$jscomp$0.optional||[]).concat(e$jscomp$0.advanced)),r$jscomp$0},c$jscomp$0=function(e$jscomp$0,
r$jscomp$0){if(61<=i$jscomp$0.version)return r$jscomp$0(e$jscomp$0);if((e$jscomp$0=JSON.parse(JSON.stringify(e$jscomp$0)))&&"object"===o$jscomp$0(e$jscomp$0.audio)){var c=function(e,r,t){r in e&&!(t in e)&&(e[t]=e[r],delete e[r])};c((e$jscomp$0=JSON.parse(JSON.stringify(e$jscomp$0))).audio,"autoGainControl","googAutoGainControl");c(e$jscomp$0.audio,"noiseSuppression","googNoiseSuppression");e$jscomp$0.audio=a$jscomp$0(e$jscomp$0.audio)}if(e$jscomp$0&&"object"===o$jscomp$0(e$jscomp$0.video)){var d=
e$jscomp$0.video.facingMode;d=d&&("object"===o$jscomp$0(d)?d:{ideal:d});var u;c=66>i$jscomp$0.version;if(!(!d||"user"!==d.exact&&"environment"!==d.exact&&"user"!==d.ideal&&"environment"!==d.ideal||t$jscomp$0.mediaDevices.getSupportedConstraints&&t$jscomp$0.mediaDevices.getSupportedConstraints().facingMode&&!c)&&(delete e$jscomp$0.video.facingMode,"environment"===d.exact||"environment"===d.ideal?u=["back","rear"]:"user"!==d.exact&&"user"!==d.ideal||(u=["front"]),u))return t$jscomp$0.mediaDevices.enumerateDevices().then(function(t){var o=
(t=t.filter(function(e){return"videoinput"===e.kind})).find(function(e){return u.some(function(r){return e.label.toLowerCase().includes(r)})});return!o&&t.length&&u.includes("back")&&(o=t[t.length-1]),o&&(e$jscomp$0.video.deviceId=d.exact?{exact:o.deviceId}:{ideal:o.deviceId}),e$jscomp$0.video=a$jscomp$0(e$jscomp$0.video),n$jscomp$0("chrome: "+JSON.stringify(e$jscomp$0)),r$jscomp$0(e$jscomp$0)});e$jscomp$0.video=a$jscomp$0(e$jscomp$0.video)}return n$jscomp$0("chrome: "+JSON.stringify(e$jscomp$0)),
r$jscomp$0(e$jscomp$0)},d$jscomp$0=function(e){return 64<=i$jscomp$0.version?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||
e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t$jscomp$0.getUserMedia=function(e$jscomp$1,r,o){c$jscomp$0(e$jscomp$1,function(e$jscomp$0){t$jscomp$0.webkitGetUserMedia(e$jscomp$0,r,function(e){o&&o(d$jscomp$0(e))})})}.bind(t$jscomp$0),t$jscomp$0.mediaDevices.getUserMedia){var u$jscomp$0=t$jscomp$0.mediaDevices.getUserMedia.bind(t$jscomp$0.mediaDevices);t$jscomp$0.mediaDevices.getUserMedia=function(e$jscomp$1){return c$jscomp$0(e$jscomp$1,
function(e$jscomp$0){return u$jscomp$0(e$jscomp$0).then(function(r){if(e$jscomp$0.audio&&!r.getAudioTracks().length||e$jscomp$0.video&&!r.getVideoTracks().length)throw r.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return r},function(e){return Promise.reject(d$jscomp$0(e))})})}}}};var e$jscomp$2=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r$jscomp$2();if(t&&t.has(e))return t.get(e);var o={},
n=Object.defineProperty&&Object.getOwnPropertyDescriptor,i;for(i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(o,i,a):o[i]=e[i]}return o.default=e,t&&t.set(e,o),o}(require("../utils.js")),n$jscomp$0=e$jscomp$2.log},{"../utils.js":"iSxC"}],VHa8:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});exports.shimGetDisplayMedia=function(e,i$jscomp$0){e.navigator.mediaDevices&&
"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof i$jscomp$0?e.navigator.mediaDevices.getDisplayMedia=function(a){return i$jscomp$0(a).then(function(i){var t=a.video&&a.video.width,o=a.video&&a.video.height;return a.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:a.video&&a.video.frameRate||3}},t&&(a.video.mandatory.maxWidth=t),o&&(a.video.mandatory.maxHeight=o),e.navigator.mediaDevices.getUserMedia(a)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},
{}],uI5X:[function(require,module,exports){function n$jscomp$1(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n$jscomp$1=function(){return e},e}function o$jscomp$0(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s$jscomp$0(e$jscomp$0){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();return(s$jscomp$0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:
function(e){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e$jscomp$0)}function f(e$jscomp$1){e$jscomp$1.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(t){return e._shimmedLocalStreams[t][0]})};var t$jscomp$1=e$jscomp$1.RTCPeerConnection.prototype.addTrack;
e$jscomp$1.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t$jscomp$1.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t$jscomp$1.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};var r$jscomp$0=e$jscomp$1.RTCPeerConnection.prototype.addStream;e$jscomp$1.RTCPeerConnection.prototype.addStream=function(e$jscomp$0){var t$jscomp$0=
this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};e$jscomp$0.getTracks().forEach(function(e){if(t$jscomp$0.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError");});var n=this.getSenders();r$jscomp$0.apply(this,arguments);var i=this.getSenders().filter(function(e){return-1===n.indexOf(e)});this._shimmedLocalStreams[e$jscomp$0.id]=[e$jscomp$0].concat(i)};var n$jscomp$0=e$jscomp$1.RTCPeerConnection.prototype.removeStream;e$jscomp$1.RTCPeerConnection.prototype.removeStream=
function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n$jscomp$0.apply(this,arguments)};var i$jscomp$0=e$jscomp$1.RTCPeerConnection.prototype.removeTrack;e$jscomp$1.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(function(r){var n=t._shimmedLocalStreams[r].indexOf(e);-1!==n&&t._shimmedLocalStreams[r].splice(n,1);
1===t._shimmedLocalStreams[r].length&&delete t._shimmedLocalStreams[r]}),i$jscomp$0.apply(this,arguments)}}Object.defineProperty(exports,"__esModule",{value:!0});exports.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream};exports.shimOnTrack=function(t){if("object"!==s$jscomp$0(t)||!t.RTCPeerConnection||"ontrack"in t.RTCPeerConnection.prototype)e$jscomp$3.wrapPeerConnectionEvent(t,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),
e});else{Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack);this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var r$jscomp$0=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){var e$jscomp$0=this;return this._ontrackpoly||(this._ontrackpoly=function(r){r.stream.addEventListener("addtrack",
function(n){var i=t.RTCPeerConnection.prototype.getReceivers?e$jscomp$0.getReceivers().find(function(e){return e.track&&e.track.id===n.track.id}):{track:n.track};var o=new Event("track");o.track=n.track;o.receiver=i;o.transceiver={receiver:i};o.streams=[r.stream];e$jscomp$0.dispatchEvent(o)});r.stream.getTracks().forEach(function(n){var i=t.RTCPeerConnection.prototype.getReceivers?e$jscomp$0.getReceivers().find(function(e){return e.track&&e.track.id===n.id}):{track:n};var o=new Event("track");o.track=
n;o.receiver=i;o.transceiver={receiver:i};o.streams=[r.stream];e$jscomp$0.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),r$jscomp$0.apply(this,arguments)}}};exports.shimGetSendersWithDtmf=function(e$jscomp$1){if("object"===s$jscomp$0(e$jscomp$1)&&e$jscomp$1.RTCPeerConnection&&!("getSenders"in e$jscomp$1.RTCPeerConnection.prototype)&&"createDTMFSender"in e$jscomp$1.RTCPeerConnection.prototype){var t$jscomp$1=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&
("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e$jscomp$1.RTCPeerConnection.prototype.getSenders){e$jscomp$1.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r$jscomp$0=e$jscomp$1.RTCPeerConnection.prototype.addTrack;e$jscomp$1.RTCPeerConnection.prototype.addTrack=function(e,n){var i=r$jscomp$0.apply(this,arguments);return i||(i=t$jscomp$1(this,e),this._senders.push(i)),i};var n$jscomp$0=
e$jscomp$1.RTCPeerConnection.prototype.removeTrack;e$jscomp$1.RTCPeerConnection.prototype.removeTrack=function(e){n$jscomp$0.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i$jscomp$0=e$jscomp$1.RTCPeerConnection.prototype.addStream;e$jscomp$1.RTCPeerConnection.prototype.addStream=function(e$jscomp$0){var r=this;this._senders=this._senders||[];i$jscomp$0.apply(this,[e$jscomp$0]);e$jscomp$0.getTracks().forEach(function(e){r._senders.push(t$jscomp$1(r,e))})};
var o=e$jscomp$1.RTCPeerConnection.prototype.removeStream;e$jscomp$1.RTCPeerConnection.prototype.removeStream=function(e$jscomp$0){var t$jscomp$0=this;this._senders=this._senders||[];o.apply(this,[e$jscomp$0]);e$jscomp$0.getTracks().forEach(function(e){var r=t$jscomp$0._senders.find(function(t){return t.track===e});r&&t$jscomp$0._senders.splice(t$jscomp$0._senders.indexOf(r),1)})}}else if("object"===s$jscomp$0(e$jscomp$1)&&e$jscomp$1.RTCPeerConnection&&"getSenders"in e$jscomp$1.RTCPeerConnection.prototype&&
"createDTMFSender"in e$jscomp$1.RTCPeerConnection.prototype&&e$jscomp$1.RTCRtpSender&&!("dtmf"in e$jscomp$1.RTCRtpSender.prototype)){var a=e$jscomp$1.RTCPeerConnection.prototype.getSenders;e$jscomp$1.RTCPeerConnection.prototype.getSenders=function(){var e=this,t$jscomp$0=a.apply(this,[]);return t$jscomp$0.forEach(function(t){return t._pc=e}),t$jscomp$0};Object.defineProperty(e$jscomp$1.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=
this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}};exports.shimGetStats=function(e$jscomp$2){if(e$jscomp$2.RTCPeerConnection){var t$jscomp$1=e$jscomp$2.RTCPeerConnection.prototype.getStats;e$jscomp$2.RTCPeerConnection.prototype.getStats=function(){var e$jscomp$1=this,$jscomp$destructuring$var1=$jscomp.makeIterator(arguments),r$jscomp$0=$jscomp$destructuring$var1.next().value,n$jscomp$0=$jscomp$destructuring$var1.next().value;$jscomp$destructuring$var1=$jscomp$destructuring$var1.next().value;
if(0<arguments.length&&"function"==typeof r$jscomp$0)return t$jscomp$1.apply(this,arguments);if(0===t$jscomp$1.length&&(0===arguments.length||"function"!=typeof r$jscomp$0))return t$jscomp$1.apply(this,[]);var o=function(e$jscomp$0){var t$jscomp$0={};return e$jscomp$0.result().forEach(function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){r[t]=e.stat(t)});t$jscomp$0[r.id]=r}),t$jscomp$0},
s=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};return 2<=arguments.length?t$jscomp$1.apply(this,[function(e){n$jscomp$0(s(o(e)))},r$jscomp$0]):(new Promise(function(r,n){t$jscomp$1.apply(e$jscomp$1,[function(e){r(s(o(e)))},n])})).then(n$jscomp$0,$jscomp$destructuring$var1)}}};exports.shimSenderReceiverGetStats=function(t$jscomp$1){if("object"===s$jscomp$0(t$jscomp$1)&&t$jscomp$1.RTCPeerConnection&&t$jscomp$1.RTCRtpSender&&t$jscomp$1.RTCRtpReceiver){if(!("getStats"in
t$jscomp$1.RTCRtpSender.prototype)){var r$jscomp$0=t$jscomp$1.RTCPeerConnection.prototype.getSenders;r$jscomp$0&&(t$jscomp$1.RTCPeerConnection.prototype.getSenders=function(){var e=this,t$jscomp$0=r$jscomp$0.apply(this,[]);return t$jscomp$0.forEach(function(t){return t._pc=e}),t$jscomp$0});var n$jscomp$0=t$jscomp$1.RTCPeerConnection.prototype.addTrack;n$jscomp$0&&(t$jscomp$1.RTCPeerConnection.prototype.addTrack=function(){var e=n$jscomp$0.apply(this,arguments);return e._pc=this,e});t$jscomp$1.RTCRtpSender.prototype.getStats=
function(){var t=this;return this._pc.getStats().then(function(r){return e$jscomp$3.filterStats(r,t.track,!0)})}}if(!("getStats"in t$jscomp$1.RTCRtpReceiver.prototype)){var i$jscomp$0=t$jscomp$1.RTCPeerConnection.prototype.getReceivers;i$jscomp$0&&(t$jscomp$1.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t$jscomp$0=i$jscomp$0.apply(this,[]);return t$jscomp$0.forEach(function(t){return t._pc=e}),t$jscomp$0});e$jscomp$3.wrapPeerConnectionEvent(t$jscomp$1,"track",function(e){return e.receiver._pc=
e.srcElement,e});t$jscomp$1.RTCRtpReceiver.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(r){return e$jscomp$3.filterStats(r,t.track,!1)})}}if("getStats"in t$jscomp$1.RTCRtpSender.prototype&&"getStats"in t$jscomp$1.RTCRtpReceiver.prototype){var o=t$jscomp$1.RTCPeerConnection.prototype.getStats;t$jscomp$1.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof t$jscomp$1.MediaStreamTrack){var e$jscomp$0,r,n,i=arguments[0];return this.getSenders().forEach(function(t){t.track===
i&&(e$jscomp$0?n=!0:e$jscomp$0=t)}),this.getReceivers().forEach(function(e){return e.track===i&&(r?n=!0:r=e),e.track===i}),n||e$jscomp$0&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):e$jscomp$0?e$jscomp$0.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}}}};exports.shimAddTrackRemoveTrackWithNative=f;exports.shimAddTrackRemoveTrack=
function(t$jscomp$1){function p(e,t$jscomp$0){var r=t$jscomp$0.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){t=e._reverseStreams[t];r=r.replace(new RegExp(e._streams[t.id].id,"g"),t.id)}),new RTCSessionDescription({type:t$jscomp$0.type,sdp:r})}if(t$jscomp$1.RTCPeerConnection){var r$jscomp$1=e$jscomp$3.detectBrowser(t$jscomp$1);if(t$jscomp$1.RTCPeerConnection.prototype.addTrack&&65<=r$jscomp$1.version)return f(t$jscomp$1);var n$jscomp$0=t$jscomp$1.RTCPeerConnection.prototype.getLocalStreams;
t$jscomp$1.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t$jscomp$0=n$jscomp$0.apply(this);return this._reverseStreams=this._reverseStreams||{},t$jscomp$0.map(function(t){return e._reverseStreams[t.id]})};var i$jscomp$0=t$jscomp$1.RTCPeerConnection.prototype.addStream;t$jscomp$1.RTCPeerConnection.prototype.addStream=function(e$jscomp$0){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},e$jscomp$0.getTracks().forEach(function(e){if(r.getSenders().find(function(t){return t.track===
e}))throw new DOMException("Track already exists.","InvalidAccessError");}),!this._reverseStreams[e$jscomp$0.id]){var n=new t$jscomp$1.MediaStream(e$jscomp$0.getTracks());this._streams[e$jscomp$0.id]=n;this._reverseStreams[n.id]=e$jscomp$0;e$jscomp$0=n}i$jscomp$0.apply(this,[e$jscomp$0])};var s=t$jscomp$1.RTCPeerConnection.prototype.removeStream;t$jscomp$1.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};s.apply(this,
[this._streams[e.id]||e]);delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id];delete this._streams[e.id]};t$jscomp$1.RTCPeerConnection.prototype.addTrack=function(e,r){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(function(t){return t===e}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.",
"NotSupportedError");if(this.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};(i=this._streams[r.id])?(i.addTrack(e),Promise.resolve().then(function(){n.dispatchEvent(new Event("negotiationneeded"))})):(i=new t$jscomp$1.MediaStream([e]),this._streams[r.id]=i,this._reverseStreams[i.id]=r,this.addStream(i));return this.getSenders().find(function(t){return t.track===
e})};["createOffer","createAnswer"].forEach(function(e$jscomp$1){var r$jscomp$0=t$jscomp$1.RTCPeerConnection.prototype[e$jscomp$1],n=o$jscomp$0({},e$jscomp$1,function(){var e$jscomp$0=this,t$jscomp$0=arguments;return arguments.length&&"function"==typeof arguments[0]?r$jscomp$0.apply(this,[function(r){r=p(e$jscomp$0,r);t$jscomp$0[0].apply(null,[r])},function(e){t$jscomp$0[1]&&t$jscomp$0[1].apply(null,e)},arguments[2]]):r$jscomp$0.apply(this,arguments).then(function(t){return p(e$jscomp$0,t)})});t$jscomp$1.RTCPeerConnection.prototype[e$jscomp$1]=
n[e$jscomp$1]});var a=t$jscomp$1.RTCPeerConnection.prototype.setLocalDescription;t$jscomp$1.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,t$jscomp$0=arguments[0],r=t$jscomp$0.sdp,Object.keys(e._reverseStreams||[]).forEach(function(t){t=e._reverseStreams[t];r=r.replace(new RegExp(t.id,"g"),e._streams[t.id].id)}),new RTCSessionDescription({type:t$jscomp$0.type,sdp:r})),a.apply(this,arguments)):a.apply(this,arguments);var e,
t$jscomp$0,r};var c=Object.getOwnPropertyDescriptor(t$jscomp$1.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t$jscomp$1.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=c.get.apply(this);return""===e.type?e:p(this,e)}});t$jscomp$1.RTCPeerConnection.prototype.removeTrack=function(e){var t$jscomp$0,r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.",
"TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};Object.keys(this._streams).forEach(function(n){r._streams[n].getTracks().find(function(t){return e.track===t})&&(t$jscomp$0=r._streams[n])});t$jscomp$0&&(1===t$jscomp$0.getTracks().length?this.removeStream(this._reverseStreams[t$jscomp$0.id]):t$jscomp$0.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}};exports.shimPeerConnection=
function(t){var r$jscomp$0=e$jscomp$3.detectBrowser(t);if(!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection){53>r$jscomp$0.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var r=t.RTCPeerConnection.prototype[e],n=o$jscomp$0({},e,function(){return arguments[0]=new ("addIceCandidate"===e?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)});t.RTCPeerConnection.prototype[e]=
n[e]});var n$jscomp$0=t.RTCPeerConnection.prototype.addIceCandidate;t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?78>r$jscomp$0.version&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n$jscomp$0.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};exports.fixNegotiationNeeded=function(t){e$jscomp$3.wrapPeerConnectionEvent(t,"negotiationneeded",function(e){if("stable"===e.target.signalingState)return e})};Object.defineProperty(exports,
"shimGetUserMedia",{enumerable:!0,get:function(){return t$jscomp$2.shimGetUserMedia}});Object.defineProperty(exports,"shimGetDisplayMedia",{enumerable:!0,get:function(){return r$jscomp$2.shimGetDisplayMedia}});var e$jscomp$3=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=n$jscomp$1();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor,o;for(o in e)if(Object.prototype.hasOwnProperty.call(e,
o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}(require("../utils.js")),t$jscomp$2=require("./getusermedia"),r$jscomp$2=require("./getdisplaymedia")},{"../utils.js":"iSxC","./getusermedia":"s6SN","./getdisplaymedia":"VHa8"}],NZ1C:[function(require,module,exports){function e$jscomp$1(){if("function"!=typeof WeakMap)return null;var r=new WeakMap;return e$jscomp$1=function(){return r},r}Object.defineProperty(exports,
"__esModule",{value:!0});exports.filterIceServers=function(e$jscomp$0,t$jscomp$0){var n=!1;return(e$jscomp$0=JSON.parse(JSON.stringify(e$jscomp$0))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&r$jscomp$0.deprecated("RTCIceServer.url","RTCIceServer.urls");var u="string"==typeof t;return u&&(t=[t]),t=t.filter(function(r){return 0===r.indexOf("stun:")?!1:(r=r.startsWith("turn")&&!r.startsWith("turn:[")&&r.includes("transport\x3dudp"))&&!n?(n=!0,!0):r&&!n}),delete e.url,
e.urls=u?t[0]:t,!!t.length}})};var r$jscomp$0=function(r){if(r&&r.__esModule)return r;if(null===r||"object"!=typeof r&&"function"!=typeof r)return{default:r};var t=e$jscomp$1();if(t&&t.has(r))return t.get(r);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor,i;for(i in r)if(Object.prototype.hasOwnProperty.call(r,i)){var f=u?Object.getOwnPropertyDescriptor(r,i):null;f&&(f.get||f.set)?Object.defineProperty(n,i,f):n[i]=r[i]}return n.default=r,t&&t.set(r,n),n}(require("../utils"))},{"../utils":"iSxC"}],
YHvh:[function(require,module,exports){var r$jscomp$1={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r$jscomp$1.localCName=r$jscomp$1.generateIdentifier();r$jscomp$1.splitLines=function(r$jscomp$0){return r$jscomp$0.trim().split("\n").map(function(r){return r.trim()})};r$jscomp$1.splitSections=function(r$jscomp$0){return r$jscomp$0.split("\nm\x3d").map(function(r,e){return(0<e?"m\x3d"+r:r).trim()+"\r\n"})};r$jscomp$1.getDescription=function(e){return(e=r$jscomp$1.splitSections(e))&&
e[0]};r$jscomp$1.getMediaSections=function(e){e=r$jscomp$1.splitSections(e);return e.shift(),e};r$jscomp$1.matchPrefix=function(e,t){return r$jscomp$1.splitLines(e).filter(function(r){return 0===r.indexOf(t)})};r$jscomp$1.parseCandidate=function(r){var e;r={foundation:(e=0===r.indexOf("a\x3dcandidate:")?r.substring(12).split(" "):r.substring(10).split(" "))[0],component:parseInt(e[1],10),protocol:e[2].toLowerCase(),priority:parseInt(e[3],10),ip:e[4],address:e[4],port:parseInt(e[5],10),type:e[7]};
for(var n=8;n<e.length;n+=2)switch(e[n]){case "raddr":r.relatedAddress=e[n+1];break;case "rport":r.relatedPort=parseInt(e[n+1],10);break;case "tcptype":r.tcpType=e[n+1];break;case "ufrag":r.ufrag=e[n+1];r.usernameFragment=e[n+1];break;default:r[e[n]]=e[n+1]}return r};r$jscomp$1.writeCandidate=function(r){var e=[];e.push(r.foundation);e.push(r.component);e.push(r.protocol.toUpperCase());e.push(r.priority);e.push(r.address||r.ip);e.push(r.port);var t=r.type;return e.push("typ"),e.push(t),"host"!==t&&
r.relatedAddress&&r.relatedPort&&(e.push("raddr"),e.push(r.relatedAddress),e.push("rport"),e.push(r.relatedPort)),r.tcpType&&"tcp"===r.protocol.toLowerCase()&&(e.push("tcptype"),e.push(r.tcpType)),(r.usernameFragment||r.ufrag)&&(e.push("ufrag"),e.push(r.usernameFragment||r.ufrag)),"candidate:"+e.join(" ")};r$jscomp$1.parseIceOptions=function(r){return r.substr(14).split(" ")};r$jscomp$1.parseRtpMap=function(r){r=r.substr(9).split(" ");var t={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),
t.name=r[0],t.clockRate=parseInt(r[1],10),t.channels=3===r.length?parseInt(r[2],10):1,t.numChannels=t.channels,t};r$jscomp$1.writeRtpMap=function(r){var e=r.payloadType;void 0!==r.preferredPayloadType&&(e=r.preferredPayloadType);var t=r.channels||r.numChannels||1;return"a\x3drtpmap:"+e+" "+r.name+"/"+r.clockRate+(1!==t?"/"+t:"")+"\r\n"};r$jscomp$1.parseExtmap=function(r){r=r.substr(9).split(" ");return{id:parseInt(r[0],10),direction:0<r[0].indexOf("/")?r[0].split("/")[1]:"sendrecv",uri:r[1]}};r$jscomp$1.writeExtmap=
function(r){return"a\x3dextmap:"+(r.id||r.preferredId)+(r.direction&&"sendrecv"!==r.direction?"/"+r.direction:"")+" "+r.uri+"\r\n"};r$jscomp$1.parseFmtp=function(r){var e,t={};r=r.substr(r.indexOf(" ")+1).split(";");for(var a=0;a<r.length;a++)t[(e=r[a].trim().split("\x3d"))[0].trim()]=e[1];return t};r$jscomp$1.writeFmtp=function(r){var e$jscomp$0="",t=r.payloadType;if(void 0!==r.preferredPayloadType&&(t=r.preferredPayloadType),r.parameters&&Object.keys(r.parameters).length){var n=[];Object.keys(r.parameters).forEach(function(e){r.parameters[e]?
n.push(e+"\x3d"+r.parameters[e]):n.push(e)});e$jscomp$0+="a\x3dfmtp:"+t+" "+n.join(";")+"\r\n"}return e$jscomp$0};r$jscomp$1.parseRtcpFb=function(r){r=r.substr(r.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}};r$jscomp$1.writeRtcpFb=function(r$jscomp$0){var e="",t=r$jscomp$0.payloadType;return void 0!==r$jscomp$0.preferredPayloadType&&(t=r$jscomp$0.preferredPayloadType),r$jscomp$0.rtcpFeedback&&r$jscomp$0.rtcpFeedback.length&&r$jscomp$0.rtcpFeedback.forEach(function(r){e+=
"a\x3drtcp-fb:"+t+" "+r.type+(r.parameter&&r.parameter.length?" "+r.parameter:"")+"\r\n"}),e};r$jscomp$1.parseSsrcMedia=function(r){var e=r.indexOf(" "),t={ssrc:parseInt(r.substr(7,e-7),10)},n=r.indexOf(":",e);return-1<n?(t.attribute=r.substr(e+1,n-e-1),t.value=r.substr(n+1)):t.attribute=r.substr(e+1),t};r$jscomp$1.parseSsrcGroup=function(r$jscomp$0){r$jscomp$0=r$jscomp$0.substr(13).split(" ");return{semantics:r$jscomp$0.shift(),ssrcs:r$jscomp$0.map(function(r){return parseInt(r,10)})}};r$jscomp$1.getMid=
function(e){if(e=r$jscomp$1.matchPrefix(e,"a\x3dmid:")[0])return e.substr(6)};r$jscomp$1.parseFingerprint=function(r){r=r.substr(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1]}};r$jscomp$1.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r$jscomp$1.matchPrefix(e+t,"a\x3dfingerprint:").map(r$jscomp$1.parseFingerprint)}};r$jscomp$1.writeDtlsParameters=function(r$jscomp$0,e){var t="a\x3dsetup:"+e+"\r\n";return r$jscomp$0.fingerprints.forEach(function(r){t+="a\x3dfingerprint:"+
r.algorithm+" "+r.value+"\r\n"}),t};r$jscomp$1.getIceParameters=function(e,t){e=r$jscomp$1.splitLines(e);return{usernameFragment:(e=e.concat(r$jscomp$1.splitLines(t))).filter(function(r){return 0===r.indexOf("a\x3dice-ufrag:")})[0].substr(12),password:e.filter(function(r){return 0===r.indexOf("a\x3dice-pwd:")})[0].substr(10)}};r$jscomp$1.writeIceParameters=function(r){return"a\x3dice-ufrag:"+r.usernameFragment+"\r\na\x3dice-pwd:"+r.password+"\r\n"};r$jscomp$1.parseRtpParameters=function(e$jscomp$0){for(var t=
{codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r$jscomp$1.splitLines(e$jscomp$0)[0].split(" "),a=3;a<n.length;a++){var s=n[a],i=r$jscomp$1.matchPrefix(e$jscomp$0,"a\x3drtpmap:"+s+" ")[0];if(i){i=r$jscomp$1.parseRtpMap(i);var c=r$jscomp$1.matchPrefix(e$jscomp$0,"a\x3dfmtp:"+s+" ");switch(i.parameters=c.length?r$jscomp$1.parseFmtp(c[0]):{},i.rtcpFeedback=r$jscomp$1.matchPrefix(e$jscomp$0,"a\x3drtcp-fb:"+s+" ").map(r$jscomp$1.parseRtcpFb),t.codecs.push(i),i.name.toUpperCase()){case "RED":case "ULPFEC":t.fecMechanisms.push(i.name.toUpperCase())}}}return r$jscomp$1.matchPrefix(e$jscomp$0,
"a\x3dextmap:").forEach(function(e){t.headerExtensions.push(r$jscomp$1.parseExtmap(e))}),t};r$jscomp$1.writeRtpDescription=function(e$jscomp$0,t){var n="";n+="m\x3d"+e$jscomp$0+" ";n+=0<t.codecs.length?"9":"0";n+=" UDP/TLS/RTP/SAVPF ";n+=t.codecs.map(function(r){return void 0!==r.preferredPayloadType?r.preferredPayloadType:r.payloadType}).join(" ")+"\r\n";n+="c\x3dIN IP4 0.0.0.0\r\n";n+="a\x3drtcp:9 IN IP4 0.0.0.0\r\n";t.codecs.forEach(function(e){n+=r$jscomp$1.writeRtpMap(e);n+=r$jscomp$1.writeFmtp(e);
n+=r$jscomp$1.writeRtcpFb(e)});var a=0;return t.codecs.forEach(function(r){r.maxptime>a&&(a=r.maxptime)}),0<a&&(n+="a\x3dmaxptime:"+a+"\r\n"),n+="a\x3drtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){n+=r$jscomp$1.writeExtmap(e)}),n};r$jscomp$1.parseRtpEncodingParameters=function(e$jscomp$0){var t,n=[],a=r$jscomp$1.parseRtpParameters(e$jscomp$0),s=-1!==a.fecMechanisms.indexOf("RED"),i=-1!==a.fecMechanisms.indexOf("ULPFEC"),p=r$jscomp$1.matchPrefix(e$jscomp$0,"a\x3dssrc:").map(function(e){return r$jscomp$1.parseSsrcMedia(e)}).filter(function(r){return"cname"===
r.attribute}),c=0<p.length&&p[0].ssrc;p=r$jscomp$1.matchPrefix(e$jscomp$0,"a\x3dssrc-group:FID").map(function(r$jscomp$0){return r$jscomp$0.substr(17).split(" ").map(function(r){return parseInt(r,10)})});0<p.length&&1<p[0].length&&p[0][0]===c&&(t=p[0][1]);a.codecs.forEach(function(r){"RTX"===r.name.toUpperCase()&&r.parameters.apt&&(r={ssrc:c,codecPayloadType:parseInt(r.parameters.apt,10)},c&&t&&(r.rtx={ssrc:t}),n.push(r),s&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:c,mechanism:i?"red+ulpfec":"red"},
n.push(r)))});0===n.length&&c&&n.push({ssrc:c});var u=r$jscomp$1.matchPrefix(e$jscomp$0,"b\x3d");return u.length&&(u=0===u[0].indexOf("b\x3dTIAS:")?parseInt(u[0].substr(7),10):0===u[0].indexOf("b\x3dAS:")?950*parseInt(u[0].substr(5),10)-16E3:void 0,n.forEach(function(r){r.maxBitrate=u})),n};r$jscomp$1.parseRtcpParameters=function(e$jscomp$0){var t={},n=r$jscomp$1.matchPrefix(e$jscomp$0,"a\x3dssrc:").map(function(e){return r$jscomp$1.parseSsrcMedia(e)}).filter(function(r){return"cname"===r.attribute})[0];
n&&(t.cname=n.value,t.ssrc=n.ssrc);n=r$jscomp$1.matchPrefix(e$jscomp$0,"a\x3drtcp-rsize");t.reducedSize=0<n.length;t.compound=0===n.length;e$jscomp$0=r$jscomp$1.matchPrefix(e$jscomp$0,"a\x3drtcp-mux");return t.mux=0<e$jscomp$0.length,t};r$jscomp$1.parseMsid=function(e$jscomp$0){var t,n=r$jscomp$1.matchPrefix(e$jscomp$0,"a\x3dmsid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};e$jscomp$0=r$jscomp$1.matchPrefix(e$jscomp$0,"a\x3dssrc:").map(function(e){return r$jscomp$1.parseSsrcMedia(e)}).filter(function(r){return"msid"===
r.attribute});return 0<e$jscomp$0.length?{stream:(t=e$jscomp$0[0].value.split(" "))[0],track:t[1]}:void 0};r$jscomp$1.parseSctpDescription=function(e){var t,n=r$jscomp$1.parseMLine(e),a=r$jscomp$1.matchPrefix(e,"a\x3dmax-message-size:");0<a.length&&(t=parseInt(a[0].substr(19),10));isNaN(t)&&(t=65536);a=r$jscomp$1.matchPrefix(e,"a\x3dsctp-port:");if(0<a.length)return{port:parseInt(a[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(0<r$jscomp$1.matchPrefix(e,"a\x3dsctpmap:").length)return e=r$jscomp$1.matchPrefix(e,
"a\x3dsctpmap:")[0].substr(10).split(" "),{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:t}};r$jscomp$1.writeSctpDescription=function(r,e){var t=[];return t="DTLS/SCTP"!==r.protocol?["m\x3d"+r.kind+" 9 "+r.protocol+" "+e.protocol+"\r\n","c\x3dIN IP4 0.0.0.0\r\n","a\x3dsctp-port:"+e.port+"\r\n"]:["m\x3d"+r.kind+" 9 "+r.protocol+" "+e.port+"\r\n","c\x3dIN IP4 0.0.0.0\r\n","a\x3dsctpmap:"+e.port+" "+e.protocol+" 65535\r\n"],void 0!==e.maxMessageSize&&t.push("a\x3dmax-message-size:"+e.maxMessageSize+
"\r\n"),t.join("")};r$jscomp$1.generateSessionId=function(){return Math.random().toString().substr(2,21)};r$jscomp$1.writeSessionBoilerplate=function(e,t,n){t=void 0!==t?t:2;return"v\x3d0\r\no\x3d"+(n||"thisisadapterortc")+" "+(e||r$jscomp$1.generateSessionId())+" "+t+" IN IP4 127.0.0.1\r\ns\x3d-\r\nt\x3d0 0\r\n"};r$jscomp$1.writeMediaSection=function(e,t,n,a){t=r$jscomp$1.writeRtpDescription(e.kind,t);if(t+=r$jscomp$1.writeIceParameters(e.iceGatherer.getLocalParameters()),t+=r$jscomp$1.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),
"offer"===n?"actpass":"active"),t+="a\x3dmid:"+e.mid+"\r\n",e.direction?t+="a\x3d"+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?t+="a\x3dsendrecv\r\n":e.rtpSender?t+="a\x3dsendonly\r\n":e.rtpReceiver?t+="a\x3drecvonly\r\n":t+="a\x3dinactive\r\n",e.rtpSender)n="msid:"+a.id+" "+e.rtpSender.track.id+"\r\n",t=t+("a\x3d"+n)+("a\x3dssrc:"+e.sendEncodingParameters[0].ssrc+" "+n),e.sendEncodingParameters[0].rtx&&(t+="a\x3dssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+n,t+="a\x3dssrc-group:FID "+e.sendEncodingParameters[0].ssrc+
" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n");return t+="a\x3dssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r$jscomp$1.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(t+="a\x3dssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r$jscomp$1.localCName+"\r\n"),t};r$jscomp$1.getDirection=function(e,t){e=r$jscomp$1.splitLines(e);for(var a=0;a<e.length;a++)switch(e[a]){case "a\x3dsendrecv":case "a\x3dsendonly":case "a\x3drecvonly":case "a\x3dinactive":return e[a].substr(2)}return t?
r$jscomp$1.getDirection(t):"sendrecv"};r$jscomp$1.getKind=function(e){return r$jscomp$1.splitLines(e)[0].split(" ")[0].substr(2)};r$jscomp$1.isRejected=function(r){return"0"===r.split(" ",2)[1]};r$jscomp$1.parseMLine=function(e){e=r$jscomp$1.splitLines(e)[0].substr(2).split(" ");return{kind:e[0],port:parseInt(e[1],10),protocol:e[2],fmt:e.slice(3).join(" ")}};r$jscomp$1.parseOLine=function(e){e=r$jscomp$1.matchPrefix(e,"o\x3d")[0].substr(2).split(" ");return{username:e[0],sessionId:e[1],sessionVersion:parseInt(e[2],
10),netType:e[3],addressType:e[4],address:e[5]}};r$jscomp$1.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;e=r$jscomp$1.splitLines(e);for(var n=0;n<e.length;n++)if(2>e[n].length||"\x3d"!==e[n].charAt(1))return!1;return!0};"object"==typeof module&&(module.exports=r$jscomp$1)},{}],NJ2u:[function(require,module,exports){function r$jscomp$1(t,r,n,a,i){r=e$jscomp$3.writeRtpDescription(t.kind,r);if(r+=e$jscomp$3.writeIceParameters(t.iceGatherer.getLocalParameters()),r+=e$jscomp$3.writeDtlsParameters(t.dtlsTransport.getLocalParameters(),
"offer"===n?"actpass":i||"active"),r+="a\x3dmid:"+t.mid+"\r\n",t.rtpSender&&t.rtpReceiver?r+="a\x3dsendrecv\r\n":t.rtpSender?r+="a\x3dsendonly\r\n":t.rtpReceiver?r+="a\x3drecvonly\r\n":r+="a\x3dinactive\r\n",t.rtpSender)n=t.rtpSender._initialTrackId||t.rtpSender.track.id,t.rtpSender._initialTrackId=n,a="msid:"+(a?a.id:"-")+" "+n+"\r\n",r=r+("a\x3d"+a)+("a\x3dssrc:"+t.sendEncodingParameters[0].ssrc+" "+a),t.sendEncodingParameters[0].rtx&&(r+="a\x3dssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" "+a,
r+="a\x3dssrc-group:FID "+t.sendEncodingParameters[0].ssrc+" "+t.sendEncodingParameters[0].rtx.ssrc+"\r\n");return r+="a\x3dssrc:"+t.sendEncodingParameters[0].ssrc+" cname:"+e$jscomp$3.localCName+"\r\n",t.rtpSender&&t.sendEncodingParameters[0].rtx&&(r+="a\x3dssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" cname:"+e$jscomp$3.localCName+"\r\n"),r}function n$jscomp$1(e$jscomp$1,t){var r=!1;return(e$jscomp$1=JSON.parse(JSON.stringify(e$jscomp$1))).filter(function(e$jscomp$0){if(e$jscomp$0&&(e$jscomp$0.urls||
e$jscomp$0.url)){var n=e$jscomp$0.urls||e$jscomp$0.url;e$jscomp$0.url&&!e$jscomp$0.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var a="string"==typeof n;return a&&(n=[n]),n=n.filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport\x3dudp")||-1!==e.indexOf("turn:[")||r?0===e.indexOf("stun:")&&14393<=t&&-1===e.indexOf("?transport\x3dudp"):(r=!0,!0)}),delete e$jscomp$0.url,e$jscomp$0.urls=a?n[0]:n,!!n.length}})}function a$jscomp$1(e$jscomp$0,t$jscomp$0){var r$jscomp$0=
{codecs:[],headerExtensions:[],fecMechanisms:[]},n$jscomp$0=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]},a$jscomp$0=function(e,t,r,a){e=n$jscomp$0(e.parameters.apt,r);t=n$jscomp$0(t.parameters.apt,a);return e&&t&&e.name.toLowerCase()===t.name.toLowerCase()};return e$jscomp$0.codecs.forEach(function(n){for(var i=0;i<t$jscomp$0.codecs.length;i++){var s=t$jscomp$0.codecs[i];if(n.name.toLowerCase()===s.name.toLowerCase()&&
n.clockRate===s.clockRate&&("rtx"!==n.name.toLowerCase()||!n.parameters||!s.parameters.apt||a$jscomp$0(n,s,e$jscomp$0.codecs,t$jscomp$0.codecs))){(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(n.numChannels,s.numChannels);r$jscomp$0.codecs.push(s);s.rtcpFeedback=s.rtcpFeedback.filter(function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),e$jscomp$0.headerExtensions.forEach(function(e){for(var n=
0;n<t$jscomp$0.headerExtensions.length;n++){var a=t$jscomp$0.headerExtensions[n];if(e.uri===a.uri){r$jscomp$0.headerExtensions.push(a);break}}}),r$jscomp$0}function i$jscomp$1(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function s$jscomp$1(e$jscomp$0,t){var r=
e$jscomp$0.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return r||e$jscomp$0.addRemoteCandidate(t),!r}function o$jscomp$0(e,t){t=Error(t);return t.name=e,t.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],t}var e$jscomp$3=require("sdp");module.exports=function(c$jscomp$0,d$jscomp$0){function p$jscomp$0(e,t){t.addTrack(e);
t.dispatchEvent(new c$jscomp$0.MediaStreamTrackEvent("addtrack",{track:e}))}function l$jscomp$0(e,t,r,n){var a=new Event("track");a.track=t;a.receiver=r;a.transceiver={receiver:r};a.streams=n;c$jscomp$0.setTimeout(function(){e._dispatchEvent("track",a)})}var f$jscomp$0=function(t){var r=this,a=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){r[e]=a[e].bind(a)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=
[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",t=JSON.parse(JSON.stringify(t||{})),this.usingBundle="max-bundle"===t.bundlePolicy,"negotiate"===t.rtcpMuxPolicy)throw o$jscomp$0("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(t.rtcpMuxPolicy||(t.rtcpMuxPolicy="require"),t.iceTransportPolicy){case "all":case "relay":break;default:t.iceTransportPolicy=
"all"}switch(t.bundlePolicy){case "balanced":case "max-compat":case "max-bundle":break;default:t.bundlePolicy="balanced"}if(t.iceServers=n$jscomp$1(t.iceServers||[],d$jscomp$0),this._iceGatherers=[],t.iceCandidatePoolSize)for(var i=t.iceCandidatePoolSize;0<i;i--)this._iceGatherers.push(new c$jscomp$0.RTCIceGatherer({iceServers:t.iceServers,gatherPolicy:t.iceTransportPolicy}));else t.iceCandidatePoolSize=0;this._config=t;this.transceivers=[];this._sdpSessionId=e$jscomp$3.generateSessionId();this._sdpSessionVersion=
0;this._dtlsRole=void 0;this._isClosed=!1};Object.defineProperty(f$jscomp$0.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}});Object.defineProperty(f$jscomp$0.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}});f$jscomp$0.prototype.onicecandidate=null;f$jscomp$0.prototype.onaddstream=null;f$jscomp$0.prototype.ontrack=null;f$jscomp$0.prototype.onremovestream=null;f$jscomp$0.prototype.onsignalingstatechange=null;
f$jscomp$0.prototype.oniceconnectionstatechange=null;f$jscomp$0.prototype.onconnectionstatechange=null;f$jscomp$0.prototype.onicegatheringstatechange=null;f$jscomp$0.prototype.onnegotiationneeded=null;f$jscomp$0.prototype.ondatachannel=null;f$jscomp$0.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))};f$jscomp$0.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",
e)};f$jscomp$0.prototype.getConfiguration=function(){return this._config};f$jscomp$0.prototype.getLocalStreams=function(){return this.localStreams};f$jscomp$0.prototype.getRemoteStreams=function(){return this.remoteStreams};f$jscomp$0.prototype._createTransceiver=function(e,t){var r=0<this.transceivers.length;e={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,
recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};this.usingBundle&&r?(e.iceTransport=this.transceivers[0].iceTransport,e.dtlsTransport=this.transceivers[0].dtlsTransport):(r=this._createIceAndDtlsTransports(),e.iceTransport=r.iceTransport,e.dtlsTransport=r.dtlsTransport);return t||this.transceivers.push(e),e};f$jscomp$0.prototype.addTrack=function(e,t$jscomp$0){if(this._isClosed)throw o$jscomp$0("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");
var r;if(this.transceivers.find(function(t){return t.track===e}))throw o$jscomp$0("InvalidAccessError","Track already exists.");for(var n=0;n<this.transceivers.length;n++)this.transceivers[n].track||this.transceivers[n].kind!==e.kind||(r=this.transceivers[n]);return r||(r=this._createTransceiver(e.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(t$jscomp$0)&&this.localStreams.push(t$jscomp$0),r.track=e,r.stream=t$jscomp$0,r.rtpSender=new c$jscomp$0.RTCRtpSender(e,r.dtlsTransport),
r.rtpSender};f$jscomp$0.prototype.addStream=function(e$jscomp$1){var t$jscomp$0=this;if(15025<=d$jscomp$0)e$jscomp$1.getTracks().forEach(function(r){t$jscomp$0.addTrack(r,e$jscomp$1)});else{var r$jscomp$0=e$jscomp$1.clone();e$jscomp$1.getTracks().forEach(function(e$jscomp$0,t){var n=r$jscomp$0.getTracks()[t];e$jscomp$0.addEventListener("enabled",function(e){n.enabled=e.enabled})});r$jscomp$0.getTracks().forEach(function(e){t$jscomp$0.addTrack(e,r$jscomp$0)})}};f$jscomp$0.prototype.removeTrack=function(e$jscomp$0){if(this._isClosed)throw o$jscomp$0("InvalidStateError",
"Attempted to call removeTrack on a closed peerconnection.");if(!(e$jscomp$0 instanceof c$jscomp$0.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var t$jscomp$0=this.transceivers.find(function(t){return t.rtpSender===e$jscomp$0});if(!t$jscomp$0)throw o$jscomp$0("InvalidAccessError","Sender was not created by this connection.");var r=t$jscomp$0.stream;t$jscomp$0.rtpSender.stop();t$jscomp$0.rtpSender=null;t$jscomp$0.track=
null;t$jscomp$0.stream=null;-1===this.transceivers.map(function(e){return e.stream}).indexOf(r)&&-1<this.localStreams.indexOf(r)&&this.localStreams.splice(this.localStreams.indexOf(r),1);this._maybeFireNegotiationNeeded()};f$jscomp$0.prototype.removeStream=function(e$jscomp$0){var t$jscomp$0=this;e$jscomp$0.getTracks().forEach(function(e){var r=t$jscomp$0.getSenders().find(function(t){return t.track===e});r&&t$jscomp$0.removeTrack(r)})};f$jscomp$0.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})};
f$jscomp$0.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})};f$jscomp$0.prototype._createIceGatherer=function(e,t$jscomp$0){var r=this;if(t$jscomp$0&&0<e)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var n=new c$jscomp$0.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(n,"state",
{value:"new",writable:!0}),this.transceivers[e].bufferedCandidateEvents=[],this.transceivers[e].bufferCandidates=function(t){var a=!t.candidate||0===Object.keys(t.candidate).length;n.state=a?"completed":"gathering";null!==r.transceivers[e].bufferedCandidateEvents&&r.transceivers[e].bufferedCandidateEvents.push(t)},n.addEventListener("localcandidate",this.transceivers[e].bufferCandidates),n};f$jscomp$0.prototype._gather=function(t,r){var n=this,a=this.transceivers[r].iceGatherer;if(!a.onlocalcandidate){var i$jscomp$0=
this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null;a.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates);a.onlocalcandidate=function(i){if(!(n.usingBundle&&0<r)){var s=new Event("icecandidate");s.candidate={sdpMid:t,sdpMLineIndex:r};var o=i.candidate;(i=!o||0===Object.keys(o).length)?"new"!==a.state&&"gathering"!==a.state||(a.state="completed"):("new"===a.state&&(a.state="gathering"),o.component=1,o.ufrag=a.getLocalParameters().usernameFragment,
o=e$jscomp$3.writeCandidate(o),s.candidate=Object.assign(s.candidate,e$jscomp$3.parseCandidate(o)),s.candidate.candidate=o,s.candidate.toJSON=function(){return{candidate:s.candidate.candidate,sdpMid:s.candidate.sdpMid,sdpMLineIndex:s.candidate.sdpMLineIndex,usernameFragment:s.candidate.usernameFragment}});o=e$jscomp$3.getMediaSections(n._localDescription.sdp);o[s.candidate.sdpMLineIndex]+=i?"a\x3dend-of-candidates\r\n":"a\x3d"+s.candidate.candidate+"\r\n";n._localDescription.sdp=e$jscomp$3.getDescription(n._localDescription.sdp)+
o.join("");o=n.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});"gathering"!==n.iceGatheringState&&(n.iceGatheringState="gathering",n._emitGatheringStateChange());i||n._dispatchEvent("icecandidate",s);o&&(n._dispatchEvent("icecandidate",new Event("icecandidate")),n.iceGatheringState="complete",n._emitGatheringStateChange())}};c$jscomp$0.setTimeout(function(){i$jscomp$0.forEach(function(e){a.onlocalcandidate(e)})},0)}};f$jscomp$0.prototype._createIceAndDtlsTransports=
function(){var e=this,t=new c$jscomp$0.RTCIceTransport(null);t.onicestatechange=function(){e._updateIceConnectionState();e._updateConnectionState()};var r=new c$jscomp$0.RTCDtlsTransport(t);return r.ondtlsstatechange=function(){e._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0});e._updateConnectionState()},{iceTransport:t,dtlsTransport:r}};f$jscomp$0.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;
t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);(t=this.transceivers[e].iceTransport)&&(delete t.onicestatechange,delete this.transceivers[e].iceTransport);(t=this.transceivers[e].dtlsTransport)&&(delete t.ondtlsstatechange,delete t.onerror,delete this.transceivers[e].dtlsTransport)};f$jscomp$0.prototype._transceive=function(t,r,n){var i=a$jscomp$1(t.localCapabilities,t.remoteCapabilities);r&&t.rtpSender&&(i.encodings=t.sendEncodingParameters,i.rtcp={cname:e$jscomp$3.localCName,
compound:t.rtcpParameters.compound},t.recvEncodingParameters.length&&(i.rtcp.ssrc=t.recvEncodingParameters[0].ssrc),t.rtpSender.send(i));n&&t.rtpReceiver&&0<i.codecs.length&&("video"===t.kind&&t.recvEncodingParameters&&15019>d$jscomp$0&&t.recvEncodingParameters.forEach(function(e){delete e.rtx}),t.recvEncodingParameters.length?i.encodings=t.recvEncodingParameters:i.encodings=[{}],i.rtcp={compound:t.rtcpParameters.compound},t.rtcpParameters.cname&&(i.rtcp.cname=t.rtcpParameters.cname),t.sendEncodingParameters.length&&
(i.rtcp.ssrc=t.sendEncodingParameters[0].ssrc),t.rtpReceiver.receive(i))};f$jscomp$0.prototype.setLocalDescription=function(t$jscomp$0){var s=this;if(-1===["offer","answer"].indexOf(t$jscomp$0.type))return Promise.reject(o$jscomp$0("TypeError",'Unsupported type "'+t$jscomp$0.type+'"'));if(!i$jscomp$1("setLocalDescription",t$jscomp$0.type,s.signalingState)||s._isClosed)return Promise.reject(o$jscomp$0("InvalidStateError","Can not set local "+t$jscomp$0.type+" in state "+s.signalingState));if("offer"===
t$jscomp$0.type){var r$jscomp$0=e$jscomp$3.splitSections(t$jscomp$0.sdp);var n=r$jscomp$0.shift();r$jscomp$0.forEach(function(t,r){t=e$jscomp$3.parseRtpParameters(t);s.transceivers[r].localCapabilities=t});s.transceivers.forEach(function(e,t){s._gather(e.mid,t)})}else if("answer"===t$jscomp$0.type){r$jscomp$0=e$jscomp$3.splitSections(s._remoteDescription.sdp);n=r$jscomp$0.shift();var c=0<e$jscomp$3.matchPrefix(n,"a\x3dice-lite").length;r$jscomp$0.forEach(function(t,r){var i=s.transceivers[r],o=i.iceGatherer,
d=i.iceTransport,p=i.dtlsTransport,l=i.localCapabilities,f=i.remoteCapabilities;if(!(e$jscomp$3.isRejected(t)&&0===e$jscomp$3.matchPrefix(t,"a\x3dbundle-only").length||i.rejected)){var u=e$jscomp$3.getIceParameters(t,n);t=e$jscomp$3.getDtlsParameters(t,n);c&&(t.role="server");s.usingBundle&&0!==r||(s._gather(i.mid,r),"new"===d.state&&d.start(o,u,c?"controlling":"controlled"),"new"===p.state&&p.start(t));r=a$jscomp$1(l,f);s._transceive(i,0<r.codecs.length,!1)}})}return s._localDescription={type:t$jscomp$0.type,
sdp:t$jscomp$0.sdp},"offer"===t$jscomp$0.type?s._updateSignalingState("have-local-offer"):s._updateSignalingState("stable"),Promise.resolve()};f$jscomp$0.prototype.setRemoteDescription=function(t$jscomp$0){var r=this;if(-1===["offer","answer"].indexOf(t$jscomp$0.type))return Promise.reject(o$jscomp$0("TypeError",'Unsupported type "'+t$jscomp$0.type+'"'));if(!i$jscomp$1("setRemoteDescription",t$jscomp$0.type,r.signalingState)||r._isClosed)return Promise.reject(o$jscomp$0("InvalidStateError","Can not set remote "+
t$jscomp$0.type+" in state "+r.signalingState));var n$jscomp$0={};r.remoteStreams.forEach(function(e){n$jscomp$0[e.id]=e});var f=[],u$jscomp$0=e$jscomp$3.splitSections(t$jscomp$0.sdp),v=u$jscomp$0.shift(),h=0<e$jscomp$3.matchPrefix(v,"a\x3dice-lite").length,m=0<e$jscomp$3.matchPrefix(v,"a\x3dgroup:BUNDLE ").length;r.usingBundle=m;var g=e$jscomp$3.matchPrefix(v,"a\x3dice-options:")[0];return r.canTrickleIceCandidates=!!g&&0<=g.substr(14).split(" ").indexOf("trickle"),u$jscomp$0.forEach(function(i,
o){var l=e$jscomp$3.splitLines(i),u=e$jscomp$3.getKind(i),g=e$jscomp$3.isRejected(i)&&0===e$jscomp$3.matchPrefix(i,"a\x3dbundle-only").length,y=l[0].substr(2).split(" ")[2];l=e$jscomp$3.getDirection(i,v);var T=e$jscomp$3.parseMsid(i),E=e$jscomp$3.getMid(i)||e$jscomp$3.generateIdentifier();if(g||"application"===u&&("DTLS/SCTP"===y||"UDP/DTLS/SCTP"===y))r.transceivers[o]={mid:E,kind:u,protocol:y,rejected:!0};else{var C,D;!g&&r.transceivers[o]&&r.transceivers[o].rejected&&(r.transceivers[o]=r._createTransceiver(u,
!0));var I,L,M=e$jscomp$3.parseRtpParameters(i);g||(I=e$jscomp$3.getIceParameters(i,v),(L=e$jscomp$3.getDtlsParameters(i,v)).role="client");y=e$jscomp$3.parseRtpEncodingParameters(i);var O=e$jscomp$3.parseRtcpParameters(i),G=0<e$jscomp$3.matchPrefix(i,"a\x3dend-of-candidates",v).length;i=e$jscomp$3.matchPrefix(i,"a\x3dcandidate:").map(function(t){return e$jscomp$3.parseCandidate(t)}).filter(function(e){return 1===e.component});if(("offer"===t$jscomp$0.type||"answer"===t$jscomp$0.type)&&!g&&m&&0<o&&
r.transceivers[o]&&(r._disposeIceAndDtlsTransports(o),r.transceivers[o].iceGatherer=r.transceivers[0].iceGatherer,r.transceivers[o].iceTransport=r.transceivers[0].iceTransport,r.transceivers[o].dtlsTransport=r.transceivers[0].dtlsTransport,r.transceivers[o].rtpSender&&r.transceivers[o].rtpSender.setTransport(r.transceivers[0].dtlsTransport),r.transceivers[o].rtpReceiver&&r.transceivers[o].rtpReceiver.setTransport(r.transceivers[0].dtlsTransport)),"offer"!==t$jscomp$0.type||g){if("answer"===t$jscomp$0.type&&
!g){u=(C=r.transceivers[o]).iceGatherer;var w=C.iceTransport;var R=C.dtlsTransport;var _=C.rtpReceiver;g=C.sendEncodingParameters;E=C.localCapabilities;r.transceivers[o].recvEncodingParameters=y;r.transceivers[o].remoteCapabilities=M;r.transceivers[o].rtcpParameters=O;i.length&&"new"===w.state&&(!h&&!G||m&&0!==o?i.forEach(function(e){s$jscomp$1(C.iceTransport,e)}):w.setRemoteCandidates(i));m&&0!==o||("new"===w.state&&w.start(u,I,"controlling"),"new"===R.state&&R.start(L));!a$jscomp$1(C.localCapabilities,
C.remoteCapabilities).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&C.sendEncodingParameters[0].rtx&&delete C.sendEncodingParameters[0].rtx;r._transceive(C,"sendrecv"===l||"recvonly"===l,"sendrecv"===l||"sendonly"===l);!_||"sendrecv"!==l&&"sendonly"!==l?delete C.rtpReceiver:(D=_.track,T?(n$jscomp$0[T.stream]||(n$jscomp$0[T.stream]=new c$jscomp$0.MediaStream),p$jscomp$0(D,n$jscomp$0[T.stream]),f.push([D,_,n$jscomp$0[T.stream]])):(n$jscomp$0.default||(n$jscomp$0.default=new c$jscomp$0.MediaStream),
p$jscomp$0(D,n$jscomp$0.default),f.push([D,_,n$jscomp$0.default])))}}else{(C=r.transceivers[o]||r._createTransceiver(u)).mid=E;C.iceGatherer||(C.iceGatherer=r._createIceGatherer(o,m));i.length&&"new"===C.iceTransport.state&&(!G||m&&0!==o?i.forEach(function(e){s$jscomp$1(C.iceTransport,e)}):C.iceTransport.setRemoteCandidates(i));E=c$jscomp$0.RTCRtpReceiver.getCapabilities(u);15019>d$jscomp$0&&(E.codecs=E.codecs.filter(function(e){return"rtx"!==e.name}));g=C.sendEncodingParameters||[{ssrc:1001*(2*o+
2)}];I=!1;if("sendrecv"===l||"sendonly"===l){if(I=!C.rtpReceiver,_=C.rtpReceiver||new c$jscomp$0.RTCRtpReceiver(C.dtlsTransport,u),I)D=_.track,T&&"-"===T.stream||(T?(n$jscomp$0[T.stream]||(n$jscomp$0[T.stream]=new c$jscomp$0.MediaStream,Object.defineProperty(n$jscomp$0[T.stream],"id",{get:function(){return T.stream}})),Object.defineProperty(D,"id",{get:function(){return T.track}}),w=n$jscomp$0[T.stream]):(n$jscomp$0.default||(n$jscomp$0.default=new c$jscomp$0.MediaStream),w=n$jscomp$0.default)),w&&
(p$jscomp$0(D,w),C.associatedRemoteMediaStreams.push(w)),f.push([D,_,w])}else C.rtpReceiver&&C.rtpReceiver.track&&(C.associatedRemoteMediaStreams.forEach(function(e$jscomp$0){var n=e$jscomp$0.getTracks().find(function(e){return e.id===C.rtpReceiver.track.id});n&&(e$jscomp$0.removeTrack(n),e$jscomp$0.dispatchEvent(new c$jscomp$0.MediaStreamTrackEvent("removetrack",{track:n})))}),C.associatedRemoteMediaStreams=[]);C.localCapabilities=E;C.remoteCapabilities=M;C.rtpReceiver=_;C.rtcpParameters=O;C.sendEncodingParameters=
g;C.recvEncodingParameters=y;r._transceive(r.transceivers[o],!1,I)}}}),void 0===r._dtlsRole&&(r._dtlsRole="offer"===t$jscomp$0.type?"active":"passive"),r._remoteDescription={type:t$jscomp$0.type,sdp:t$jscomp$0.sdp},"offer"===t$jscomp$0.type?r._updateSignalingState("have-remote-offer"):r._updateSignalingState("stable"),Object.keys(n$jscomp$0).forEach(function(e$jscomp$0){var t=n$jscomp$0[e$jscomp$0];if(t.getTracks().length){if(-1===r.remoteStreams.indexOf(t)){r.remoteStreams.push(t);var a$jscomp$0=
new Event("addstream");a$jscomp$0.stream=t;c$jscomp$0.setTimeout(function(){r._dispatchEvent("addstream",a$jscomp$0)})}f.forEach(function(e){var n=e[0],a=e[1];t.id===e[2].id&&l$jscomp$0(r,n,a,[t])})}}),f.forEach(function(e){e[2]||l$jscomp$0(r,e[0],e[1],[])}),c$jscomp$0.setTimeout(function(){r&&r.transceivers&&r.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&0<e.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),
e.iceTransport.addRemoteCandidate({}))})},4E3),Promise.resolve()};f$jscomp$0.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop();e.dtlsTransport&&e.dtlsTransport.stop();e.rtpSender&&e.rtpSender.stop();e.rtpReceiver&&e.rtpReceiver.stop()});this._isClosed=!0;this._updateSignalingState("closed")};f$jscomp$0.prototype._updateSignalingState=function(e){this.signalingState=e;e=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",
e)};f$jscomp$0.prototype._maybeFireNegotiationNeeded=function(){var e=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,c$jscomp$0.setTimeout(function(){if(e.needNegotiation){e.needNegotiation=!1;var t=new Event("negotiationneeded");e._dispatchEvent("negotiationneeded",t)}},0))};f$jscomp$0.prototype._updateIceConnectionState=function(){var e$jscomp$0,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&
!e.rejected&&t[e.iceTransport.state]++}),e$jscomp$0="new",0<t.failed?e$jscomp$0="failed":0<t.checking?e$jscomp$0="checking":0<t.disconnected?e$jscomp$0="disconnected":0<t.new?e$jscomp$0="new":0<t.connected?e$jscomp$0="connected":0<t.completed&&(e$jscomp$0="completed"),e$jscomp$0!==this.iceConnectionState)this.iceConnectionState=e$jscomp$0,e$jscomp$0=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",e$jscomp$0)};f$jscomp$0.prototype._updateConnectionState=function(){var e$jscomp$0,
t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)}),t.connected+=t.completed,e$jscomp$0="new",0<t.failed?e$jscomp$0="failed":0<t.connecting?e$jscomp$0="connecting":0<t.disconnected?e$jscomp$0="disconnected":0<t.new?e$jscomp$0="new":0<t.connected&&(e$jscomp$0="connected"),e$jscomp$0!==this.connectionState)this.connectionState=e$jscomp$0,
e$jscomp$0=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",e$jscomp$0)};f$jscomp$0.prototype.createOffer=function(JSCompiler_OptimizeArgumentsArray_p0){var t$jscomp$0=this;if(t$jscomp$0._isClosed)return Promise.reject(o$jscomp$0("InvalidStateError","Can not call createOffer after close"));var n$jscomp$0=t$jscomp$0.transceivers.filter(function(e){return"audio"===e.kind}).length,a$jscomp$0=t$jscomp$0.transceivers.filter(function(e){return"video"===e.kind}).length;if(JSCompiler_OptimizeArgumentsArray_p0){if(JSCompiler_OptimizeArgumentsArray_p0.mandatory||
JSCompiler_OptimizeArgumentsArray_p0.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==JSCompiler_OptimizeArgumentsArray_p0.offerToReceiveAudio&&(n$jscomp$0=!0===JSCompiler_OptimizeArgumentsArray_p0.offerToReceiveAudio?1:!1===JSCompiler_OptimizeArgumentsArray_p0.offerToReceiveAudio?0:JSCompiler_OptimizeArgumentsArray_p0.offerToReceiveAudio);void 0!==JSCompiler_OptimizeArgumentsArray_p0.offerToReceiveVideo&&(a$jscomp$0=!0===JSCompiler_OptimizeArgumentsArray_p0.offerToReceiveVideo?
1:!1===JSCompiler_OptimizeArgumentsArray_p0.offerToReceiveVideo?0:JSCompiler_OptimizeArgumentsArray_p0.offerToReceiveVideo)}for(t$jscomp$0.transceivers.forEach(function(e){"audio"===e.kind?0>--n$jscomp$0&&(e.wantReceive=!1):"video"===e.kind&&0>--a$jscomp$0&&(e.wantReceive=!1)});0<n$jscomp$0||0<a$jscomp$0;)0<n$jscomp$0&&(t$jscomp$0._createTransceiver("audio"),n$jscomp$0--),0<a$jscomp$0&&(t$jscomp$0._createTransceiver("video"),a$jscomp$0--);var s$jscomp$0=e$jscomp$3.writeSessionBoilerplate(t$jscomp$0._sdpSessionId,
t$jscomp$0._sdpSessionVersion++);t$jscomp$0.transceivers.forEach(function(r,n){var a=r.track,i=r.kind,s=r.mid||e$jscomp$3.generateIdentifier();r.mid=s;r.iceGatherer||(r.iceGatherer=t$jscomp$0._createIceGatherer(n,t$jscomp$0.usingBundle));s=c$jscomp$0.RTCRtpSender.getCapabilities(i);15019>d$jscomp$0&&(s.codecs=s.codecs.filter(function(e){return"rtx"!==e.name}));s.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1");
r.remoteCapabilities&&r.remoteCapabilities.codecs&&r.remoteCapabilities.codecs.forEach(function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)})});s.headerExtensions.forEach(function(e){(r.remoteCapabilities&&r.remoteCapabilities.headerExtensions||[]).forEach(function(t){e.uri===t.uri&&(e.id=t.id)})});n=r.sendEncodingParameters||[{ssrc:1001*(2*n+1)}];a&&15019<=d$jscomp$0&&"video"===i&&!n[0].rtx&&(n[0].rtx={ssrc:n[0].ssrc+1});r.wantReceive&&
(r.rtpReceiver=new c$jscomp$0.RTCRtpReceiver(r.dtlsTransport,i));r.localCapabilities=s;r.sendEncodingParameters=n});"max-compat"!==t$jscomp$0._config.bundlePolicy&&(s$jscomp$0+="a\x3dgroup:BUNDLE "+t$jscomp$0.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n");s$jscomp$0+="a\x3dice-options:trickle\r\n";t$jscomp$0.transceivers.forEach(function(n,a){s$jscomp$0+=r$jscomp$1(n,n.localCapabilities,"offer",n.stream,t$jscomp$0._dtlsRole);s$jscomp$0+="a\x3drtcp-rsize\r\n";!n.iceGatherer||"new"===
t$jscomp$0.iceGatheringState||0!==a&&t$jscomp$0.usingBundle||(n.iceGatherer.getLocalCandidates().forEach(function(t){t.component=1;s$jscomp$0+="a\x3d"+e$jscomp$3.writeCandidate(t)+"\r\n"}),"completed"===n.iceGatherer.state&&(s$jscomp$0+="a\x3dend-of-candidates\r\n"))});JSCompiler_OptimizeArgumentsArray_p0=new c$jscomp$0.RTCSessionDescription({type:"offer",sdp:s$jscomp$0});return Promise.resolve(JSCompiler_OptimizeArgumentsArray_p0)};f$jscomp$0.prototype.createAnswer=function(){var t=this;if(t._isClosed)return Promise.reject(o$jscomp$0("InvalidStateError",
"Can not call createAnswer after close"));if("have-remote-offer"!==t.signalingState&&"have-local-pranswer"!==t.signalingState)return Promise.reject(o$jscomp$0("InvalidStateError","Can not call createAnswer in signalingState "+t.signalingState));var n=e$jscomp$3.writeSessionBoilerplate(t._sdpSessionId,t._sdpSessionVersion++);t.usingBundle&&(n+="a\x3dgroup:BUNDLE "+t.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n");n+="a\x3dice-options:trickle\r\n";var i=e$jscomp$3.getMediaSections(t._remoteDescription.sdp).length;
t.transceivers.forEach(function(e$jscomp$0,s){if(!(s+1>i)){if(e$jscomp$0.rejected)return"application"===e$jscomp$0.kind?"DTLS/SCTP"===e$jscomp$0.protocol?n+="m\x3dapplication 0 DTLS/SCTP 5000\r\n":n+="m\x3dapplication 0 "+e$jscomp$0.protocol+" webrtc-datachannel\r\n":"audio"===e$jscomp$0.kind?n+="m\x3daudio 0 UDP/TLS/RTP/SAVPF 0\r\na\x3drtpmap:0 PCMU/8000\r\n":"video"===e$jscomp$0.kind&&(n+="m\x3dvideo 0 UDP/TLS/RTP/SAVPF 120\r\na\x3drtpmap:120 VP8/90000\r\n"),void(n+="c\x3dIN IP4 0.0.0.0\r\na\x3dinactive\r\na\x3dmid:"+
e$jscomp$0.mid+"\r\n");var o;e$jscomp$0.stream&&("audio"===e$jscomp$0.kind?o=e$jscomp$0.stream.getAudioTracks()[0]:"video"===e$jscomp$0.kind&&(o=e$jscomp$0.stream.getVideoTracks()[0]),o&&15019<=d$jscomp$0&&"video"===e$jscomp$0.kind&&!e$jscomp$0.sendEncodingParameters[0].rtx&&(e$jscomp$0.sendEncodingParameters[0].rtx={ssrc:e$jscomp$0.sendEncodingParameters[0].ssrc+1}));s=a$jscomp$1(e$jscomp$0.localCapabilities,e$jscomp$0.remoteCapabilities);!s.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&
e$jscomp$0.sendEncodingParameters[0].rtx&&delete e$jscomp$0.sendEncodingParameters[0].rtx;n+=r$jscomp$1(e$jscomp$0,s,"answer",e$jscomp$0.stream,t._dtlsRole);e$jscomp$0.rtcpParameters&&e$jscomp$0.rtcpParameters.reducedSize&&(n+="a\x3drtcp-rsize\r\n")}});var s$jscomp$0=new c$jscomp$0.RTCSessionDescription({type:"answer",sdp:n});return Promise.resolve(s$jscomp$0)};f$jscomp$0.prototype.addIceCandidate=function(t){var r,n=this;return t&&void 0===t.sdpMLineIndex&&!t.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):
new Promise(function(a,i){if(!n._remoteDescription)return i(o$jscomp$0("InvalidStateError","Can not add ICE candidate without a remote description"));if(t&&""!==t.candidate){var c=t.sdpMLineIndex;if(t.sdpMid)for(var d=0;d<n.transceivers.length;d++)if(n.transceivers[d].mid===t.sdpMid){c=d;break}var p=n.transceivers[c];if(!p)return i(o$jscomp$0("OperationError","Can not add ICE candidate"));if(p.rejected)return a();d=0<Object.keys(t.candidate).length?e$jscomp$3.parseCandidate(t.candidate):{};if("tcp"===
d.protocol&&(0===d.port||9===d.port)||d.component&&1!==d.component)return a();if((0===c||0<c&&p.iceTransport!==n.transceivers[0].iceTransport)&&!s$jscomp$1(p.iceTransport,d))return i(o$jscomp$0("OperationError","Can not add ICE candidate"));i=t.candidate.trim();0===i.indexOf("a\x3d")&&(i=i.substr(2));(r=e$jscomp$3.getMediaSections(n._remoteDescription.sdp))[c]+="a\x3d"+(d.type?i:"end-of-candidates")+"\r\n";n._remoteDescription.sdp=e$jscomp$3.getDescription(n._remoteDescription.sdp)+r.join("")}else for(c=
0;c<n.transceivers.length&&(n.transceivers[c].rejected||(n.transceivers[c].iceTransport.addRemoteCandidate({}),(r=e$jscomp$3.getMediaSections(n._remoteDescription.sdp))[c]+="a\x3dend-of-candidates\r\n",n._remoteDescription.sdp=e$jscomp$3.getDescription(n._remoteDescription.sdp)+r.join(""),!n.usingBundle));c++);a()})};f$jscomp$0.prototype.getStats=function(e$jscomp$2){if(e$jscomp$2&&e$jscomp$2 instanceof c$jscomp$0.MediaStreamTrack){var t$jscomp$0=null;if(this.transceivers.forEach(function(r){r.rtpSender&&
r.rtpSender.track===e$jscomp$2?t$jscomp$0=r.rtpSender:r.rtpReceiver&&r.rtpReceiver.track===e$jscomp$2&&(t$jscomp$0=r.rtpReceiver)}),!t$jscomp$0)throw o$jscomp$0("InvalidAccessError","Invalid selector.");return t$jscomp$0.getStats()}var r$jscomp$0=[];return this.transceivers.forEach(function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(t){e[t]&&r$jscomp$0.push(e[t].getStats())})}),Promise.all(r$jscomp$0).then(function(e$jscomp$1){var t=new Map;return e$jscomp$1.forEach(function(e$jscomp$0){e$jscomp$0.forEach(function(e){t.set(e.id,
e)})}),t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(e$jscomp$1){if((e$jscomp$1=c$jscomp$0[e$jscomp$1])&&e$jscomp$1.prototype&&e$jscomp$1.prototype.getStats){var n$jscomp$0=e$jscomp$1.prototype.getStats;e$jscomp$1.prototype.getStats=function(){return n$jscomp$0.apply(this).then(function(e$jscomp$0){var r=new Map;return Object.keys(e$jscomp$0).forEach(function(n){var e=e$jscomp$0[n];e$jscomp$0[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",
candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type;r.set(n,e$jscomp$0[n])}),r})}}});var u$jscomp$1=["createOffer","createAnswer"];return u$jscomp$1.forEach(function(e$jscomp$0){var t$jscomp$0=f$jscomp$0.prototype[e$jscomp$0];f$jscomp$0.prototype[e$jscomp$0]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t$jscomp$0.apply(this,[arguments[2]]).then(function(t){"function"==typeof e[0]&&e[0].apply(null,
[t])},function(t){"function"==typeof e[1]&&e[1].apply(null,[t])}):t$jscomp$0.apply(this,arguments)}}),(u$jscomp$1=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e$jscomp$0){var t$jscomp$0=f$jscomp$0.prototype[e$jscomp$0];f$jscomp$0.prototype[e$jscomp$0]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t$jscomp$0.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)},function(t){"function"==typeof e[2]&&
e[2].apply(null,[t])}):t$jscomp$0.apply(this,arguments)}}),["getStats"].forEach(function(e$jscomp$0){var t=f$jscomp$0.prototype[e$jscomp$0];f$jscomp$0.prototype[e$jscomp$0]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),f$jscomp$0}},{sdp:"YHvh"}],YdKx:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});exports.shimGetUserMedia=function(e$jscomp$2){e$jscomp$2=
e$jscomp$2&&e$jscomp$2.navigator;var t=e$jscomp$2.mediaDevices.getUserMedia.bind(e$jscomp$2.mediaDevices);e$jscomp$2.mediaDevices.getUserMedia=function(e$jscomp$1){return t(e$jscomp$1).catch(function(e$jscomp$0){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e$jscomp$0))})}}},{}],P3bV:[function(require,module,exports){Object.defineProperty(exports,"__esModule",
{value:!0});exports.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],XRic:[function(require,module,exports){function c$jscomp$0(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c$jscomp$0=function(){return e},e}Object.defineProperty(exports,"__esModule",{value:!0});exports.shimPeerConnection=
function(n){var i=e$jscomp$0.detectBrowser(n);if(n.RTCIceGatherer&&(n.RTCIceCandidate||(n.RTCIceCandidate=function(e){return e}),n.RTCSessionDescription||(n.RTCSessionDescription=function(e){return e}),15025>i.version)){var o=Object.getOwnPropertyDescriptor(n.MediaStreamTrack.prototype,"enabled");Object.defineProperty(n.MediaStreamTrack.prototype,"enabled",{set:function(e){o.set.call(this,e);var t=new Event("enabled");t.enabled=e;this.dispatchEvent(t)}})}!n.RTCRtpSender||"dtmf"in n.RTCRtpSender.prototype||
Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new n.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}});n.RTCDtmfSender&&!n.RTCDTMFSender&&(n.RTCDTMFSender=n.RTCDtmfSender);var c=(0,r$jscomp$0.default)(n,i.version);n.RTCPeerConnection=function(r){return r&&r.iceServers&&(r.iceServers=(0,t$jscomp$0.filterIceServers)(r.iceServers,i.version),e$jscomp$0.log("ICE servers after filtering:",
r.iceServers)),new c(r)};n.RTCPeerConnection.prototype=c.prototype};exports.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};Object.defineProperty(exports,"shimGetUserMedia",{enumerable:!0,get:function(){return n$jscomp$0.shimGetUserMedia}});Object.defineProperty(exports,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i$jscomp$0.shimGetDisplayMedia}});var e$jscomp$0=function(e){if(e&&
e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=c$jscomp$0();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor,i;for(i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}(require("../utils")),t$jscomp$0=require("./filtericeservers"),r$jscomp$0=function(e){return e&&
e.__esModule?e:{default:e}}(require("rtcpeerconnection-shim")),n$jscomp$0=require("./getusermedia"),i$jscomp$0=require("./getdisplaymedia")},{"../utils":"iSxC","./filtericeservers":"NZ1C","rtcpeerconnection-shim":"NJ2u","./getusermedia":"YdKx","./getdisplaymedia":"P3bV"}],GzSv:[function(require,module,exports){function t$jscomp$1(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return t$jscomp$1=function(){return e},e}function r$jscomp$0(e$jscomp$0){$jscomp.initSymbol();$jscomp.initSymbol();
$jscomp.initSymbolIterator();return(r$jscomp$0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e$jscomp$0)}Object.defineProperty(exports,"__esModule",{value:!0});exports.shimGetUserMedia=function(t$jscomp$0){var o$jscomp$0=e$jscomp$1.detectBrowser(t$jscomp$0),n=t$jscomp$0&&t$jscomp$0.navigator;
t$jscomp$0=t$jscomp$0&&t$jscomp$0.MediaStreamTrack;if(n.getUserMedia=function(t,o,r){e$jscomp$1.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");n.mediaDevices.getUserMedia(t).then(o,r)},!(55<o$jscomp$0.version&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var a=function(e,t,o){t in e&&!(o in e)&&(e[o]=e[t],delete e[t])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===r$jscomp$0(e)&&"object"===
r$jscomp$0(e.audio)&&(e=JSON.parse(JSON.stringify(e)),a(e.audio,"autoGainControl","mozAutoGainControl"),a(e.audio,"noiseSuppression","mozNoiseSuppression")),s(e)},t$jscomp$0&&t$jscomp$0.prototype.getSettings){var p=t$jscomp$0.prototype.getSettings;t$jscomp$0.prototype.getSettings=function(){var e=p.apply(this,arguments);return a(e,"mozAutoGainControl","autoGainControl"),a(e,"mozNoiseSuppression","noiseSuppression"),e}}if(t$jscomp$0&&t$jscomp$0.prototype.applyConstraints){var u=t$jscomp$0.prototype.applyConstraints;
t$jscomp$0.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===r$jscomp$0(e)&&(e=JSON.parse(JSON.stringify(e)),a(e,"autoGainControl","mozAutoGainControl"),a(e,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[e])}}}};var e$jscomp$1=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var o=t$jscomp$1();if(o&&o.has(e))return o.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor,i;for(i in e)if(Object.prototype.hasOwnProperty.call(e,
i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,o&&o.set(e,r),r}(require("../utils"))},{"../utils":"iSxC"}],UuGU:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});exports.shimGetDisplayMedia=function(e,i){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(a){return a&&a.video?(!0===
a.video?a.video={mediaSource:i}:a.video.mediaSource=i,e.navigator.mediaDevices.getUserMedia(a)):(a=new DOMException("getDisplayMedia without video constraints is undefined"),a.name="NotFoundError",a.code=8,Promise.reject(a))})}},{}],Fzdr:[function(require,module,exports){function n$jscomp$1(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n$jscomp$1=function(){return e},e}function i$jscomp$0(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,
writable:!0}):e[t]=r,e}function a$jscomp$0(e$jscomp$0){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();return(a$jscomp$0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e$jscomp$0)}Object.defineProperty(exports,"__esModule",{value:!0});exports.shimOnTrack=function(e){"object"===
a$jscomp$0(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};exports.shimPeerConnection=function(t$jscomp$1){var r$jscomp$0=e$jscomp$2.detectBrowser(t$jscomp$1);if("object"===a$jscomp$0(t$jscomp$1)&&(t$jscomp$1.RTCPeerConnection||t$jscomp$1.mozRTCPeerConnection)){if(!t$jscomp$1.RTCPeerConnection&&t$jscomp$1.mozRTCPeerConnection&&
(t$jscomp$1.RTCPeerConnection=t$jscomp$1.mozRTCPeerConnection),53>r$jscomp$0.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var r=t$jscomp$1.RTCPeerConnection.prototype[e],n=i$jscomp$0({},e,function(){return arguments[0]=new ("addIceCandidate"===e?t$jscomp$1.RTCIceCandidate:t$jscomp$1.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)});t$jscomp$1.RTCPeerConnection.prototype[e]=n[e]}),68>r$jscomp$0.version){var n$jscomp$0=t$jscomp$1.RTCPeerConnection.prototype.addIceCandidate;
t$jscomp$1.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():n$jscomp$0.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var o={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},c=t$jscomp$1.RTCPeerConnection.prototype.getStats;t$jscomp$1.RTCPeerConnection.prototype.getStats=function(){var $jscomp$destructuring$var2=
$jscomp.makeIterator(arguments),e$jscomp$1=$jscomp$destructuring$var2.next().value,t$jscomp$0=$jscomp$destructuring$var2.next().value;$jscomp$destructuring$var2=$jscomp$destructuring$var2.next().value;return c.apply(this,[e$jscomp$1||null]).then(function(e$jscomp$0){if(53>r$jscomp$0.version&&!t$jscomp$0)try{e$jscomp$0.forEach(function(e){e.type=o[e.type]||e.type})}catch(n$3){if("TypeError"!==n$3.name)throw n$3;e$jscomp$0.forEach(function(t,r){e$jscomp$0.set(r,Object.assign({},t,{type:o[t.type]||t.type}))})}return e$jscomp$0}).then(t$jscomp$0,
$jscomp$destructuring$var2)}}};exports.shimSenderGetStats=function(e$jscomp$0){if("object"===a$jscomp$0(e$jscomp$0)&&e$jscomp$0.RTCPeerConnection&&e$jscomp$0.RTCRtpSender&&!(e$jscomp$0.RTCRtpSender&&"getStats"in e$jscomp$0.RTCRtpSender.prototype)){var t$jscomp$0=e$jscomp$0.RTCPeerConnection.prototype.getSenders;t$jscomp$0&&(e$jscomp$0.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t$jscomp$0.apply(this,[]);return r.forEach(function(t){return t._pc=e}),r});var r$jscomp$0=e$jscomp$0.RTCPeerConnection.prototype.addTrack;
r$jscomp$0&&(e$jscomp$0.RTCPeerConnection.prototype.addTrack=function(){var e=r$jscomp$0.apply(this,arguments);return e._pc=this,e});e$jscomp$0.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}};exports.shimReceiverGetStats=function(t$jscomp$1){if("object"===a$jscomp$0(t$jscomp$1)&&t$jscomp$1.RTCPeerConnection&&t$jscomp$1.RTCRtpSender&&!(t$jscomp$1.RTCRtpSender&&"getStats"in t$jscomp$1.RTCRtpReceiver.prototype)){var r=t$jscomp$1.RTCPeerConnection.prototype.getReceivers;
r&&(t$jscomp$1.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t$jscomp$0=r.apply(this,[]);return t$jscomp$0.forEach(function(t){return t._pc=e}),t$jscomp$0});e$jscomp$2.wrapPeerConnectionEvent(t$jscomp$1,"track",function(e){return e.receiver._pc=e.srcElement,e});t$jscomp$1.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}};exports.shimRemoveStream=function(t$jscomp$0){!t$jscomp$0.RTCPeerConnection||"removeStream"in t$jscomp$0.RTCPeerConnection.prototype||
(t$jscomp$0.RTCPeerConnection.prototype.removeStream=function(t){var r=this;e$jscomp$2.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(e){e.track&&t.getTracks().includes(e.track)&&r.removeTrack(e)})})};exports.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)};exports.shimAddTransceiver=function(e$jscomp$1){if("object"===a$jscomp$0(e$jscomp$1)&&e$jscomp$1.RTCPeerConnection){var t=e$jscomp$1.RTCPeerConnection.prototype.addTransceiver;
t&&(e$jscomp$1.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e$jscomp$0=arguments[1],r=e$jscomp$0&&"sendEncodings"in e$jscomp$0;r&&e$jscomp$0.sendEncodings.forEach(function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(1<=parseFloat(e.scaleResolutionDownBy)))throw new RangeError("scale_resolution_down_by must be \x3e\x3d 1.0");if("maxFramerate"in e&&!(0<=parseFloat(e.maxFramerate)))throw new RangeError("max_framerate must be \x3e\x3d 0.0");
});var n=t.apply(this,arguments);if(r){r=n.sender;var i=r.getParameters();"encodings"in i||(i.encodings=e$jscomp$0.sendEncodings,this.setParametersPromises.push(r.setParameters(i).catch(function(){})))}return n})}};exports.shimCreateOffer=function(e$jscomp$0){if("object"===a$jscomp$0(e$jscomp$0)&&e$jscomp$0.RTCPeerConnection){var t=e$jscomp$0.RTCPeerConnection.prototype.createOffer;e$jscomp$0.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,r=this;return this.setParametersPromises&&
this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return t.apply(r,e)}).finally(function(){r.setParametersPromises=[]}):t.apply(this,arguments)}}};exports.shimCreateAnswer=function(e$jscomp$0){if("object"===a$jscomp$0(e$jscomp$0)&&e$jscomp$0.RTCPeerConnection){var t=e$jscomp$0.RTCPeerConnection.prototype.createAnswer;e$jscomp$0.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,r=this;return this.setParametersPromises&&this.setParametersPromises.length?
Promise.all(this.setParametersPromises).then(function(){return t.apply(r,e)}).finally(function(){r.setParametersPromises=[]}):t.apply(this,arguments)}}};Object.defineProperty(exports,"shimGetUserMedia",{enumerable:!0,get:function(){return t$jscomp$2.shimGetUserMedia}});Object.defineProperty(exports,"shimGetDisplayMedia",{enumerable:!0,get:function(){return r$jscomp$1.shimGetDisplayMedia}});var e$jscomp$2=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};
var t=n$jscomp$1();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor,i;for(i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}(require("../utils")),t$jscomp$2=require("./getusermedia"),r$jscomp$1=require("./getdisplaymedia")},{"../utils":"iSxC","./getusermedia":"GzSv","./getdisplaymedia":"UuGU"}],t1lL:[function(require,
module,exports){function t$jscomp$2(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return t$jscomp$2=function(){return e},e}function o$jscomp$1(e$jscomp$0){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();return(o$jscomp$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?
"symbol":typeof e})(e$jscomp$0)}function c$jscomp$0(t){return t&&void 0!==t.video?Object.assign({},t,{video:e$jscomp$3.compactObject(t.video)}):t}Object.defineProperty(exports,"__esModule",{value:!0});exports.shimLocalStreamsAPI=function(e$jscomp$1){if("object"===o$jscomp$1(e$jscomp$1)&&e$jscomp$1.RTCPeerConnection){if("getLocalStreams"in e$jscomp$1.RTCPeerConnection.prototype||(e$jscomp$1.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),
!("addStream"in e$jscomp$1.RTCPeerConnection.prototype)){var t$jscomp$0=e$jscomp$1.RTCPeerConnection.prototype.addTrack;e$jscomp$1.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._localStreams||(this._localStreams=[]);this._localStreams.includes(e)||this._localStreams.push(e);e.getAudioTracks().forEach(function(o){return t$jscomp$0.call(r,o,e)});e.getVideoTracks().forEach(function(o){return t$jscomp$0.call(r,o,e)})};e$jscomp$1.RTCPeerConnection.prototype.addTrack=function(e){var r=
arguments[1];return r&&(this._localStreams?this._localStreams.includes(r)||this._localStreams.push(r):this._localStreams=[r]),t$jscomp$0.apply(this,arguments)}}"removeStream"in e$jscomp$1.RTCPeerConnection.prototype||(e$jscomp$1.RTCPeerConnection.prototype.removeStream=function(e$jscomp$0){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e$jscomp$0);if(-1!==r){this._localStreams.splice(r,1);var o=e$jscomp$0.getTracks();this.getSenders().forEach(function(e){o.includes(e.track)&&
t.removeTrack(e)})}})}};exports.shimRemoteStreamsAPI=function(e$jscomp$2){if("object"===o$jscomp$1(e$jscomp$2)&&e$jscomp$2.RTCPeerConnection&&("getRemoteStreams"in e$jscomp$2.RTCPeerConnection.prototype||(e$jscomp$2.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e$jscomp$2.RTCPeerConnection.prototype))){Object.defineProperty(e$jscomp$2.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},
set:function(e$jscomp$1){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly));this.addEventListener("addstream",this._onaddstream=e$jscomp$1);this.addEventListener("track",this._onaddstreampoly=function(e$jscomp$0){e$jscomp$0.streams.forEach(function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e;t.dispatchEvent(r)}})})}});
var t$jscomp$1=e$jscomp$2.RTCPeerConnection.prototype.setRemoteDescription;e$jscomp$2.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t$jscomp$0){t$jscomp$0.streams.forEach(function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(0<=e._remoteStreams.indexOf(t))){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t;e.dispatchEvent(r)}})}),t$jscomp$1.apply(e,arguments)}}};exports.shimCallbacksAPI=
function(e$jscomp$0){if("object"===o$jscomp$1(e$jscomp$0)&&e$jscomp$0.RTCPeerConnection){e$jscomp$0=e$jscomp$0.RTCPeerConnection.prototype;var r$jscomp$0=e$jscomp$0.createOffer,n$jscomp$0=e$jscomp$0.createAnswer,i=e$jscomp$0.setLocalDescription,a=e$jscomp$0.setRemoteDescription,s=e$jscomp$0.addIceCandidate;e$jscomp$0.createOffer=function(e,t){var n=r$jscomp$0.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);return t?(n.then(e,t),Promise.resolve()):n};e$jscomp$0.createAnswer=function(e,
t){var o=n$jscomp$0.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);return t?(o.then(e,t),Promise.resolve()):o};var c=function(e,t,r){e=i.apply(this,[e]);return r?(e.then(t,r),Promise.resolve()):e};e$jscomp$0.setLocalDescription=c;c=function(e,t,r){e=a.apply(this,[e]);return r?(e.then(t,r),Promise.resolve()):e};e$jscomp$0.setRemoteDescription=c;c=function(e,t,r){e=s.apply(this,[e]);return r?(e.then(t,r),Promise.resolve()):e};e$jscomp$0.addIceCandidate=c}};exports.shimGetUserMedia=function(e$jscomp$0){var t=
e$jscomp$0&&e$jscomp$0.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){e$jscomp$0=t.mediaDevices;var o$jscomp$0=e$jscomp$0.getUserMedia.bind(e$jscomp$0);t.mediaDevices.getUserMedia=function(e){return o$jscomp$0(c$jscomp$0(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,o){t.mediaDevices.getUserMedia(e).then(r,o)}.bind(t))};exports.shimConstraints=c$jscomp$0;exports.shimRTCIceServerUrls=function(t$jscomp$0){var r=t$jscomp$0.RTCPeerConnection;
t$jscomp$0.RTCPeerConnection=function(t,o){if(t&&t.iceServers){for(var n=[],i=0;i<t.iceServers.length;i++){var a=t.iceServers[i];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(e$jscomp$3.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,n.push(a)):n.push(t.iceServers[i])}t.iceServers=n}return new r(t,o)};t$jscomp$0.RTCPeerConnection.prototype=r.prototype;"generateCertificate"in t$jscomp$0.RTCPeerConnection&&Object.defineProperty(t$jscomp$0.RTCPeerConnection,
"generateCertificate",{get:function(){return r.generateCertificate}})};exports.shimTrackEventTransceiver=function(e){"object"===o$jscomp$1(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};exports.shimCreateOfferLegacy=function(e$jscomp$1){var t=e$jscomp$1.RTCPeerConnection.prototype.createOffer;e$jscomp$1.RTCPeerConnection.prototype.createOffer=
function(e$jscomp$0){if(e$jscomp$0){void 0!==e$jscomp$0.offerToReceiveAudio&&(e$jscomp$0.offerToReceiveAudio=!!e$jscomp$0.offerToReceiveAudio);var r=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind});!1===e$jscomp$0.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e$jscomp$0.offerToReceiveAudio||r||this.addTransceiver("audio");
void 0!==e$jscomp$0.offerToReceiveVideo&&(e$jscomp$0.offerToReceiveVideo=!!e$jscomp$0.offerToReceiveVideo);r=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind});!1===e$jscomp$0.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e$jscomp$0.offerToReceiveVideo||r||this.addTransceiver("video")}return t.apply(this,arguments)}};
var e$jscomp$3=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=t$jscomp$2();if(r&&r.has(e))return r.get(e);var o={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor,i;for(i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(o,i,a):o[i]=e[i]}return o.default=e,r&&r.set(e,o),o}(require("../utils"))},{"../utils":"iSxC"}],GOQK:[function(require,
module,exports){function n$jscomp$2(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n$jscomp$2=function(){return e},e}function i$jscomp$0(e$jscomp$0){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();return(i$jscomp$0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?
"symbol":typeof e})(e$jscomp$0)}Object.defineProperty(exports,"__esModule",{value:!0});exports.shimRTCIceCandidate=function(n$jscomp$0){if(n$jscomp$0.RTCIceCandidate&&!(n$jscomp$0.RTCIceCandidate&&"foundation"in n$jscomp$0.RTCIceCandidate.prototype)){var o=n$jscomp$0.RTCIceCandidate;n$jscomp$0.RTCIceCandidate=function(t){if("object"===i$jscomp$0(t)&&t.candidate&&0===t.candidate.indexOf("a\x3d")&&((t=JSON.parse(JSON.stringify(t))).candidate=t.candidate.substr(2)),t.candidate&&t.candidate.length){var n=
new o(t);t=e$jscomp$2.default.parseCandidate(t.candidate);var a=Object.assign(n,t);return a.toJSON=function(){return{candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex,usernameFragment:a.usernameFragment}},a}return new o(t)};n$jscomp$0.RTCIceCandidate.prototype=o.prototype;t$jscomp$1.wrapPeerConnectionEvent(n$jscomp$0,"icecandidate",function(e){return e.candidate&&Object.defineProperty(e,"candidate",{value:new n$jscomp$0.RTCIceCandidate(e.candidate),writable:"false"}),e})}};exports.shimMaxMessageSize=
function(n$jscomp$1){if(n$jscomp$1.RTCPeerConnection){var o=t$jscomp$1.detectBrowser(n$jscomp$1);"sctp"in n$jscomp$1.RTCPeerConnection.prototype||Object.defineProperty(n$jscomp$1.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var r$jscomp$0=n$jscomp$1.RTCPeerConnection.prototype.setRemoteDescription;n$jscomp$1.RTCPeerConnection.prototype.setRemoteDescription=function(){(this._sctp=null,"chrome"===o.browser&&76<=o.version)&&"plan-b"===this.getConfiguration().sdpSemantics&&
Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0});if(function(t$jscomp$0){if(!t$jscomp$0||!t$jscomp$0.sdp)return!1;t$jscomp$0=e$jscomp$2.default.splitSections(t$jscomp$0.sdp);return t$jscomp$0.shift(),t$jscomp$0.some(function(t){return(t=e$jscomp$2.default.parseMLine(t))&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})}(arguments[0])){var i=function(e){e=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===e||
2>e.length)return-1;e=parseInt(e[1],10);return e!=e?-1:e}(arguments[0]),a=(p=i,u=65536,"firefox"===o.browser&&(u=57>o.version?-1===p?16384:2147483637:60>o.version?57===o.version?65535:65536:2147483637),u);i=function(t,n){var r=65536;"firefox"===o.browser&&57===o.version&&(r=65535);t=e$jscomp$2.default.matchPrefix(t.sdp,"a\x3dmax-message-size:");return 0<t.length?r=parseInt(t[0].substr(19),10):"firefox"===o.browser&&-1!==n&&(r=2147483637),r}(arguments[0],i);var n$jscomp$0=0===a&&0===i?Number.POSITIVE_INFINITY:
0===a||0===i?Math.max(a,i):Math.min(a,i);a={};Object.defineProperty(a,"maxMessageSize",{get:function(){return n$jscomp$0}});this._sctp=a}var p,u;return r$jscomp$0.apply(this,arguments)}}};exports.shimSendThrowTypeError=function(e$jscomp$0){function o$jscomp$0(e,t){var n=e.send;e.send=function(){var o=arguments[0];o=o.length||o.size||o.byteLength;if("open"===e.readyState&&t.sctp&&o>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");
return n.apply(e,arguments)}}if(e$jscomp$0.RTCPeerConnection&&"createDataChannel"in e$jscomp$0.RTCPeerConnection.prototype){var n$jscomp$0=e$jscomp$0.RTCPeerConnection.prototype.createDataChannel;e$jscomp$0.RTCPeerConnection.prototype.createDataChannel=function(){var e=n$jscomp$0.apply(this,arguments);return o$jscomp$0(e,this),e};t$jscomp$1.wrapPeerConnectionEvent(e$jscomp$0,"datachannel",function(e){return o$jscomp$0(e.channel,e.target),e})}};exports.shimConnectionState=function(e$jscomp$1){if(e$jscomp$1.RTCPeerConnection&&
!("connectionState"in e$jscomp$1.RTCPeerConnection.prototype)){var t$jscomp$0=e$jscomp$1.RTCPeerConnection.prototype;Object.defineProperty(t$jscomp$0,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0});Object.defineProperty(t$jscomp$0,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",
this._onconnectionstatechange),delete this._onconnectionstatechange);e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0});["setLocalDescription","setRemoteDescription"].forEach(function(e$jscomp$0){var n$jscomp$0=t$jscomp$0[e$jscomp$0];t$jscomp$0[e$jscomp$0]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=
t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n$jscomp$0.apply(this,arguments)}})}};exports.removeAllowExtmapMixed=function(e$jscomp$1){if(e$jscomp$1.RTCPeerConnection){var n=t$jscomp$1.detectBrowser(e$jscomp$1);if(!("chrome"===n.browser&&71<=n.version)){var o=e$jscomp$1.RTCPeerConnection.prototype.setRemoteDescription;e$jscomp$1.RTCPeerConnection.prototype.setRemoteDescription=
function(e$jscomp$0){return e$jscomp$0&&e$jscomp$0.sdp&&-1!==e$jscomp$0.sdp.indexOf("\na\x3dextmap-allow-mixed")&&(e$jscomp$0.sdp=e$jscomp$0.sdp.split("\n").filter(function(e){return"a\x3dextmap-allow-mixed"!==e.trim()}).join("\n")),o.apply(this,arguments)}}}};var e$jscomp$2=function(e){return e&&e.__esModule?e:{default:e}}(require("sdp")),t$jscomp$1=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=n$jscomp$2();if(t&&t.has(e))return t.get(e);
var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor,i;for(i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=r?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(o,i,a):o[i]=e[i]}return o.default=e,t&&t.set(e,o),o}(require("./utils"))},{sdp:"YHvh","./utils":"iSxC"}],KtlG:[function(require,module,exports){function n$jscomp$0(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n$jscomp$0=function(){return e},e}function o$jscomp$0(e){if(e&&
e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n$jscomp$0();if(r&&r.has(e))return r.get(e);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor,t;for(t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var a=s?Object.getOwnPropertyDescriptor(e,t):null;a&&(a.get||a.set)?Object.defineProperty(i,t,a):i[t]=e[t]}return i.default=e,r&&r.set(e,i),i}Object.defineProperty(exports,"__esModule",{value:!0});exports.adapterFactory=function(){var n=
(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},m=e$jscomp$0.log,h=e$jscomp$0.detectBrowser(n),d={browserDetails:h,commonShim:a$jscomp$0,extractVersion:e$jscomp$0.extractVersion,disableLog:e$jscomp$0.disableLog,disableWarnings:e$jscomp$0.disableWarnings};switch(h.browser){case "chrome":if(!r$jscomp$0||!r$jscomp$0.shimPeerConnection||!o.shimChrome)return m("Chrome shim is not included in this adapter release."),
d;m("adapter.js shimming chrome.");d.browserShim=r$jscomp$0;r$jscomp$0.shimGetUserMedia(n);r$jscomp$0.shimMediaStream(n);r$jscomp$0.shimPeerConnection(n);r$jscomp$0.shimOnTrack(n);r$jscomp$0.shimAddTrackRemoveTrack(n);r$jscomp$0.shimGetSendersWithDtmf(n);r$jscomp$0.shimGetStats(n);r$jscomp$0.shimSenderReceiverGetStats(n);r$jscomp$0.fixNegotiationNeeded(n);a$jscomp$0.shimRTCIceCandidate(n);a$jscomp$0.shimConnectionState(n);a$jscomp$0.shimMaxMessageSize(n);a$jscomp$0.shimSendThrowTypeError(n);a$jscomp$0.removeAllowExtmapMixed(n);
break;case "firefox":if(!s$jscomp$0||!s$jscomp$0.shimPeerConnection||!o.shimFirefox)return m("Firefox shim is not included in this adapter release."),d;m("adapter.js shimming firefox.");d.browserShim=s$jscomp$0;s$jscomp$0.shimGetUserMedia(n);s$jscomp$0.shimPeerConnection(n);s$jscomp$0.shimOnTrack(n);s$jscomp$0.shimRemoveStream(n);s$jscomp$0.shimSenderGetStats(n);s$jscomp$0.shimReceiverGetStats(n);s$jscomp$0.shimRTCDataChannel(n);s$jscomp$0.shimAddTransceiver(n);s$jscomp$0.shimCreateOffer(n);s$jscomp$0.shimCreateAnswer(n);
a$jscomp$0.shimRTCIceCandidate(n);a$jscomp$0.shimConnectionState(n);a$jscomp$0.shimMaxMessageSize(n);a$jscomp$0.shimSendThrowTypeError(n);break;case "edge":if(!i$jscomp$0||!i$jscomp$0.shimPeerConnection||!o.shimEdge)return m("MS edge shim is not included in this adapter release."),d;m("adapter.js shimming edge.");d.browserShim=i$jscomp$0;i$jscomp$0.shimGetUserMedia(n);i$jscomp$0.shimGetDisplayMedia(n);i$jscomp$0.shimPeerConnection(n);i$jscomp$0.shimReplaceTrack(n);a$jscomp$0.shimMaxMessageSize(n);
a$jscomp$0.shimSendThrowTypeError(n);break;case "safari":if(!t$jscomp$0||!o.shimSafari)return m("Safari shim is not included in this adapter release."),d;m("adapter.js shimming safari.");d.browserShim=t$jscomp$0;t$jscomp$0.shimRTCIceServerUrls(n);t$jscomp$0.shimCreateOfferLegacy(n);t$jscomp$0.shimCallbacksAPI(n);t$jscomp$0.shimLocalStreamsAPI(n);t$jscomp$0.shimRemoteStreamsAPI(n);t$jscomp$0.shimTrackEventTransceiver(n);t$jscomp$0.shimGetUserMedia(n);a$jscomp$0.shimRTCIceCandidate(n);a$jscomp$0.shimMaxMessageSize(n);
a$jscomp$0.shimSendThrowTypeError(n);a$jscomp$0.removeAllowExtmapMixed(n);break;default:m("Unsupported browser!")}return d};var e$jscomp$0=o$jscomp$0(require("./utils")),r$jscomp$0=o$jscomp$0(require("./chrome/chrome_shim")),i$jscomp$0=o$jscomp$0(require("./edge/edge_shim")),s$jscomp$0=o$jscomp$0(require("./firefox/firefox_shim")),t$jscomp$0=o$jscomp$0(require("./safari/safari_shim")),a$jscomp$0=o$jscomp$0(require("./common_shim"))},{"./utils":"iSxC","./chrome/chrome_shim":"uI5X","./edge/edge_shim":"XRic",
"./firefox/firefox_shim":"Fzdr","./safari/safari_shim":"t1lL","./common_shim":"GOQK"}],tI1X:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;require=require("./adapter_factory.js");require=(0,require.adapterFactory)({window:window});exports.default=require},{"./adapter_factory.js":"KtlG"}],sXtV:[function(require,module,exports){module=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,
"__esModule",{value:!0});require=module(require("webrtc-adapter"));exports.webRTCAdapter=require.default},{"webrtc-adapter":"tI1X"}],I31f:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var r$jscomp$0=require("./adapter");exports.Supports=new (function(){function e$jscomp$0(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform);this.supportedBrowsers=["firefox","chrome","safari"];this.minFirefoxVersion=59;this.minChromeVersion=72;this.minSafariVersion=
605}return e$jscomp$0.prototype.isWebRTCSupported=function(){return"undefined"!=typeof RTCPeerConnection},e$jscomp$0.prototype.isBrowserSupported=function(){var r=this.getBrowser(),e=this.getVersion();return!!this.supportedBrowsers.includes(r)&&("chrome"===r?e>=this.minChromeVersion:"firefox"===r?e>=this.minFirefoxVersion:"safari"===r&&!this.isIOS&&e>=this.minSafariVersion)},e$jscomp$0.prototype.getBrowser=function(){return r$jscomp$0.webRTCAdapter.browserDetails.browser},e$jscomp$0.prototype.getVersion=
function(){return r$jscomp$0.webRTCAdapter.browserDetails.version||0},e$jscomp$0.prototype.isUnifiedPlanSupported=function(){var e,i=this.getBrowser(),t=r$jscomp$0.webRTCAdapter.browserDetails.version||0;if("chrome"===i&&72>t)return!1;if("firefox"===i&&59<=t)return!0;if(!(window.RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype))return!1;i=!1;try{(e=new RTCPeerConnection).addTransceiver("audio"),i=!0}catch(n){}finally{e&&e.close()}return i},e$jscomp$0.prototype.toString=function(){return"Supports: \n    browser:"+
this.getBrowser()+" \n    version:"+this.getVersion()+" \n    isIOS:"+this.isIOS+" \n    isWebRTCSupported:"+this.isWebRTCSupported()+" \n    isBrowserSupported:"+this.isBrowserSupported()+" \n    isUnifiedPlanSupported:"+this.isUnifiedPlanSupported()},e$jscomp$0}())},{"./adapter":"sXtV"}],BHXf:[function(require,module,exports){module=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var t={};if(null!=r)for(var e in r)Object.hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.default=r,
t};Object.defineProperty(exports,"__esModule",{value:!0});var t$jscomp$0=module(require("peerjs-js-binarypack")),e$jscomp$0=require("./supports"),o$jscomp$0={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:0.peerjs.com:3478",username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};exports.util=new (function(){function r$jscomp$1(){this.CLOUD_HOST="0.peerjs.com";this.CLOUD_PORT=443;this.chunkedBrowsers={Chrome:1,chrome:1};this.chunkedMTU=16300;this.defaultConfig=o$jscomp$0;
this.browser=e$jscomp$0.Supports.getBrowser();this.browserVersion=e$jscomp$0.Supports.getVersion();var t={browser:e$jscomp$0.Supports.isBrowserSupported(),webRTC:e$jscomp$0.Supports.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(t.webRTC)try{var r=new RTCPeerConnection(o$jscomp$0);t.audioVideo=!0;var n=void 0;try{n=r.createDataChannel("_PEERJSTEST",{ordered:!0});t.data=!0;t.reliable=!!n.ordered;try{n.binaryType="blob",t.binaryBlob=!e$jscomp$0.Supports.isIOS}catch(a){}}catch(a$4){}finally{n&&
n.close()}}catch(a$5){}finally{r&&r.close()}this.supports=t;this.pack=t$jscomp$0.pack;this.unpack=t$jscomp$0.unpack;this._dataCount=1}return r$jscomp$1.prototype.noop=function(){},r$jscomp$1.prototype.validateId=function(r){return!r||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(r)},r$jscomp$1.prototype.chunk=function(r){for(var t=[],e=r.size,o=Math.ceil(e/exports.util.chunkedMTU),n=0,a=0;a<e;){var i=Math.min(e,a+exports.util.chunkedMTU);a=r.slice(a,i);t.push({__peerData:this._dataCount,n:n,data:a,
total:o});a=i;n++}return this._dataCount++,t},r$jscomp$1.prototype.blobToArrayBuffer=function(r$jscomp$0,t){var e=new FileReader;return e.onload=function(r){r.target&&t(r.target.result)},e.readAsArrayBuffer(r$jscomp$0),e},r$jscomp$1.prototype.binaryStringToArrayBuffer=function(r){for(var t=new Uint8Array(r.length),e=0;e<r.length;e++)t[e]=255&r.charCodeAt(e);return t.buffer},r$jscomp$1.prototype.randomToken=function(){return Math.random().toString(36).substr(2)},r$jscomp$1.prototype.isSecure=function(){return"https:"===
location.protocol},r$jscomp$1}())},{"peerjs-js-binarypack":"kdPp","./supports":"I31f"}],JJlS:[function(require,module,exports){function n$jscomp$0(){}function r$jscomp$0(e,t,n){this.fn=e;this.context=t;this.once=n||!1}function o$jscomp$0(e,n,o,s,i){if("function"!=typeof o)throw new TypeError("The listener must be a function");o=new r$jscomp$0(o,s||e,i);n=t$jscomp$0?t$jscomp$0+n:n;return e._events[n]?e._events[n].fn?e._events[n]=[e._events[n],o]:e._events[n].push(o):(e._events[n]=o,e._eventsCount++),
e}function s$jscomp$0(e,t){0==--e._eventsCount?e._events=new n$jscomp$0:delete e._events[t]}function i$jscomp$0(){this._events=new n$jscomp$0;this._eventsCount=0}var e$jscomp$0=Object.prototype.hasOwnProperty,t$jscomp$0="~";Object.create&&(n$jscomp$0.prototype=Object.create(null),(new n$jscomp$0).__proto__||(t$jscomp$0=!1));i$jscomp$0.prototype.eventNames=function(){var n,r,o=[];if(0===this._eventsCount)return o;for(r in n=this._events)e$jscomp$0.call(n,r)&&o.push(t$jscomp$0?r.slice(1):r);return Object.getOwnPropertySymbols?
o.concat(Object.getOwnPropertySymbols(n)):o};i$jscomp$0.prototype.listeners=function(e){e=this._events[t$jscomp$0?t$jscomp$0+e:e];if(!e)return[];if(e.fn)return[e.fn];for(var o=0,s=e.length,i=Array(s);o<s;o++)i[o]=e[o].fn;return i};i$jscomp$0.prototype.listenerCount=function(e){return(e=this._events[t$jscomp$0?t$jscomp$0+e:e])?e.fn?1:e.length:0};i$jscomp$0.prototype.emit=function(e,n,r,o,s,i){var c=t$jscomp$0?t$jscomp$0+e:e;if(!this._events[c])return!1;var f,a=this._events[c],l=arguments.length;if(a.fn){switch(a.once&&
this.removeListener(e,a.fn,void 0,!0),l){case 1:return a.fn.call(a.context),!0;case 2:return a.fn.call(a.context,n),!0;case 3:return a.fn.call(a.context,n,r),!0;case 4:return a.fn.call(a.context,n,r,o),!0;case 5:return a.fn.call(a.context,n,r,o,s),!0;case 6:return a.fn.call(a.context,n,r,o,s,i),!0}c=1;for(f=Array(l-1);c<l;c++)f[c-1]=arguments[c];a.fn.apply(a.context,f)}else{var h=a.length;for(c=0;c<h;c++)switch(a[c].once&&this.removeListener(e,a[c].fn,void 0,!0),l){case 1:a[c].fn.call(a[c].context);
break;case 2:a[c].fn.call(a[c].context,n);break;case 3:a[c].fn.call(a[c].context,n,r);break;case 4:a[c].fn.call(a[c].context,n,r,o);break;default:if(!f){var v=1;for(f=Array(l-1);v<l;v++)f[v-1]=arguments[v]}a[c].fn.apply(a[c].context,f)}}return!0};i$jscomp$0.prototype.on=function(e,t,n){return o$jscomp$0(this,e,t,n,!1)};i$jscomp$0.prototype.once=function(e,t,n){return o$jscomp$0(this,e,t,n,!0)};i$jscomp$0.prototype.removeListener=function(e,n,r,o){e=t$jscomp$0?t$jscomp$0+e:e;if(!this._events[e])return this;
if(!n)return s$jscomp$0(this,e),this;var c=this._events[e];if(c.fn)c.fn!==n||o&&!c.once||r&&c.context!==r||s$jscomp$0(this,e);else{for(var f=0,u=[],a=c.length;f<a;f++)(c[f].fn!==n||o&&!c[f].once||r&&c[f].context!==r)&&u.push(c[f]);u.length?this._events[e]=1===u.length?u[0]:u:s$jscomp$0(this,e)}return this};i$jscomp$0.prototype.removeAllListeners=function(e){var r;return e?(r=t$jscomp$0?t$jscomp$0+e:e,this._events[r]&&s$jscomp$0(this,r)):(this._events=new n$jscomp$0,this._eventsCount=0),this};i$jscomp$0.prototype.off=
i$jscomp$0.prototype.removeListener;i$jscomp$0.prototype.addListener=i$jscomp$0.prototype.on;i$jscomp$0.prefixed=t$jscomp$0;i$jscomp$0.EventEmitter=i$jscomp$0;"undefined"!=typeof module&&(module.exports=i$jscomp$0)},{}],WOs9:[function(require,module,exports){var r$jscomp$1=this&&this.__read||function(r,e){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var o="function"==typeof Symbol&&r[Symbol.iterator];if(!o)return r;var t;r=o.call(r);var i=[];try{for(;(void 0===e||0<e--)&&
!(t=r.next()).done;)i.push(t.value)}catch(s){var n={error:s}}finally{try{t&&!t.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error;}}return i},e$jscomp$0=this&&this.__spread||function(){for(var e=[],o=0;o<arguments.length;o++)e=e.concat(r$jscomp$1(arguments[o]));return e};Object.defineProperty(exports,"__esModule",{value:!0});var o$jscomp$0;!function(r){r[r.Disabled=0]="Disabled";r[r.Errors=1]="Errors";r[r.Warnings=2]="Warnings";r[r.All=3]="All"}(o$jscomp$0=exports.LogLevel||(exports.LogLevel=
{}));require=function(){function r$jscomp$0(){this._logLevel=o$jscomp$0.Disabled}return Object.defineProperty(r$jscomp$0.prototype,"logLevel",{get:function(){return this._logLevel},set:function(r){this._logLevel=r},enumerable:!0,configurable:!0}),r$jscomp$0.prototype.log=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];this._logLevel>=o$jscomp$0.All&&this._print.apply(this,e$jscomp$0([o$jscomp$0.All],r))},r$jscomp$0.prototype.warn=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=
arguments[t];this._logLevel>=o$jscomp$0.Warnings&&this._print.apply(this,e$jscomp$0([o$jscomp$0.Warnings],r))},r$jscomp$0.prototype.error=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];this._logLevel>=o$jscomp$0.Errors&&this._print.apply(this,e$jscomp$0([o$jscomp$0.Errors],r))},r$jscomp$0.prototype.setLogFunction=function(r){this._print=r},r$jscomp$0.prototype._print=function(r){for(var n=[],l=1;l<arguments.length;l++)n[l-1]=arguments[l];n=e$jscomp$0(["PeerJS: "],n);for(var s in n)n[s]instanceof
Error&&(n[s]="("+n[s].name+") "+n[s].message);r>=o$jscomp$0.All?console.log.apply(console,e$jscomp$0(n)):r>=o$jscomp$0.Warnings?console.warn.apply(console,e$jscomp$0(["WARNING"],n)):r>=o$jscomp$0.Errors&&console.error.apply(console,e$jscomp$0(["ERROR"],n))},r$jscomp$0}();exports.default=new require},{}],ZRYf:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});(function(e){e.Open="open";e.Stream="stream";e.Data="data";e.Close="close";e.Error="error";e.IceStateChanged=
"iceStateChanged"})(exports.ConnectionEventType||(exports.ConnectionEventType={}));(function(e){e.Data="data";e.Media="media"})(exports.ConnectionType||(exports.ConnectionType={}));(function(e){e.Open="open";e.Close="close";e.Connection="connection";e.Call="call";e.Disconnected="disconnected";e.Error="error"})(exports.PeerEventType||(exports.PeerEventType={}));(function(e){e.BrowserIncompatible="browser-incompatible";e.Disconnected="disconnected";e.InvalidID="invalid-id";e.InvalidKey="invalid-key";
e.Network="network";e.PeerUnavailable="peer-unavailable";e.SslUnavailable="ssl-unavailable";e.ServerError="server-error";e.SocketError="socket-error";e.SocketClosed="socket-closed";e.UnavailableID="unavailable-id";e.WebRTC="webrtc"})(exports.PeerErrorType||(exports.PeerErrorType={}));(function(e){e.Binary="binary";e.BinaryUTF8="binary-utf8";e.JSON="json"})(exports.SerializationType||(exports.SerializationType={}));(function(e){e.Message="message";e.Disconnected="disconnected";e.Error="error";e.Close=
"close"})(exports.SocketEventType||(exports.SocketEventType={}));(function(e){e.Heartbeat="HEARTBEAT";e.Candidate="CANDIDATE";e.Offer="OFFER";e.Answer="ANSWER";e.Open="OPEN";e.Error="ERROR";e.IdTaken="ID-TAKEN";e.InvalidKey="INVALID-KEY";e.Leave="LEAVE";e.Expire="EXPIRE"})(exports.ServerMessageType||(exports.ServerMessageType={}))},{}],wJlv:[function(require,module,exports){var e$jscomp$1=this&&this.__extends||function(){var e$jscomp$0=function(t$jscomp$0,n$jscomp$0){return(e$jscomp$0=Object.setPrototypeOf||
{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t$jscomp$0,n$jscomp$0)};return function(t,n){function s(){this.constructor=t}e$jscomp$0(t,n);t.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}(),t$jscomp$2=this&&this.__read||function(e,t){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var s;e=n.call(e);var i=[];
try{for(;(void 0===t||0<t--)&&!(s=e.next()).done;)i.push(s.value)}catch(c$6){var o={error:c$6}}finally{try{s&&!s.done&&(n=e.return)&&n.call(e)}finally{if(o)throw o.error;}}return i},n$jscomp$1=this&&this.__spread||function(){for(var e=[],n=0;n<arguments.length;n++)e=e.concat(t$jscomp$2(arguments[n]));return e},s$jscomp$0=this&&this.__values||function(e){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],s=0;if(n)return n.call(e);
if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.");};module=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var r$jscomp$0=require("eventemitter3"),i$jscomp$0=module(require("./logger")),c$jscomp$0=require("./enums");require=function(t$jscomp$1){function o$jscomp$0(e,
n,s,o,r,i){void 0===i&&(i=5E3);var c=t$jscomp$1.call(this)||this;c.pingInterval=i;c._disconnected=!0;c._messagesQueue=[];return c._baseUrl=(e?"wss://":"ws://")+n+":"+s+o+"peerjs?key\x3d"+r,c}return e$jscomp$1(o$jscomp$0,t$jscomp$1),o$jscomp$0.prototype.start=function(e$jscomp$0,t$jscomp$0){var n=this;this._id=e$jscomp$0;e$jscomp$0=this._baseUrl+"\x26id\x3d"+e$jscomp$0+"\x26token\x3d"+t$jscomp$0;!this._socket&&this._disconnected&&(this._socket=new WebSocket(e$jscomp$0),this._disconnected=!1,this._socket.onmessage=
function(e){try{var t=JSON.parse(e.data);i$jscomp$0.default.log("Server message received:",t)}catch(s$7){return void i$jscomp$0.default.log("Invalid server message",e.data)}n.emit(c$jscomp$0.SocketEventType.Message,t)},this._socket.onclose=function(e){n._disconnected||(i$jscomp$0.default.log("Socket closed.",e),n._cleanup(),n._disconnected=!0,n.emit(c$jscomp$0.SocketEventType.Disconnected))},this._socket.onopen=function(){n._disconnected||(n._sendQueuedMessages(),i$jscomp$0.default.log("Socket open"),
n._scheduleHeartbeat())})},o$jscomp$0.prototype._scheduleHeartbeat=function(){var e=this;this._wsPingTimer=setTimeout(function(){e._sendHeartbeat()},this.pingInterval)},o$jscomp$0.prototype._sendHeartbeat=function(){if(this._wsOpen()){var e=JSON.stringify({type:c$jscomp$0.ServerMessageType.Heartbeat});this._socket.send(e);this._scheduleHeartbeat()}else i$jscomp$0.default.log("Cannot send heartbeat, because socket closed")},o$jscomp$0.prototype._wsOpen=function(){return!!this._socket&&1===this._socket.readyState},
o$jscomp$0.prototype._sendQueuedMessages=function(){var t,o=n$jscomp$1(this._messagesQueue);this._messagesQueue=[];try{for(var r=s$jscomp$0(o),i=r.next();!i.done;i=r.next())this.send(i.value)}catch(a$8){var e={error:a$8}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error;}}},o$jscomp$0.prototype.send=function(e){this._disconnected||(this._id?e.type?this._wsOpen()&&(e=JSON.stringify(e),this._socket.send(e)):this.emit(c$jscomp$0.SocketEventType.Error,"Invalid message"):this._messagesQueue.push(e))},
o$jscomp$0.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},o$jscomp$0.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0);clearTimeout(this._wsPingTimer)},o$jscomp$0}(r$jscomp$0.EventEmitter);exports.Socket=require},{eventemitter3:"JJlS","./logger":"WOs9","./enums":"ZRYf"}],HCdX:[function(require,module,exports){var e$jscomp$2=this&&this.__assign||function(){return(e$jscomp$2=
Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)},n$jscomp$1=this&&this.__awaiter||function(e$jscomp$1,n$jscomp$0,t,o){return new (t||(t=Promise))(function(i,r){function c(e){try{s(o.next(e))}catch(n$9){r(n$9)}}function a(e){try{s(o.throw(e))}catch(n$10){r(n$10)}}function s(e$jscomp$0){var n;e$jscomp$0.done?i(e$jscomp$0.value):(n=e$jscomp$0.value,n instanceof t?n:
new t(function(e){e(n)})).then(c,a)}s((o=o.apply(e$jscomp$1,n$jscomp$0||[])).next())})},t$jscomp$0=this&&this.__generator||function(e,n){function a$jscomp$0(r$jscomp$0){return function(a){return function(r){if(t)throw new TypeError("Generator is already executing.");for(;c;)try{if(t=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};
case 5:c.label++;o=r[1];r=[0];continue;case 7:r=c.ops.pop();c.trys.pop();continue;default:if(!(i=0<(i=c.trys).length&&i[i.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3]))c.label=r[1];else if(6===r[0]&&c.label<i[1])c.label=i[1],i=r;else if(i&&c.label<i[2])c.label=i[2],c.ops.push(r);else{i[2]&&c.ops.pop();c.trys.pop();continue}}r=n.call(e,c)}catch(a$11){r=[6,a$11],o=0}finally{t=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r$jscomp$0,a])}}var t,
o,i,r$jscomp$1,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();return r$jscomp$1={next:a$jscomp$0(0),throw:a$jscomp$0(1),return:a$jscomp$0(2)},"function"==typeof Symbol&&(r$jscomp$1[Symbol.iterator]=function(){return this}),r$jscomp$1};module=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var i$jscomp$0=require("./util"),
r$jscomp$2=module(require("./logger")),c$jscomp$0=require("./enums");require=function(){function o$jscomp$0(e){this.connection=e}return o$jscomp$0.prototype.startConnection=function(e){var n=this._startPeerConnection();if(this.connection.peerConnection=n,this.connection.type===c$jscomp$0.ConnectionType.Media&&e._stream&&this._addTracksToConnection(e._stream,n),e.originator){if(this.connection.type===c$jscomp$0.ConnectionType.Data){var t=this.connection;e=n.createDataChannel(t.label,{ordered:!!e.reliable});
t.initialize(e)}this._makeOffer()}else this.handleSDP("OFFER",e.sdp)},o$jscomp$0.prototype._startPeerConnection=function(){r$jscomp$2.default.log("Creating RTCPeerConnection.");var e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e},o$jscomp$0.prototype._setupListeners=function(e$jscomp$0){var n=this,t=this.connection.peer,o=this.connection.connectionId,a$jscomp$0=this.connection.type,s=this.connection.provider;r$jscomp$2.default.log("Listening for ICE candidates.");
e$jscomp$0.onicecandidate=function(e){e.candidate&&e.candidate.candidate&&(r$jscomp$2.default.log("Received ICE candidates for "+t+":",e.candidate),s.socket.send({type:c$jscomp$0.ServerMessageType.Candidate,payload:{candidate:e.candidate,type:a$jscomp$0,connectionId:o},dst:t}))};e$jscomp$0.oniceconnectionstatechange=function(){switch(e$jscomp$0.iceConnectionState){case "failed":r$jscomp$2.default.log("iceConnectionState is failed, closing connections to "+t);n.connection.emit(c$jscomp$0.ConnectionEventType.Error,
Error("Negotiation of connection to "+t+" failed."));n.connection.close();break;case "closed":r$jscomp$2.default.log("iceConnectionState is closed, closing connections to "+t);n.connection.emit(c$jscomp$0.ConnectionEventType.Error,Error("Connection to "+t+" closed."));n.connection.close();break;case "disconnected":r$jscomp$2.default.log("iceConnectionState is disconnected, closing connections to "+t);n.connection.emit(c$jscomp$0.ConnectionEventType.Error,Error("Connection to "+t+" disconnected."));
n.connection.close();break;case "completed":e$jscomp$0.onicecandidate=i$jscomp$0.util.noop}n.connection.emit(c$jscomp$0.ConnectionEventType.IceStateChanged,e$jscomp$0.iceConnectionState)};r$jscomp$2.default.log("Listening for data channel");e$jscomp$0.ondatachannel=function(e){r$jscomp$2.default.log("Received data channel");e=e.channel;s.getConnection(t,o).initialize(e)};r$jscomp$2.default.log("Listening for remote stream");e$jscomp$0.ontrack=function(e){r$jscomp$2.default.log("Received remote stream");
e=e.streams[0];var a=s.getConnection(t,o);a.type===c$jscomp$0.ConnectionType.Media&&n._addStreamToMediaConnection(e,a)}},o$jscomp$0.prototype.cleanup=function(){r$jscomp$2.default.log("Cleaning up PeerConnection to "+this.connection.peer);var e=this.connection.peerConnection;if(e){this.connection.peerConnection=null;e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=function(){};var n="closed"!==e.signalingState,t=!1;if(this.connection.type===c$jscomp$0.ConnectionType.Data){var o=
this.connection.dataChannel;o&&(t=!!o.readyState&&"closed"!==o.readyState)}(n||t)&&e.close()}},o$jscomp$0.prototype._makeOffer=function(){return n$jscomp$1(this,void 0,Promise,function(){var n,o,a,s,d,l,u;return t$jscomp$0(this,function(t){switch(t.label){case 0:n=this.connection.peerConnection,o=this.connection.provider,t.label=1;case 1:return t.trys.push([1,7,,8]),[4,n.createOffer(this.connection.options.constraints)];case 2:a=t.sent(),r$jscomp$2.default.log("Created offer."),this.connection.options.sdpTransform&&
"function"==typeof this.connection.options.sdpTransform&&(a.sdp=this.connection.options.sdpTransform(a.sdp)||a.sdp),t.label=3;case 3:return t.trys.push([3,5,,6]),[4,n.setLocalDescription(a)];case 4:return t.sent(),r$jscomp$2.default.log("Set localDescription:",a,"for:"+this.connection.peer),s={sdp:a,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:i$jscomp$0.util.browser},this.connection.type===c$jscomp$0.ConnectionType.Data&&(d=this.connection,
s=e$jscomp$2(e$jscomp$2({},s),{label:d.label,reliable:d.reliable,serialization:d.serialization})),o.socket.send({type:c$jscomp$0.ServerMessageType.Offer,payload:s,dst:this.connection.peer}),[3,6];case 5:return"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=(l=t.sent())&&(o.emitError(c$jscomp$0.PeerErrorType.WebRTC,l),r$jscomp$2.default.log("Failed to setLocalDescription, ",l)),[3,6];case 6:return[3,8];case 7:return u=t.sent(),o.emitError(c$jscomp$0.PeerErrorType.WebRTC,
u),r$jscomp$2.default.log("Failed to createOffer, ",u),[3,8];case 8:return[2]}})})},o$jscomp$0.prototype._makeAnswer=function(){return n$jscomp$1(this,void 0,Promise,function(){var e,n,o,a,s;return t$jscomp$0(this,function(t){switch(t.label){case 0:e=this.connection.peerConnection,n=this.connection.provider,t.label=1;case 1:return t.trys.push([1,7,,8]),[4,e.createAnswer()];case 2:o=t.sent(),r$jscomp$2.default.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&
(o.sdp=this.connection.options.sdpTransform(o.sdp)||o.sdp),t.label=3;case 3:return t.trys.push([3,5,,6]),[4,e.setLocalDescription(o)];case 4:return t.sent(),r$jscomp$2.default.log("Set localDescription:",o,"for:"+this.connection.peer),n.socket.send({type:c$jscomp$0.ServerMessageType.Answer,payload:{sdp:o,type:this.connection.type,connectionId:this.connection.connectionId,browser:i$jscomp$0.util.browser},dst:this.connection.peer}),[3,6];case 5:return a=t.sent(),n.emitError(c$jscomp$0.PeerErrorType.WebRTC,
a),r$jscomp$2.default.log("Failed to setLocalDescription, ",a),[3,6];case 6:return[3,8];case 7:return s=t.sent(),n.emitError(c$jscomp$0.PeerErrorType.WebRTC,s),r$jscomp$2.default.log("Failed to create answer, ",s),[3,8];case 8:return[2]}})})},o$jscomp$0.prototype.handleSDP=function(e,o){return n$jscomp$1(this,void 0,Promise,function(){var n,i,a,s;return t$jscomp$0(this,function(t){switch(t.label){case 0:o=new RTCSessionDescription(o),n=this.connection.peerConnection,i=this.connection.provider,r$jscomp$2.default.log("Setting remote description",
o),a=this,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,n.setRemoteDescription(o)];case 2:return t.sent(),r$jscomp$2.default.log("Set remoteDescription:"+e+" for:"+this.connection.peer),"OFFER"!==e?[3,4]:[4,a._makeAnswer()];case 3:t.sent(),t.label=4;case 4:return[3,6];case 5:return s=t.sent(),i.emitError(c$jscomp$0.PeerErrorType.WebRTC,s),r$jscomp$2.default.log("Failed to setRemoteDescription, ",s),[3,6];case 6:return[2]}})})},o$jscomp$0.prototype.handleCandidate=function(e){return n$jscomp$1(this,
void 0,Promise,function(){var n,o,i,a,s,d;return t$jscomp$0(this,function(t){switch(t.label){case 0:r$jscomp$2.default.log("handleCandidate:",e),n=e.candidate,o=e.sdpMLineIndex,i=e.sdpMid,a=this.connection.peerConnection,s=this.connection.provider,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,a.addIceCandidate(new RTCIceCandidate({sdpMid:i,sdpMLineIndex:o,candidate:n}))];case 2:return t.sent(),r$jscomp$2.default.log("Added ICE candidate for:"+this.connection.peer),[3,4];case 3:return d=t.sent(),
s.emitError(c$jscomp$0.PeerErrorType.WebRTC,d),r$jscomp$2.default.log("Failed to handleCandidate, ",d),[3,4];case 4:return[2]}})})},o$jscomp$0.prototype._addTracksToConnection=function(e,n){if(r$jscomp$2.default.log("add tracks from stream "+e.id+" to peer connection"),!n.addTrack)return r$jscomp$2.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(function(t){n.addTrack(t,e)})},o$jscomp$0.prototype._addStreamToMediaConnection=function(e,n){r$jscomp$2.default.log("add stream "+
e.id+" to media connection "+n.connectionId);n.addStream(e)},o$jscomp$0}();exports.Negotiator=require},{"./util":"BHXf","./logger":"WOs9","./enums":"ZRYf"}],tQFK:[function(require,module,exports){var t$jscomp$1=this&&this.__extends||function(){var t$jscomp$0=function(e$jscomp$0,r$jscomp$0){return(t$jscomp$0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e$jscomp$0,r$jscomp$0)};return function(e,r){function n(){this.constructor=
e}t$jscomp$0(e,r);e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});require=function(e){function r$jscomp$0(t,r,n){var o=e.call(this)||this;return o.peer=t,o.provider=r,o.options=n,o._open=!1,o.metadata=n.metadata,o}return t$jscomp$1(r$jscomp$0,e),Object.defineProperty(r$jscomp$0.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),r$jscomp$0}(require("eventemitter3").EventEmitter);exports.BaseConnection=
require},{eventemitter3:"JJlS"}],dbHP:[function(require,module,exports){var e$jscomp$1=this&&this.__extends||function(){var e$jscomp$0=function(t$jscomp$0,o$jscomp$0){return(e$jscomp$0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t$jscomp$0,o$jscomp$0)};return function(t,o){function r(){this.constructor=t}e$jscomp$0(t,o);t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),
t$jscomp$1=this&&this.__assign||function(){return(t$jscomp$1=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},o$jscomp$1=this&&this.__values||function(e){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],r=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&
r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.");};module=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var n$jscomp$0=require("./util"),i=module(require("./logger")),a$jscomp$0=require("./negotiator"),s=require("./enums");require=function(r$jscomp$0){function l$jscomp$0(e,t,o){e=r$jscomp$0.call(this,e,t,o)||this;return e._localStream=
e.options._stream,e.connectionId=e.options.connectionId||l$jscomp$0.ID_PREFIX+n$jscomp$0.util.randomToken(),e._negotiator=new a$jscomp$0.Negotiator(e),e._localStream&&e._negotiator.startConnection({_stream:e._localStream,originator:!0}),e}return e$jscomp$1(l$jscomp$0,r$jscomp$0),Object.defineProperty(l$jscomp$0.prototype,"type",{get:function(){return s.ConnectionType.Media},enumerable:!0,configurable:!0}),Object.defineProperty(l$jscomp$0.prototype,"localStream",{get:function(){return this._localStream},
enumerable:!0,configurable:!0}),Object.defineProperty(l$jscomp$0.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!0,configurable:!0}),l$jscomp$0.prototype.addStream=function(e){i.default.log("Receiving stream",e);this._remoteStream=e;r$jscomp$0.prototype.emit.call(this,s.ConnectionEventType.Stream,e)},l$jscomp$0.prototype.handleMessage=function(e){var t=e.type,o=e.payload;switch(e.type){case s.ServerMessageType.Answer:this._negotiator.handleSDP(t,o.sdp);this._open=!0;
break;case s.ServerMessageType.Candidate:this._negotiator.handleCandidate(o.candidate);break;default:i.default.warn("Unrecognized message type:"+t+" from peer:"+this.peer)}},l$jscomp$0.prototype.answer=function(e,r){var a;if(void 0===r&&(r={}),this._localStream)i.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this._localStream=e;r&&r.sdpTransform&&(this.options.sdpTransform=r.sdpTransform);this._negotiator.startConnection(t$jscomp$1(t$jscomp$1({},
this.options._payload),{_stream:e}));e=this.provider._getMessages(this.connectionId);try{for(var l=o$jscomp$1(e),c=l.next();!c.done;c=l.next())this.handleMessage(c.value)}catch(u){var n={error:u}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error;}}this._open=!0}},l$jscomp$0.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null);this._remoteStream=this._localStream=null;this.provider&&(this.provider._removeConnection(this),this.provider=
null);this.options&&this.options._stream&&(this.options._stream=null);this.open&&(this._open=!1,r$jscomp$0.prototype.emit.call(this,s.ConnectionEventType.Close))},l$jscomp$0.ID_PREFIX="mc_",l$jscomp$0}(require("./baseconnection").BaseConnection);exports.MediaConnection=require},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK"}],GGp6:[function(require,module,exports){var e$jscomp$1=this&&this.__extends||function(){var e$jscomp$0=function(t$jscomp$0,
r$jscomp$0){return(e$jscomp$0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t$jscomp$0,r$jscomp$0)};return function(t,r){function o(){this.constructor=t}e$jscomp$0(t,r);t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();module=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var r$jscomp$1=
require("eventemitter3"),o$jscomp$0=module(require("./logger"));require=function(t$jscomp$0){function r(){var e=t$jscomp$0.call(this)||this;return e.fileReader=new FileReader,e._queue=[],e._processing=!1,e.fileReader.onload=function(t){e._processing=!1;t.target&&e.emit("done",t.target.result);e.doNextTask()},e.fileReader.onerror=function(t){o$jscomp$0.default.error("EncodingQueue error:",t);e._processing=!1;e.destroy();e.emit("error",t)},e}return e$jscomp$1(r,t$jscomp$0),Object.defineProperty(r.prototype,
"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"size",{get:function(){return this.queue.length},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"processing",{get:function(){return this._processing},enumerable:!0,configurable:!0}),r.prototype.enque=function(e){this.queue.push(e);this.processing||this.doNextTask()},r.prototype.destroy=function(){this.fileReader.abort();this._queue=[]},r.prototype.doNextTask=function(){0!==
this.size&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},r}(r$jscomp$1.EventEmitter);exports.EncodingQueue=require},{eventemitter3:"JJlS","./logger":"WOs9"}],GBTQ:[function(require,module,exports){var e$jscomp$1=this&&this.__extends||function(){var e$jscomp$0=function(t$jscomp$0,n$jscomp$0){return(e$jscomp$0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=
t[n])})(t$jscomp$0,n$jscomp$0)};return function(t,n){function i(){this.constructor=t}e$jscomp$0(t,n);t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),t$jscomp$1=this&&this.__values||function(e){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?
"Object is not iterable.":"Symbol.iterator is not defined.");};module=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var i$jscomp$0=require("./util"),o=module(require("./logger")),r$jscomp$0=require("./negotiator"),a=require("./enums");module=require("./baseconnection");var u$jscomp$0=require("./encodingQueue");require=function(n$jscomp$0){function s$jscomp$0(e$jscomp$0,t,l){var f=n$jscomp$0.call(this,e$jscomp$0,
t,l)||this;return f.stringify=JSON.stringify,f.parse=JSON.parse,f._buffer=[],f._bufferSize=0,f._buffering=!1,f._chunkedData={},f._encodingQueue=new u$jscomp$0.EncodingQueue,f.connectionId=f.options.connectionId||s$jscomp$0.ID_PREFIX+i$jscomp$0.util.randomToken(),f.label=f.options.label||f.connectionId,f.serialization=f.options.serialization||a.SerializationType.Binary,f.reliable=!!f.options.reliable,f._encodingQueue.on("done",function(e){f._bufferedSend(e)}),f._encodingQueue.on("error",function(){o.default.error("DC#"+
f.connectionId+": Error occured in encoding from blob to arraybuffer, close DC");f.close()}),f._negotiator=new r$jscomp$0.Negotiator(f),f._negotiator.startConnection(f.options._payload||{originator:!0}),f}return e$jscomp$1(s$jscomp$0,n$jscomp$0),Object.defineProperty(s$jscomp$0.prototype,"type",{get:function(){return a.ConnectionType.Data},enumerable:!0,configurable:!0}),Object.defineProperty(s$jscomp$0.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!0,configurable:!0}),Object.defineProperty(s$jscomp$0.prototype,
"bufferSize",{get:function(){return this._bufferSize},enumerable:!0,configurable:!0}),s$jscomp$0.prototype.initialize=function(e){this._dc=e;this._configureDataChannel()},s$jscomp$0.prototype._configureDataChannel=function(){var e=this;i$jscomp$0.util.supports.binaryBlob&&!i$jscomp$0.util.supports.reliable||(this.dataChannel.binaryType="arraybuffer");this.dataChannel.onopen=function(){o.default.log("DC#"+e.connectionId+" dc connection success");e._open=!0;e.emit(a.ConnectionEventType.Open)};this.dataChannel.onmessage=
function(t){o.default.log("DC#"+e.connectionId+" dc onmessage:",t.data);e._handleDataMessage(t)};this.dataChannel.onclose=function(){o.default.log("DC#"+e.connectionId+" dc closed for:",e.peer);e.close()}},s$jscomp$0.prototype._handleDataMessage=function(e$jscomp$0){var t=this;e$jscomp$0=e$jscomp$0.data;var r=e$jscomp$0.constructor,s=e$jscomp$0;if(this.serialization===a.SerializationType.Binary||this.serialization===a.SerializationType.BinaryUTF8){if(r===Blob)return void i$jscomp$0.util.blobToArrayBuffer(e$jscomp$0,
function(e){e=i$jscomp$0.util.unpack(e);t.emit(a.ConnectionEventType.Data,e)});r===ArrayBuffer?s=i$jscomp$0.util.unpack(e$jscomp$0):r===String&&(e$jscomp$0=i$jscomp$0.util.binaryStringToArrayBuffer(e$jscomp$0),s=i$jscomp$0.util.unpack(e$jscomp$0))}else this.serialization===a.SerializationType.JSON&&(s=this.parse(e$jscomp$0));s.__peerData?this._handleChunk(s):n$jscomp$0.prototype.emit.call(this,a.ConnectionEventType.Data,s)},s$jscomp$0.prototype._handleChunk=function(e){var t=e.__peerData,n=this._chunkedData[t]||
{data:[],count:0,total:e.total};if(n.data[e.n]=e.data,n.count++,this._chunkedData[t]=n,n.total===n.count)delete this._chunkedData[t],e=new Blob(n.data),this._handleDataMessage({data:e})},s$jscomp$0.prototype.close=function(){this._buffer=[];this._bufferSize=0;this._chunkedData={};this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null);this.provider&&(this.provider._removeConnection(this),this.provider=null);this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,
this.dataChannel.onclose=null,this._dc=null);this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null);this.open&&(this._open=!1,n$jscomp$0.prototype.emit.call(this,a.ConnectionEventType.Close))},s$jscomp$0.prototype.send=function(e,t){if(this.open)if(this.serialization===a.SerializationType.JSON)this._bufferedSend(this.stringify(e));else if(this.serialization===a.SerializationType.Binary||this.serialization===a.SerializationType.BinaryUTF8){e=
i$jscomp$0.util.pack(e);if(!t&&e.size>i$jscomp$0.util.chunkedMTU)return void this._sendChunks(e);i$jscomp$0.util.supports.binaryBlob?this._bufferedSend(e):this._encodingQueue.enque(e)}else this._bufferedSend(e);else n$jscomp$0.prototype.emit.call(this,a.ConnectionEventType.Error,Error("Connection is not open. You should listen for the `open` event before sending messages."))},s$jscomp$0.prototype._bufferedSend=function(e){!this._buffering&&this._trySend(e)||(this._buffer.push(e),this._bufferSize=
this._buffer.length)},s$jscomp$0.prototype._trySend=function(e){var t=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>s$jscomp$0.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(function(){t._buffering=!1;t._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(n$12){return o.default.error("DC#:"+this.connectionId+" Error when sending:",n$12),this._buffering=!0,this.close(),!1}return!0},s$jscomp$0.prototype._tryBuffer=function(){this.open&&0!==this._buffer.length&&this._trySend(this._buffer[0])&&
(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())},s$jscomp$0.prototype._sendChunks=function(e){var r;e=i$jscomp$0.util.chunk(e);o.default.log("DC#"+this.connectionId+" Try to send "+e.length+" chunks...");try{for(var s=t$jscomp$1(e),u=s.next();!u.done;u=s.next())this.send(u.value,!0)}catch(f){var n={error:f}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error;}}},s$jscomp$0.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case a.ServerMessageType.Answer:this._negotiator.handleSDP(e.type,
t.sdp);break;case a.ServerMessageType.Candidate:this._negotiator.handleCandidate(t.candidate);break;default:o.default.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},s$jscomp$0.ID_PREFIX="dc_",s$jscomp$0.MAX_BUFFERED_AMOUNT=8388608,s$jscomp$0}(module.BaseConnection);exports.DataConnection=require},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK","./encodingQueue":"GGp6"}],in7L:[function(require,module,exports){var t$jscomp$2=this&&
this.__awaiter||function(t$jscomp$1,e$jscomp$0,r,o){return new (r||(r=Promise))(function(n,s){function i(t){try{a(o.next(t))}catch(e$13){s(e$13)}}function u(t){try{a(o.throw(t))}catch(e$14){s(e$14)}}function a(t$jscomp$0){var e;t$jscomp$0.done?n(t$jscomp$0.value):(e=t$jscomp$0.value,e instanceof r?e:new r(function(t){t(e)})).then(i,u)}a((o=o.apply(t$jscomp$1,e$jscomp$0||[])).next())})},e$jscomp$1=this&&this.__generator||function(t,e){function u$jscomp$0(s$jscomp$0){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");
for(;i;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++;o=s[1];s=[0];continue;case 7:s=i.ops.pop();i.trys.pop();continue;default:if(!(n=0<(n=i.trys).length&&n[n.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3]))i.label=s[1];else if(6===s[0]&&i.label<n[1])i.label=n[1],
n=s;else if(n&&i.label<n[2])i.label=n[2],i.ops.push(s);else{n[2]&&i.ops.pop();i.trys.pop();continue}}s=e.call(t,i)}catch(u$15){s=[6,u$15],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s$jscomp$0,u])}}var r,o,n,s$jscomp$1,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();return s$jscomp$1={next:u$jscomp$0(0),throw:u$jscomp$0(1),return:u$jscomp$0(2)},"function"==typeof Symbol&&
(s$jscomp$1[Symbol.iterator]=function(){return this}),s$jscomp$1};module=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var o$jscomp$0=require("./util"),n$jscomp$0=module(require("./logger"));require=function(){function r$jscomp$0(t){this._options=t}return r$jscomp$0.prototype._buildUrl=function(t){return(this._options.secure?"https://":"http://")+this._options.host+":"+this._options.port+this._options.path+this._options.key+
"/"+t+("?ts\x3d"+(new Date).getTime()+Math.random())},r$jscomp$0.prototype.retrieveId=function(){return t$jscomp$2(this,void 0,Promise,function(){var t,r,s,i;return e$jscomp$1(this,function(e){switch(e.label){case 0:t=this._buildUrl("id"),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,fetch(t)];case 2:if(200!==(r=e.sent()).status)throw Error("Error. Status:"+r.status);return[2,r.text()];case 3:throw s=e.sent(),n$jscomp$0.default.error("Error retrieving ID",s),i="","/"===this._options.path&&this._options.host!==
o$jscomp$0.util.CLOUD_HOST&&(i=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),Error("Could not get an ID from the server."+i);case 4:return[2]}})})},r$jscomp$0.prototype.listAllPeers=function(){return t$jscomp$2(this,void 0,Promise,function(){var t,r,s,i;return e$jscomp$1(this,function(e){switch(e.label){case 0:t=this._buildUrl("peers"),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,fetch(t)];case 2:if(200!==(r=
e.sent()).status){if(401===r.status)throw s="",s=this._options.host===o$jscomp$0.util.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",Error("It doesn't look like you have permission to list peers IDs. "+s);throw Error("Error. Status:"+r.status);}return[2,r.json()];case 3:throw i=e.sent(),n$jscomp$0.default.error("Error retrieving list peers",
i),Error("Could not get list peers from the server."+i);case 4:return[2]}})})},r$jscomp$0}();exports.API=require},{"./util":"BHXf","./logger":"WOs9"}],Hxpd:[function(require,module,exports){var e$jscomp$1=this&&this.__extends||function(){var e$jscomp$0=function(t$jscomp$0,n$jscomp$0){return(e$jscomp$0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t$jscomp$0,n$jscomp$0)};return function(t,n){function r(){this.constructor=
t}e$jscomp$0(t,n);t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),t$jscomp$1=this&&this.__assign||function(){return(t$jscomp$1=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},n$jscomp$1=this&&this.__values||function(e){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var t="function"==typeof Symbol&&Symbol.iterator,
n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.");},r$jscomp$0=this&&this.__read||function(e,t){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r;e=n.call(e);var s=[];try{for(;(void 0===t||0<t--)&&!(r=e.next()).done;)s.push(r.value)}catch(a$16){var o=
{error:a$16}}finally{try{r&&!r.done&&(n=e.return)&&n.call(e)}finally{if(o)throw o.error;}}return s};module=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var i$jscomp$1=require("eventemitter3"),s$jscomp$0=require("./util"),a$jscomp$0=module(require("./logger")),c$jscomp$0=require("./socket"),l=require("./mediaconnection"),d=require("./dataconnection"),u=require("./enums"),p=require("./api");(function(){return function(){}})();
require=function(o$jscomp$0){function i$jscomp$0(e$jscomp$0,n){var r,c=o$jscomp$0.call(this)||this;return c._id=null,c._lastServerId=null,c._destroyed=!1,c._disconnected=!1,c._open=!1,c._connections=new Map,c._lostMessages=new Map,e$jscomp$0&&e$jscomp$0.constructor==Object?n=e$jscomp$0:e$jscomp$0&&(r=e$jscomp$0.toString()),n=t$jscomp$1({debug:0,host:s$jscomp$0.util.CLOUD_HOST,port:s$jscomp$0.util.CLOUD_PORT,path:"/",key:i$jscomp$0.DEFAULT_KEY,token:s$jscomp$0.util.randomToken(),config:s$jscomp$0.util.defaultConfig},
n),c._options=n,"/"===c._options.host&&(c._options.host=window.location.hostname),c._options.path&&("/"!==c._options.path[0]&&(c._options.path="/"+c._options.path),"/"!==c._options.path[c._options.path.length-1]&&(c._options.path+="/")),void 0===c._options.secure&&c._options.host!==s$jscomp$0.util.CLOUD_HOST?c._options.secure=s$jscomp$0.util.isSecure():c._options.host==s$jscomp$0.util.CLOUD_HOST&&(c._options.secure=!0),c._options.logFunction&&a$jscomp$0.default.setLogFunction(c._options.logFunction),
a$jscomp$0.default.logLevel=c._options.debug||0,c._api=new p.API(n),c._socket=c._createServerConnection(),s$jscomp$0.util.supports.audioVideo||s$jscomp$0.util.supports.data?r&&!s$jscomp$0.util.validateId(r)?(c._delayedAbort(u.PeerErrorType.InvalidID,'ID "'+r+'" is invalid'),c):(r?c._initialize(r):c._api.retrieveId().then(function(e){return c._initialize(e)}).catch(function(e){return c._abort(u.PeerErrorType.ServerError,e)}),c):(c._delayedAbort(u.PeerErrorType.BrowserIncompatible,"The current browser does not support WebRTC"),
c)}return e$jscomp$1(i$jscomp$0,o$jscomp$0),Object.defineProperty(i$jscomp$0.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(i$jscomp$0.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(i$jscomp$0.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),Object.defineProperty(i$jscomp$0.prototype,"socket",{get:function(){return this._socket},enumerable:!0,configurable:!0}),
Object.defineProperty(i$jscomp$0.prototype,"connections",{get:function(){var t,o=Object.create(null);try{for(var i=n$jscomp$1(this._connections),s=i.next();!s.done;s=i.next()){var a=r$jscomp$0(s.value,2);o[a[0]]=a[1]}}catch(d$17){var e={error:d$17}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error;}}return o},enumerable:!0,configurable:!0}),Object.defineProperty(i$jscomp$0.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!0,configurable:!0}),Object.defineProperty(i$jscomp$0.prototype,
"disconnected",{get:function(){return this._disconnected},enumerable:!0,configurable:!0}),i$jscomp$0.prototype._createServerConnection=function(){var e=this,t$jscomp$0=new c$jscomp$0.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return t$jscomp$0.on(u.SocketEventType.Message,function(t){e._handleMessage(t)}),t$jscomp$0.on(u.SocketEventType.Error,function(t){e._abort(u.PeerErrorType.SocketError,t)}),t$jscomp$0.on(u.SocketEventType.Disconnected,
function(){e.disconnected||(e.emitError(u.PeerErrorType.Network,"Lost connection to server."),e.disconnect())}),t$jscomp$0.on(u.SocketEventType.Close,function(){e.disconnected||e._abort(u.PeerErrorType.SocketClosed,"Underlying socket is already closed.")}),t$jscomp$0},i$jscomp$0.prototype._initialize=function(e){this._id=e;this.socket.start(e,this._options.token)},i$jscomp$0.prototype._handleMessage=function(e){var r,o=e.type,i=e.payload,s=e.src;switch(o){case u.ServerMessageType.Open:this._lastServerId=
this.id;this._open=!0;this.emit(u.PeerEventType.Open,this.id);break;case u.ServerMessageType.Error:this._abort(u.PeerErrorType.ServerError,i.msg);break;case u.ServerMessageType.IdTaken:this._abort(u.PeerErrorType.UnavailableID,'ID "'+this.id+'" is taken');break;case u.ServerMessageType.InvalidKey:this._abort(u.PeerErrorType.InvalidKey,'API KEY "'+this._options.key+'" is invalid');break;case u.ServerMessageType.Leave:a$jscomp$0.default.log("Received leave message from "+s);this._cleanupPeer(s);this._connections.delete(s);
break;case u.ServerMessageType.Expire:this.emitError(u.PeerErrorType.PeerUnavailable,"Could not connect to peer "+s);break;case u.ServerMessageType.Offer:o=i.connectionId;if((_=this.getConnection(s,o))&&(_.close(),a$jscomp$0.default.warn("Offer received for existing Connection ID:"+o)),i.type===u.ConnectionType.Media)_=new l.MediaConnection(s,this,{connectionId:o,_payload:i,metadata:i.metadata}),this._addConnection(s,_),this.emit(u.PeerEventType.Call,_);else{if(i.type!==u.ConnectionType.Data)return void a$jscomp$0.default.warn("Received malformed connection type:"+
i.type);_=new d.DataConnection(s,this,{connectionId:o,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable});this._addConnection(s,_);this.emit(u.PeerEventType.Connection,_)}e=this._getMessages(o);try{for(var h=n$jscomp$1(e),f=h.next();!f.done;f=h.next())_.handleMessage(f.value)}catch(v){var t={error:v}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(t)throw t.error;}}break;default:if(!i)return void a$jscomp$0.default.warn("You received a malformed message from "+
s+" of type "+o);var _;o=i.connectionId;(_=this.getConnection(s,o))&&_.peerConnection?_.handleMessage(e):o?this._storeMessage(o,e):a$jscomp$0.default.warn("You received an unrecognized message:",e)}},i$jscomp$0.prototype._storeMessage=function(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]);this._lostMessages.get(e).push(t)},i$jscomp$0.prototype._getMessages=function(e){var t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]},i$jscomp$0.prototype.connect=function(e,
t){if(void 0===t&&(t={}),this.disconnected)return a$jscomp$0.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError(u.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");t=new d.DataConnection(e,this,t);return this._addConnection(e,t),t},i$jscomp$0.prototype.call=
function(e,t,n){if(void 0===n&&(n={}),this.disconnected)return a$jscomp$0.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError(u.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");if(t)return n._stream=t,t=new l.MediaConnection(e,this,n),this._addConnection(e,t),t;a$jscomp$0.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},
i$jscomp$0.prototype._addConnection=function(e,t){a$jscomp$0.default.log("add connection "+t.type+":"+t.connectionId+" to peerId:"+e);this._connections.has(e)||this._connections.set(e,[]);this._connections.get(e).push(t)},i$jscomp$0.prototype._removeConnection=function(e){var t=this._connections.get(e.peer);if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}this._lostMessages.delete(e.connectionId)},i$jscomp$0.prototype.getConnection=function(e,t){var o;e=this._connections.get(e);if(!e)return null;try{for(var s=
n$jscomp$1(e),a=s.next();!a.done;a=s.next()){var c=a.value;if(c.connectionId===t)return c}}catch(l$18){var r={error:l$18}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error;}}return null},i$jscomp$0.prototype._delayedAbort=function(e,t){var n=this;setTimeout(function(){n._abort(e,t)},0)},i$jscomp$0.prototype._abort=function(e,t){a$jscomp$0.default.error("Aborting!");this.emitError(e,t);this._lastServerId?this.disconnect():this.destroy()},i$jscomp$0.prototype.emitError=function(e,
t){a$jscomp$0.default.error("Error:",t);(t="string"==typeof t?Error(t):t).type=e;this.emit(u.PeerEventType.Error,t)},i$jscomp$0.prototype.destroy=function(){this.destroyed||(a$jscomp$0.default.log("Destroy peer with ID:"+this.id),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit(u.PeerEventType.Close))},i$jscomp$0.prototype._cleanup=function(){var t;try{for(var r=n$jscomp$1(this._connections.keys()),o=r.next();!o.done;o=r.next()){var i=o.value;this._cleanupPeer(i);this._connections.delete(i)}}catch(s$19){var e=
{error:s$19}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error;}}this.socket.removeAllListeners()},i$jscomp$0.prototype._cleanupPeer=function(e){var r;if(e=this._connections.get(e))try{for(var i=n$jscomp$1(e),s=i.next();!s.done;s=i.next())s.value.close()}catch(a$20){var t={error:a$20}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error;}}},i$jscomp$0.prototype.disconnect=function(){if(!this.disconnected){var e=this.id;a$jscomp$0.default.log("Disconnect peer with ID:"+
e);this._disconnected=!0;this._open=!1;this.socket.close();this._lastServerId=e;this._id=null;this.emit(u.PeerEventType.Disconnected,e)}},i$jscomp$0.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)a$jscomp$0.default.log("Attempting reconnection to server with ID "+this._lastServerId),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw Error("Peer "+
this.id+" cannot reconnect because it is not disconnected from the server!");a$jscomp$0.default.error("In a hurry? We're still trying to make the initial connection!")}},i$jscomp$0.prototype.listAllPeers=function(e$jscomp$0){var t$jscomp$0=this;void 0===e$jscomp$0&&(e$jscomp$0=function(e){});this._api.listAllPeers().then(function(t){return e$jscomp$0(t)}).catch(function(e){return t$jscomp$0._abort(u.PeerErrorType.ServerError,e)})},i$jscomp$0.DEFAULT_KEY="peerjs",i$jscomp$0}(i$jscomp$1.EventEmitter);
exports.Peer=require},{eventemitter3:"JJlS","./util":"BHXf","./logger":"WOs9","./socket":"wJlv","./mediaconnection":"dbHP","./dataconnection":"GBTQ","./enums":"ZRYf","./api":"in7L"}],iTK6:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});module=require("./util");require=require("./peer");exports.peerjs={Peer:require.Peer,util:module.util};exports.default=require.Peer;window.peerjs=exports.peerjs;window.Peer=require.Peer},{"./util":"BHXf","./peer":"Hxpd"}]},{},
["iTK6"],null)}
//# sourceMappingURL=module$node_modules$peerjs$dist$peerjs_min.js.map
