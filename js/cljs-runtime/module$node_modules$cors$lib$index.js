shadow$provide.module$node_modules$cors$lib$index=function(global,require,module,exports){(function(){function isString(s){return"string"===typeof s||s instanceof String}function isOriginAllowed(origin,allowedOrigin){if(Array.isArray(allowedOrigin)){for(var i=0;i<allowedOrigin.length;++i)if(isOriginAllowed(origin,allowedOrigin[i]))return!0;return!1}return isString(allowedOrigin)?origin===allowedOrigin:allowedOrigin instanceof RegExp?allowedOrigin.test(origin):!!allowedOrigin}function configureOrigin(options,
req){req=req.headers.origin;var headers=[];options.origin&&"*"!==options.origin?(isString(options.origin)?headers.push([{key:"Access-Control-Allow-Origin",value:options.origin}]):(options=isOriginAllowed(req,options.origin),headers.push([{key:"Access-Control-Allow-Origin",value:options?req:!1}])),headers.push([{key:"Vary",value:"Origin"}])):headers.push([{key:"Access-Control-Allow-Origin",value:"*"}]);return headers}function configureMethods(options){var methods=options.methods;methods.join&&(methods=
options.methods.join(","));return{key:"Access-Control-Allow-Methods",value:methods}}function configureCredentials(options){return!0===options.credentials?{key:"Access-Control-Allow-Credentials",value:"true"}:null}function configureAllowedHeaders(options,req){options=options.allowedHeaders||options.headers;var headers=[];options?options.join&&(options=options.join(",")):(options=req.headers["access-control-request-headers"],headers.push([{key:"Vary",value:"Access-Control-Request-Headers"}]));options&&
options.length&&headers.push([{key:"Access-Control-Allow-Headers",value:options}]);return headers}function configureExposedHeaders(options){if(options=options.exposedHeaders)options.join&&(options=options.join(","));else return null;return options&&options.length?{key:"Access-Control-Expose-Headers",value:options}:null}function configureMaxAge(options){return(options=("number"===typeof options.maxAge||options.maxAge)&&options.maxAge.toString())&&options.length?{key:"Access-Control-Max-Age",value:options}:
null}function applyHeaders(headers,res){for(var i=0,n=headers.length;i<n;i++){var header=headers[i];header&&(Array.isArray(header)?applyHeaders(header,res):"Vary"===header.key&&header.value?vary(res,header.value):header.value&&res.setHeader(header.key,header.value))}}var assign=require("module$node_modules$object_assign$index"),vary=require("module$node_modules$vary$index"),defaults={origin:"*",methods:"GET,HEAD,PUT,PATCH,POST,DELETE",preflightContinue:!1,optionsSuccessStatus:204};module.exports=
function(o){var optionsCallback=null;optionsCallback="function"===typeof o?o:function(req,cb){cb(null,o)};return function(req,res,next){optionsCallback(req,function(err,options){if(err)next(err);else{var corsOptions=assign({},defaults,options);err=null;corsOptions.origin&&"function"===typeof corsOptions.origin?err=corsOptions.origin:corsOptions.origin&&(err=function(origin,cb){cb(null,corsOptions.origin)});err?err(req.headers.origin,function(err2,origin){err2||!origin?next(err2):(corsOptions.origin=
origin,err2=[],"OPTIONS"===(req.method&&req.method.toUpperCase&&req.method.toUpperCase())?(err2.push(configureOrigin(corsOptions,req)),err2.push(configureCredentials(corsOptions,req)),err2.push(configureMethods(corsOptions,req)),err2.push(configureAllowedHeaders(corsOptions,req)),err2.push(configureMaxAge(corsOptions,req)),err2.push(configureExposedHeaders(corsOptions,req)),applyHeaders(err2,res),corsOptions.preflightContinue?next():(res.statusCode=corsOptions.optionsSuccessStatus,res.setHeader("Content-Length",
"0"),res.end())):(err2.push(configureOrigin(corsOptions,req)),err2.push(configureCredentials(corsOptions,req)),err2.push(configureExposedHeaders(corsOptions,req)),applyHeaders(err2,res),next()))}):next()}})}}})()}
//# sourceMappingURL=module$node_modules$cors$lib$index.js.map
