shadow$provide.module$node_modules$iconv_lite$encodings$dbcs_codec=function(global,require,module,exports){function DBCSCodec(codecOptions,iconv){this.encodingName=codecOptions.encodingName;if(!codecOptions)throw Error("DBCS codec is called without the data.");if(!codecOptions.table)throw Error("Encoding '"+this.encodingName+"' has no data.");var mappingTable=codecOptions.table();this.decodeTables=[];this.decodeTables[0]=UNASSIGNED_NODE.slice(0);this.decodeTableSeq=[];for(var i=0;i<mappingTable.length;i++)this._addDecodeChunk(mappingTable[i]);
this.defaultCharUnicode=iconv.defaultCharUnicode;this.encodeTable=[];this.encodeTableSeq=[];var skipEncodeChars={};if(codecOptions.encodeSkipVals)for(i=0;i<codecOptions.encodeSkipVals.length;i++){var val=codecOptions.encodeSkipVals[i];if("number"===typeof val)skipEncodeChars[val]=!0;else for(mappingTable=val.from;mappingTable<=val.to;mappingTable++)skipEncodeChars[mappingTable]=!0}this._fillEncodeTable(0,0,skipEncodeChars);if(codecOptions.encodeAdd)for(var uChar in codecOptions.encodeAdd)Object.prototype.hasOwnProperty.call(codecOptions.encodeAdd,
uChar)&&this._setEncodeChar(uChar.charCodeAt(0),codecOptions.encodeAdd[uChar]);this.defCharSB=this.encodeTable[0][iconv.defaultCharSingleByte.charCodeAt(0)];this.defCharSB===UNASSIGNED&&(this.defCharSB=this.encodeTable[0]["?"]);this.defCharSB===UNASSIGNED&&(this.defCharSB=63);if("function"===typeof codecOptions.gb18030){this.gb18030=codecOptions.gb18030();codecOptions=this.decodeTables.length;iconv=this.decodeTables[codecOptions]=UNASSIGNED_NODE.slice(0);uChar=this.decodeTables.length;skipEncodeChars=
this.decodeTables[uChar]=UNASSIGNED_NODE.slice(0);for(i=129;254>=i;i++)for(val=this.decodeTables[NODE_START-this.decodeTables[0][i]],mappingTable=48;57>=mappingTable;mappingTable++)val[mappingTable]=NODE_START-codecOptions;for(i=129;254>=i;i++)iconv[i]=NODE_START-uChar;for(i=48;57>=i;i++)skipEncodeChars[i]=GB18030_CODE}}function DBCSEncoder(options,codec){this.leadSurrogate=-1;this.seqObj=void 0;this.encodeTable=codec.encodeTable;this.encodeTableSeq=codec.encodeTableSeq;this.defaultCharSingleByte=
codec.defCharSB;this.gb18030=codec.gb18030}function DBCSDecoder(options,codec){this.nodeIdx=0;this.prevBuf=Buffer.alloc(0);this.decodeTables=codec.decodeTables;this.decodeTableSeq=codec.decodeTableSeq;this.defaultCharUnicode=codec.defaultCharUnicode;this.gb18030=codec.gb18030}function findIdx(table,val){if(table[0]>val)return-1;for(var l=0,r=table.length;l<r-1;){var mid=l+Math.floor((r-l+1)/2);table[mid]<=val?l=mid:r=mid}return l}var Buffer=require("module$node_modules$safer_buffer$safer").Buffer;
exports._dbcs=DBCSCodec;var UNASSIGNED=-1,GB18030_CODE=-2,NODE_START=-1E3,UNASSIGNED_NODE=Array(256);for(global=0;256>global;global++)UNASSIGNED_NODE[global]=UNASSIGNED;DBCSCodec.prototype.encoder=DBCSEncoder;DBCSCodec.prototype.decoder=DBCSDecoder;DBCSCodec.prototype._getDecodeTrieNode=function(addr){for(var bytes=[];0<addr;addr>>=8)bytes.push(addr&255);0==bytes.length&&bytes.push(0);for(var node=this.decodeTables[0],i=bytes.length-1;0<i;i--){var val=node[bytes[i]];if(val==UNASSIGNED)node[bytes[i]]=
NODE_START-this.decodeTables.length,this.decodeTables.push(node=UNASSIGNED_NODE.slice(0));else if(val<=NODE_START)node=this.decodeTables[NODE_START-val];else throw Error("Overwrite byte in "+this.encodingName+", addr: "+addr.toString(16));}return node};DBCSCodec.prototype._addDecodeChunk=function(chunk){var curAddr=parseInt(chunk[0],16),writeTable=this._getDecodeTrieNode(curAddr);curAddr&=255;for(var k=1;k<chunk.length;k++){var part=chunk[k];if("string"===typeof part)for(var l=0;l<part.length;){var code=
part.charCodeAt(l++);if(55296<=code&&56320>code){var codeTrail=part.charCodeAt(l++);if(56320<=codeTrail&&57344>codeTrail)writeTable[curAddr++]=65536+1024*(code-55296)+(codeTrail-56320);else throw Error("Incorrect surrogate pair in "+this.encodingName+" at chunk "+chunk[0]);}else if(4080<code&&4095>=code){code=4095-code+2;codeTrail=[];for(var m=0;m<code;m++)codeTrail.push(part.charCodeAt(l++));writeTable[curAddr++]=-10-this.decodeTableSeq.length;this.decodeTableSeq.push(codeTrail)}else writeTable[curAddr++]=
code}else if("number"===typeof part)for(code=writeTable[curAddr-1]+1,l=0;l<part;l++)writeTable[curAddr++]=code++;else throw Error("Incorrect type '"+typeof part+"' given in "+this.encodingName+" at chunk "+chunk[0]);}if(255<curAddr)throw Error("Incorrect chunk in "+this.encodingName+" at addr "+chunk[0]+": too long"+curAddr);};DBCSCodec.prototype._getEncodeBucket=function(uCode){uCode>>=8;void 0===this.encodeTable[uCode]&&(this.encodeTable[uCode]=UNASSIGNED_NODE.slice(0));return this.encodeTable[uCode]};
DBCSCodec.prototype._setEncodeChar=function(uCode,dbcsCode){var bucket=this._getEncodeBucket(uCode);uCode&=255;-10>=bucket[uCode]?this.encodeTableSeq[-10-bucket[uCode]][-1]=dbcsCode:bucket[uCode]==UNASSIGNED&&(bucket[uCode]=dbcsCode)};DBCSCodec.prototype._setEncodeSequence=function(seq,dbcsCode){var uCode=seq[0],bucket=this._getEncodeBucket(uCode),low=uCode&255;if(-10>=bucket[low])var node=this.encodeTableSeq[-10-bucket[low]];else node={},bucket[low]!==UNASSIGNED&&(node[-1]=bucket[low]),bucket[low]=
-10-this.encodeTableSeq.length,this.encodeTableSeq.push(node);for(bucket=1;bucket<seq.length-1;bucket++)low=node[uCode],"object"===typeof low?node=low:(node=node[uCode]={},void 0!==low&&(node[-1]=low));uCode=seq[seq.length-1];node[uCode]=dbcsCode};DBCSCodec.prototype._fillEncodeTable=function(nodeIdx,prefix,skipEncodeChars){nodeIdx=this.decodeTables[nodeIdx];for(var i=0;256>i;i++){var uCode=nodeIdx[i],mbCode=prefix+i;skipEncodeChars[mbCode]||(0<=uCode?this._setEncodeChar(uCode,mbCode):uCode<=NODE_START?
this._fillEncodeTable(NODE_START-uCode,mbCode<<8,skipEncodeChars):-10>=uCode&&this._setEncodeSequence(this.decodeTableSeq[-10-uCode],mbCode))}};DBCSEncoder.prototype.write=function(str){for(var newBuf=Buffer.alloc(str.length*(this.gb18030?4:3)),leadSurrogate=this.leadSurrogate,seqObj=this.seqObj,nextChar=-1,i=0,j=0;;){if(-1===nextChar){if(i==str.length)break;var uCode=str.charCodeAt(i++)}else uCode=nextChar,nextChar=-1;if(55296<=uCode&&57344>uCode)if(56320>uCode)if(-1===leadSurrogate){leadSurrogate=
uCode;continue}else leadSurrogate=uCode,uCode=UNASSIGNED;else-1!==leadSurrogate?(uCode=65536+1024*(leadSurrogate-55296)+(uCode-56320),leadSurrogate=-1):uCode=UNASSIGNED;else-1!==leadSurrogate&&(nextChar=uCode,uCode=UNASSIGNED,leadSurrogate=-1);var dbcsCode=UNASSIGNED;if(void 0!==seqObj&&uCode!=UNASSIGNED){var resCode=seqObj[uCode];if("object"===typeof resCode){seqObj=resCode;continue}else"number"==typeof resCode?dbcsCode=resCode:void 0==resCode&&(resCode=seqObj[-1],void 0!==resCode&&(dbcsCode=resCode,
nextChar=uCode));seqObj=void 0}else if(0<=uCode){resCode=this.encodeTable[uCode>>8];void 0!==resCode&&(dbcsCode=resCode[uCode&255]);if(-10>=dbcsCode){seqObj=this.encodeTableSeq[-10-dbcsCode];continue}if(dbcsCode==UNASSIGNED&&this.gb18030&&(resCode=findIdx(this.gb18030.uChars,uCode),-1!=resCode)){dbcsCode=this.gb18030.gbChars[resCode]+(uCode-this.gb18030.uChars[resCode]);newBuf[j++]=129+Math.floor(dbcsCode/12600);dbcsCode%=12600;newBuf[j++]=48+Math.floor(dbcsCode/1260);dbcsCode%=1260;newBuf[j++]=129+
Math.floor(dbcsCode/10);dbcsCode%=10;newBuf[j++]=48+dbcsCode;continue}}dbcsCode===UNASSIGNED&&(dbcsCode=this.defaultCharSingleByte);256>dbcsCode?newBuf[j++]=dbcsCode:(65536>dbcsCode?newBuf[j++]=dbcsCode>>8:(newBuf[j++]=dbcsCode>>16,newBuf[j++]=dbcsCode>>8&255),newBuf[j++]=dbcsCode&255)}this.seqObj=seqObj;this.leadSurrogate=leadSurrogate;return newBuf.slice(0,j)};DBCSEncoder.prototype.end=function(){if(-1!==this.leadSurrogate||void 0!==this.seqObj){var newBuf=Buffer.alloc(10),j=0;if(this.seqObj){var dbcsCode=
this.seqObj[-1];void 0!==dbcsCode&&(256>dbcsCode?newBuf[j++]=dbcsCode:(newBuf[j++]=dbcsCode>>8,newBuf[j++]=dbcsCode&255));this.seqObj=void 0}-1!==this.leadSurrogate&&(newBuf[j++]=this.defaultCharSingleByte,this.leadSurrogate=-1);return newBuf.slice(0,j)}};DBCSEncoder.prototype.findIdx=findIdx;DBCSDecoder.prototype.write=function(buf){var newBuf=Buffer.alloc(2*buf.length),nodeIdx=this.nodeIdx,prevBuf=this.prevBuf,prevBufOffset=this.prevBuf.length,seqStart=-this.prevBuf.length;0<prevBufOffset&&(prevBuf=
Buffer.concat([prevBuf,buf.slice(0,10)]));for(var i=0,j=0;i<buf.length;i++){var curByte=0<=i?buf[i]:prevBuf[i+prevBufOffset];var uCode=this.decodeTables[nodeIdx][curByte];if(!(0<=uCode))if(uCode===UNASSIGNED)i=seqStart,uCode=this.defaultCharUnicode.charCodeAt(0);else if(uCode===GB18030_CODE)uCode=0<=seqStart?buf.slice(seqStart,i+1):prevBuf.slice(seqStart+prevBufOffset,i+1+prevBufOffset),uCode=12600*(uCode[0]-129)+1260*(uCode[1]-48)+10*(uCode[2]-129)+(uCode[3]-48),nodeIdx=findIdx(this.gb18030.gbChars,
uCode),uCode=this.gb18030.uChars[nodeIdx]+uCode-this.gb18030.gbChars[nodeIdx];else if(uCode<=NODE_START){nodeIdx=NODE_START-uCode;continue}else if(-10>=uCode){nodeIdx=this.decodeTableSeq[-10-uCode];for(seqStart=0;seqStart<nodeIdx.length-1;seqStart++)uCode=nodeIdx[seqStart],newBuf[j++]=uCode&255,newBuf[j++]=uCode>>8;uCode=nodeIdx[nodeIdx.length-1]}else throw Error("iconv-lite internal error: invalid decoding table value "+uCode+" at "+nodeIdx+"/"+curByte);65535<uCode&&(uCode-=65536,nodeIdx=55296+Math.floor(uCode/
1024),newBuf[j++]=nodeIdx&255,newBuf[j++]=nodeIdx>>8,uCode=56320+uCode%1024);newBuf[j++]=uCode&255;newBuf[j++]=uCode>>8;nodeIdx=0;seqStart=i+1}this.nodeIdx=nodeIdx;this.prevBuf=0<=seqStart?buf.slice(seqStart):prevBuf.slice(seqStart+prevBufOffset);return newBuf.slice(0,j).toString("ucs2")};DBCSDecoder.prototype.end=function(){for(var ret="";0<this.prevBuf.length;){ret+=this.defaultCharUnicode;var buf=this.prevBuf.slice(1);this.prevBuf=Buffer.alloc(0);this.nodeIdx=0;0<buf.length&&(ret+=this.write(buf))}this.nodeIdx=
0;return ret}}
//# sourceMappingURL=module$node_modules$iconv_lite$encodings$dbcs_codec.js.map
